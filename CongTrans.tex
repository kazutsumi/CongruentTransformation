\documentclass[11pt, uplatex, dvipdfmx, titlepage]{jsarticle}
\usepackage{amsthm,amsmath,amssymb, enumerate,bm,fancyhdr, braket, ascmac, graphicx}
\usepackage[cc]{titlepic}


%\renewcommand{\arraystretch}{1.2}
\newcommand{\ds}{\displaystyle}

\renewcommand{\i}{\mathbf{i}}
\renewcommand{\bar}[1]{\overline{#1}}

\DeclareMathOperator{\Isom}{Isom}
\DeclareMathOperator{\Inv}{Inv}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Aff}{Aff}
\DeclareMathOperator{\PGL}{PGL}


%ページ上部タイトル内のアルファベット大文字化回避
% \makeatletter
% \def\ps@fancy{%
% \def\sectionmark##1{\markboth{\ifnum \c@secnumdepth>\z@ \thesection\hskip 1em\relax \fi ##1}{}}%
% \def\subsectionmark##1{\markright {\ifnum \c@secnumdepth >\@ne \thesubsection\hskip 1em\relax \fi ##1}}%
% \ps@@fancy
% \gdef\ps@fancy{\@fancyplainfalse\ps@@fancy}%
% \ifdim\headwidth<0sp
% \global\advance\headwidth123456789sp\global\advance\headwidth\textwidth
% \fi
% }
%  \makeatother

\makeatletter
\renewcommand{\theequation}{%
\thesection.\arabic{equation}}
\@addtoreset{equation}{section}
\makeatother

\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item[\hskip\labelsep
%        \itshape
         \bfseries
%    #1\@addpunct{.}]\ignorespaces
    {#1}]\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother

\theoremstyle{definition}
\newtheorem{theorem}{定理}[section]
\newtheorem*{definition}{定義}
\newtheorem{example}{例}
\newtheorem{lemma}{補題}[section]
\renewcommand{\proofname}{\textbf{証明}}
\newtheorem*{remark}{注意}


\pagestyle{fancy}
\chead{\leftmark}
\lhead{}
\rhead{}
\cfoot{\thepage}

%\setcounter{section}{-1}

\begin{document}


\title{線形代数たっぷり 平面と空間の合同変換}
\author{内海 和樹}
\date{\today}
\titlepic{\includegraphics[height=10cm]{pictures/topoo.pdf}}
\maketitle
  


\section*{はじめに}

 平面と空間の合同変換を線形代数をふんだんに使って分類してみました．はじ
 めに合同変換を一般次元 $\mathbb{R}^n$ において定義しますが，過度の抽象
 化を避けるために，一般次元の話は $\mathbb{R}^2, \mathbb{R}^3$ （ついで
 に $\mathbb{R}$）の後に展開しています．そのため，平面と空間に関しては
 別々に読めるようになっているはずです．

 $\mathbb{R}^n$ のユークリッド距離のもとでの合同変換を分類することは，
 結局の所 $n$ 次直交行列を分類することに尽きるのだなあ，と感じました．

 $\mathbb{R}^4$ の合同変換の分類についてもいずれまとめたいと思ってます．
 やる気が湧いたら加筆します．
 
 \newpage

 \section*{記号・記法}

\begin{itemize}
  \setlength{\itemsep}{1zh}

\item $\mathbb{R}^n$ の標準内積を $( \; , \; )$ で表す．つまり，$(\bm{x}, \bm{y}) = {}^{t}\bm{x} \bm{y}$ である．

\item $\mathbb{R}^n$ の標準内積から定まるノルムを $\| \; \|$ で表す．つ
  まり，$\|\bm{x}\| = \sqrt{(\bm{x}, \bm{x})}$ である．
  
\item 線形空間の基底は順序付きの組として $(\bm{e}_1, \bm{e}_2, \ldots ,
  \bm{e}_n)$ のように書く．例えば，$\mathbb{R}^3$ の基底
  $(\bm{e}_1, \bm{e}_2, \bm{e}_3)$ と $(\bm{e}_1, \bm{e}_3, \bm{e}_2)$
  は別の基底として扱う．
  
\item $E$ を単位行列とし，次数 $n$ を明示したいときは $E_n$ と書く．

\item 行列 $A$ に対応する線形変換 $\bm{x}\mapsto A\bm{x}$ を $T_A$ で表す．

\item 正方行列 $A$ の固有値 $\lambda$ の固有空間を $V_A(\lambda)$ で表
  す．なお，$\lambda$ が $A$ の固有値でないときも便宜
  上 $V_A(\lambda)=\Set{ \bm{0}}$ と見なして同じ記号を用いる．

\item $\mathbb{R}^n$ の部分線形空間 $V$ の直交補空間を $V^{\perp}$ で表す：
  \[
    V^{\perp} := \Set{\bm{x} \in \mathbb{R}^n | \text{ 任意の } \bm{y} \in V \text{ に対して } (\bm{x}, \bm{y}) = 0}
  \]

\item 対角成分（ブロック）が順に $a_1, \ldots, a_n$ である対角行列
  を $\diag(a_1, \ldots, a_n)$ で表す：
  \[
    \diag(a_1, a_2, \ldots, a_n) := \left[
      \begin{array}{ccc}
        a_1 & & O\\
         & \ddots &\\
        O & & a_n
      \end{array}
    \right]
  \]

  
\item 行列 $A$ の転置行列を ${}^{t}A$ で表す．

\item 直交行列 $A,B$ が向きを保って同じ標準形に標準化されることを$ A \sim B$ で表す．
  \[
    A \sim B \overset{\textrm{def}}{\Longleftrightarrow} B= {}^{t}PAP \text{ か
      つ } \det(P) =1 \text{ となる直交行列 $P$ が存在する}
  \]

 
\item $\mathbb{C}^n$ の標準エルミート内積も $( \; , \;)$ で表す．つま
  り，$(\bm{x}, \bm{y}) = {}^{t} \bm{x} \bar{\bm{y}}={}^{t}\bar{\bm{y}}\bm{x}$ である．ここ
  で，$\bar{\bm{y}}$ は $\bm{y}$ の成分を全て複素共役で置き換えたベクト
  ルを表す．

\item 行列 $X$ の随伴行列を $X^*$ で表す．つまり，$X^* := {}^{t}\bar{X}$ である．  

\item 虚数単位は $\i$ で表す．アルファベットの $i$ は添字等で使いたいので，書体を変えて区別する．
  
\item $\mathbb{R}^n$ の線形部分空間 $V$ とベクトル $\bm{v}_0 \in \mathbb{R}^n$ によって
  \[
    W = \bm{v}_0 + V := \Set{\bm{v}_0 + \bm{x} | \bm{x} \in V}
  \]
  の形に表せる $\mathbb{R}^n$ の部分集合 $W$ を $\mathbb{R}^n$ のアフィ
  ン部分空間という．このとき，アフィン部分空間 $W$ の次元を線形空
  間 $V$ の次元により定義する．つまり，$\dim W := \dim V$ とする．
  
\end{itemize}



\section{合同変換とは}\label{sec:whatis}
\thispagestyle{plain}


$\mathbb{R}^n$ を $n$ 次元列ベクトルのなす実線形空間とする．ま
た，$\bm{x}, \bm{y} \in \mathbb{R}^n$ に対して
$(\bm{x}, \bm{y}) = {}^{t}\bm{x} \bm{y}$ によって内積を定める．さら
に，$\| \bm{x}\| = \sqrt{(\bm{x}, \bm{x})}$ によってノルムを定める．

例えば，平面ベクトルは $\bm{x} = \left[
  \begin{array}{c}
    x_1\\
    y_1
  \end{array}
\right], \; \bm{y}= \left[
  \begin{array}{c}
    x_2\\
    y_2
  \end{array}
\right] \in \mathbb{R}^2$ のように書き，内積とノルムは
\[
  \left( \bm{x}, \bm{y}\right) = {}^{t}\bm{x} \bm{y} = \left[
    \begin{array}{cc}
      x_1 & y_1
    \end{array}
  \right] \left[
    \begin{array}{c}
      x_2\\
      y_2
    \end{array}
  \right] = x_1 x_2 + y_1 y_2, \quad \| \bm{x} \| = \sqrt{(\bm{x},\bm{x})} = \sqrt{x_1^2+y_1^2}
\]
である．$2$ つのベクト
ル $\bm{x}$ と $\bm{y}$ の距離 $d(\bm{x}, \bm{y})$ はノルムを用いて
\[
  d(\bm{x}, \bm{y}) :=\|\bm{x} - \bm{y} \|
\]
と書ける．この距離を保つ変換が合同変換である．つまり，合同変換は次のように定義される．
なお，列ベクトルと点を同一視し，$\mathbb{R}^n$ の元は適宜ベクトルと見な
したり点と見なしたりする．

\begin{definition}
  写像 $f:\mathbb{R}^n \to \mathbb{R}^n$
  が任意の$\bm{x}, \bm{y} \in \mathbb{R}^n$ に対して
  \[
    d(f(\bm{x}), f(\bm{y})) = \|f(\bm{x}) - f(\bm{y})\| = \|\bm{x} - \bm{y}\| = d(\bm{x}, \bm{y})
  \]
  を満たすとき，$f$ を $\mathbb{R}^n$ の合同変換という．
\end{definition}

\begin{theorem}\label{thm:trans-orth}
  \begin{enumerate}[(1)]
  \item ベクトル $\bm{b} \in \mathbb{R}^n$ による平行移
    動 $t_{\bm{b}}(\bm{x}) = \bm{x} + \bm{b}$ は $\mathbb{R}^n$ の合同変
    換である．
  \item 直交変換，すなわち，内積を保つ $\mathbb{R}^n$ の線形変換は合同
    変換である．
  \end{enumerate}
    \begin{proof}
      \begin{enumerate}[(1)]
      \item 任意の $\bm{x}, \bm{y}$ に対して
      \[
        \|t_{\bm{b}}(\bm{x}) - t_{\bm{b}}(\bm{y})\| =\|(\bm{x}+\bm{b}) -
        (\bm{y}+\bm{b})\| = \|\bm{x}-\bm{y}\|
      \]
      が成り立つ．よって，$t_{\bm{b}}$ は $\mathbb{R}^n$ の合同変換である．
      
    \item $f$ を $\mathbb{R}^n$ の直交変換とする．$f$ は内積を保つので，
      任意の $\bm{x}, \bm{y} \in \mathbb{R}^n$ に対して
      \[
        \|f(\bm{x}) - f(\bm{y})\|^2 = \|f(\bm{x}-\bm{y})\|^2 = \left( f(\bm{x}-\bm{y}), f(\bm{x}-\bm{y})\right)
        = (\bm{x}-\bm{y}, \bm{x}-\bm{y}) = \|\bm{x}-\bm{y}\|^2
      \]
      が成り立つ．よって，$f$ は $\mathbb{R}^n$ の合同変換である．
    \end{enumerate}
  \end{proof}
\end{theorem}

合同変換と合同変換を合成するとやはり合同変換である．すなわち，次の定理が成り立つ．

\begin{theorem}\label{thm:comp_isom}
  $\mathbb{R}^n$ の2つの合同変換の合成は $\mathbb{R}^n$ の合同変換である．
\end{theorem}

\begin{proof}
  $\mathbb{R}^n$ の合同変換 $f_1, f_2$ を任意にとる．任意の $\bm{x}, \bm{y} \in \mathbb{R}^n$ に対して
  \begin{align*}
    \|f_1 \left(f_2 \left(\bm{x}\right)\right)-f_1 \left(f_2\left(\bm{y}\right)\right)\|
    = \| f_2(\bm{x})- f_2(\bm{y}) \| = \|\bm{x}- \bm{y}\|
  \end{align*}
  が成り立つので，合成 $f_1 \circ f_2$ は $\mathbb{R}^n$ の合同変換である．
\end{proof}


直交変換は線形変換なので原点を保つ合同変換である．この逆，すなわち，次が成り立つ．

\begin{theorem}\label{thm:prev0}
  原点を保つ合同変換は線形変換であり，従って，直交変換である．
\end{theorem}

\begin{proof}
  $f$ を $\mathbb{R}^n$ の合同変換とし，$f(\bm{0}) = \bm{0}$ とする．このとき，任
  意の $\bm{x} \in \mathbb{R}^n$ に対して
  \[
    \|f(\bm{x})\| = \|f(\bm{x})-\bm{0}\| =\|f(\bm{x})-f(\bm{0})\|  = \|\bm{x}-\bm{0}\| = \| \bm{x}\|
  \]
  が成り立つので，$f$ はノルムを保つ．これと内積とノルムの関係から任意
  の $\bm{x}, \bm{y} \in \mathbb{R}^n$ に対して
  \begin{align*}
    \left(f(\bm{x}), f(\bm{y})\right)
    &= \frac{1}{2}\left(\left\|f(\bm{x})-f(\bm{y})\right\|^2-\left\|f(\bm{x})\right\|^2
      -\left\|f(\bm{y})\right\|^2\right)\\
    &=\frac{1}{2}\left(\left\|\bm{x}-\bm{y}\right\|^2-\left\|\bm{x}\right\|^2-\left\|\bm{y}\right\|^2\right)
      = \left(\bm{x}, \bm{y}\right)
  \end{align*}
  が成り立つので，$f$ は内積を保つ．以上から，任意の $\bm{x}, \bm{y}
  \in \mathbb{R}^n$ と任意の $k \in \mathbb{R}$ に対して
  \begin{align*}
    \left\|f(\bm{x}+\bm{y}) -  f(\bm{x}) - f(\bm{y}) \right\|^2
    =& \|f(\bm{x}+\bm{y})\|^2+\|f(\bm{x})\|^2+\|f(\bm{y})\|^2\\
     &- 2\left(f(\bm{x}+\bm{y}), f(\bm{x})\right)
       -2\left( f(\bm{x}+\bm{y}), f(\bm{y})\right)+2\left(f(\bm{x}), f(\bm{y})\right)\\
    =& \| \bm{x} + \bm{y}\|^2 + \|\bm{x}\|^2+\|\bm{y}\|^2\\
     &-2\left(\bm{x}+\bm{y},\bm{x}\right)-2\left(\bm{x}+\bm{y}, \bm{y}\right)+2\left(\bm{x},\bm{y}\right)\\
    =& \|\bm{x}+\bm{y} - \bm{x}-\bm{y}\|^2=0,\\
    \left\| f(k\bm{x}) - k f(\bm{x})\right\|^2  
    =& \|f(k\bm{x})\|^2-2\left( f(k\bm{x}), kf(\bm{x}) \right) + \|kf(\bm{x})\|^2\\
    =& \|k\bm{x}\|^2 - 2k\left(f(k\bm{x}), f(\bm{x})\right) + k^2\|f(\bm{x})\|^2\\
    =& \|k\bm{x}\|^2-2k\left( k\bm{x}, \bm{x}\right) + k^2 \|\bm{x}\|^2= 0
  \end{align*}
  が成り立つ．よって，$f$ は線形変換である．さらに，$f$ は内積を保つの
  で直交変換である．
\end{proof}

この定理から，任意の合同変換は直交行列とベクトルによって表せる．すなわち，次が成り立つ．

\begin{theorem}\label{thm:affine_rep}
  $\mathbb{R}^n$ の任意の合同変換 $f$ は，$n$ 次直交行列 $A$
  と $n$ 次ベクトル $\bm{b} \in \mathbb{R}^n$ によって
  \[
    f(\bm{x}) = A\bm{x} + \bm{b}
  \]
  と一意的に表せる．逆に，この形で表せる写像は $\mathbb{R}^n$ の合同変換である．
\end{theorem}


\begin{proof}
  $f$ を $\mathbb{R}^n$ の任意の合同変換とする．$f(\bm{0})=\bm{b}$ とお
  く．定理\ref{thm:trans-orth}(1)と定
  理\ref{thm:comp_isom}よりベクトル $-f(\bm{0})$ による平行移
  動 $t_{-f(\bm{0})}$ と $f$ の合成 $g = t_{-\bm{b}} \circ
  f$ は $\mathbb{R}^n$ の合同変換である．$g(\bm{0})=\bm{0}$ なので，定
  理\ref{thm:prev0}より $g$は直交変換である．従って，ある $n$ 次直交行
  列 $A$
  によって$g(\bm{x})=A\bm{x}$と表せる．よって，$f(\bm{x}) =
  g(\bm{x})+\bm{b} = A\bm{x} + \bm{b}$である．また，
  \[
    f(\bm{x}) = A\bm{x}+\bm{b} = B\bm{x} + \bm{c}
  \]
  と表せたとすると，$f(\bm{0})=\bm{b}=\bm{c}$ である．従って，$f$ に対
  して直交変換 $g$ が一意的に定まるので，対応する直交行列も一意的に定ま
  るから $A=B$ である．後半の主張は明らかである．
\end{proof}


\section{平面の合同変換}\label{sec:2dim}


$f$ を平面 $\mathbb{R}^2$ の合同変換とする．定理\ref{thm:affine_rep}か
ら $2$ 次直交行列 $A$ と平面ベクトル $\bm{b} \in \mathbb{R}^2$ によって
\[
  f(\bm{x}) = A\bm{x} + \bm{b}
\]
と書ける．$f$ はその固定点集合によって特徴づけられる．

\subsection{固定点集合}\label{sec:inv2}

$f(\bm{x})=\bm{x}$ を満たす $\bm{x} \in \mathbb{R}^2$ を $f$ の固定点という．$f$ の固定点集合
\[
  \Inv(f) := \Set{ x \in \mathbb{R}^2 | f(\bm{x}) = \bm{x}} \subset \mathbb{R}^2
\]
が平面上でどのような図形になるかを考えよう．
\[
  f(\bm{x}) = \bm{x} \Leftrightarrow A\bm{x} + \bm{b} = \bm{x} \Leftrightarrow (E-A)\bm{x} = \bm{b}
\]
であるから，$\Inv(f)$ は $2$ 変数連立1次方程式 $(E-A)\bm{x} = \bm{b}$
の解全体のなす集合である．従って，$\Inv(f)$ は空集合，$1$ 点集合，直線，
平面全体のいずれかである．特に，$f$ が恒等変換のとき，またそのときに限
り，$\Inv(f)=\mathbb{R}^2$ となる．すなわち，
\[
  A=E \text{ かつ } \bm{b} = \bm{0} \Leftrightarrow f =
  \id_{\mathbb{R}^2} \Leftrightarrow \Inv(f) = \mathbb{R}^2
\]
である．また，
\[
  A=E \text{ かつ } \bm{b} \neq \bm{0} \Rightarrow \Inv(f) = \emptyset
\]
である．すなわち，$\bm{0}$ でないベクトル $\bm{b}$ による平行移
動 $t_{\bm{b}}$ は固定点を持たない．

$A$ が $1$ を固有値に持たないとき，$\det(E-A) \neq 0$ だから $E-A$ は正
則である．従って，このとき連立 $1$ 次方程式 $(E-A)\bm{x} = \bm{b}$ は唯
一つの解 $\bm{x} = (E-A)^{-1}\bm{b}$ を持つから，$\Inv(f)$ は $1$ 点集
合である．すなわち，以下が成り立つ．
\[
  \text{ $1$ は $A$ の固有値でない } \Rightarrow \Inv(f) =
  \Set{(E-A)^{-1}\bm{b}}
\]

$A$ が $1$ を固有値に持つとき，その固有空間 $V_A(1)$ は同次形連立 $1$
次方程式 $(E-A)\bm{x}=\bm{0}$ の解空間に等しい．さらに，連立 $1$ 次方程
式 $(E-A)\bm{x}=\bm{b}$ が解を持つなら，その一般解は特殊解 $\bm{x}_0$
を用いて$\bm{x} = \bm{x}_0 + \bm{x}_1 \; (\bm{x}_1 \in V_A(1))$ と書け
る．すなわち，
\[
  \text{ $1$ が $A$ の固有値かつ } \Inv(f) \neq \emptyset \Rightarrow
  \Inv(f) = \Set{\bm{x}_0 +  \bm{x}_1 | \bm{x}_1 \in V_A(1)}
\]
である．特に，$\dim V_A(1) = 1$ なら $\Inv(f)$ は $\bm{x}_0$ を通
り $V_A(1)$ に平行直線である．なお，連立 $1$ 次方程
式 $(E-A)\bm{x}=\bm{b}$ が解を持たければ，$\Inv(f)$ は空集合である．


\subsection{平面の直交変換}

よく知られているように，$2$ 次直交行列は以下のどちらか一方の形に書ける．
\[
  S_{\theta} := \left[
    \begin{array}{rr}
      \cos\theta & -\sin\theta\\
      \sin\theta & \cos\theta
    \end{array}
  \right], \quad R_{\theta} :=\left[
    \begin{array}{rr}
      \cos\theta & \sin\theta\\
      \sin\theta & -\cos\theta
    \end{array}
  \right] \quad (\theta \in \mathbb{R})
\]
$S_{\theta}$ に対応する直交変換は図\ref{fig:rotaion2}のように原点を中心
とする角度 $\theta$ の回転であり，$R_{\theta}$ に対応する直交変換は
図\ref{fig:reflection2}のように原点で $x$ 軸と角度 $\frac{\theta}{2}$
で交わる直線に関する鏡映である．ただし，角度は反時計回りを正の向きとす
る．
\begin{figure}[h]
  \centering
  \begin{tabular}{c}
    \begin{minipage}{0.45\linewidth}
      \includegraphics[height=4.5cm]{pictures/rotation2.pdf}
      \caption{原点を中心とする$\theta$ 回転}\label{fig:rotaion2}
    \end{minipage}
    \begin{minipage}{0.45\linewidth}
    \includegraphics[height=4.5cm]{pictures/reflection2.pdf}
    \caption{原点で $x$ 軸と$\theta/2$ で交わる直線に関する鏡映}\label{fig:reflection2}      
    \end{minipage}
  \end{tabular}
\end{figure}

$2$ 次直交行列全体の集合を $O(2)$ と書く．また，$SO(2) := \Set{A \in
  O(2) | \det A = 1}$ とする．$\det S_{\theta} =1, \; \det
R_{\theta}=-1$ であり，直交行列の行列式は $\pm 1$ だから，
\[
  SO(2) = \Set{ S_{\theta} | \theta \in \mathbb{R}}, \quad O(2)
  \setminus SO(2)=\Set{ R_{\theta} | \theta \in \mathbb{R}}
\]
である．回転同士，鏡映同士の合成は回転であり，回転と鏡映の合成は鏡映である．具体的には
\[
  S_{\theta} S_{\phi} = S_{\theta+\phi}, \quad R_{\theta} R_{\phi} = S_{\theta-\phi}, \quad
  S_{\theta}R_{\phi}=R_{\theta+\phi}, \quad R_{\theta}S_{\phi} = R_{\theta-\phi}
\]
である．特に，$S_{\theta} = R_{\theta}R_{0}, R_{\theta}^2=E$ である．さらに，
\[
  S_{\frac{\theta}{2}}^{-1} R_{\theta} S_{\frac{\theta}{2}} = S_{-\frac{\theta}{2}} R_{\theta} S_{\frac{\theta}{2}}
  = R_{0} = \left[
    \begin{array}{rr}
      1 & 0\\
      0 & -1
    \end{array}
  \right]
\]
より，$R_{\theta}$ は $S_{\frac{\theta}{2}}$ により直交対角化されることがわかる．これより（あるいは直接的な計算により）
$R_{\theta}$ の固有値は $1, -1$ で，各々の固有空間 $V_{\theta}(1), V_{\theta}(-1)$ は互いに直交し，
\[
  V_{\theta}(1) = \left\langle \left[
    \begin{array}{r}
      \cos (\theta/2)\\
      \sin (\theta/2)
    \end{array}
  \right]\right\rangle, \quad V_{\theta}(-1)= \left\langle \left[
    \begin{array}{r}
      -\sin (\theta/2)\\
      \cos (\theta/2)
    \end{array}
  \right]\right\rangle
\] 
であることもわかる．なお，$V_{\theta}(1)$ が鏡映の軸である．ま
た，$S_{\theta}$ は実固有値を持たない．


\subsection{平面の合同変換の分類}\label{sec:classification2}

平面 $\mathbb{R}^2$ の合同変換
\[
  f(\bm{x}) = A \bm{x} + \bm{b}
\]
は直交行列 $A$ と $2$ 次列ベクトル $\bm{b}$ によって
表\ref{tab:classification2}のように $5$ 種に分類できる．定
理\ref{thm:generate2}で示すように，平面の合同変換は $3$ 個以下の鏡映の
合成として表せる．表\ref{tab:classification2}の $4$ 列目はその鏡映の最
小個数を表しており，この分類は平面 $\mathbb{R}^2$ の合同変換をそれを合
成する鏡映の個数と固定点集合によって分類したものとも一致してい
る．

\begin{table}[h]
  \centering
  \begin{tabular}[h]{|c|c|c|c|c|}\hline
    名前 & $A$ & $\bm{b}$ & 鏡映の最小個数 & 固定点集合\\ \hline
    恒等変換 & $E$ & $\bm{0}$ & $0$ & $\mathbb{R}^2$ \\
    平行移動 & $E$ & $\bm{b} \neq \bm{0}$ & $2$ & 空集合\\
    回転 & $S_{\theta} (\neq E$) & $\bm{b} \in \mathbb{R}^2$ & $2$ & 回転の中心\\
    鏡映 & $R_{\theta}$ & $\bm{b} \in V_{\theta}(-1)$ & $1$ & 鏡映軸  \\
    滑り鏡映 & $R_{\theta}$ & $\bm{b} \notin V_{\theta}(-1)$ & $3$ & 空集合\\ \hline
  \end{tabular}
  \caption{平面 $\mathbb{R}^2$ の合同変換の分類表}
  \label{tab:classification2}
\end{table}


ここでは，実際に平面 $\mathbb{R}^2$ の合同変
換 $f$ が表\ref{tab:classification2}のいずれかに分類され，またそれで全
てであることを確かめていこう．恒等変換と平行移動に関しては明らかなので，
以下 $f$ は恒等変換でも平行移動でもない，すなわち，$A \neq E$ とする．
また，直交行列 $S_{\theta}, R_{\theta}$ に対応する直交変換をそれぞ
れ $s_{\theta}, r_{\theta}$ と表す．

\subsubsection{回転}\label{sec:rotation2}

$A = S_{\theta} \in SO(2) \; (S_{\theta} \neq E)$ とする．このとき $f$ の固
定点は1点のみであり，$f$ はその固定点を中心とする $\theta$ 回転である．
このことを実際に確かめてみよう．

$S_{\theta}$ は $1$ を固有値に持たないので，$\det(E-S_{\theta}) \neq
0$ である．従って，$E-S_{\theta}$ は正則なので
\[
  \bm{x} \in \Inv(f) \Leftrightarrow S_{\theta} \bm{x} +\bm{b} =
  \bm{x} \Leftrightarrow (E-S_{\theta})\bm{x} = \bm{b} \Leftrightarrow
  \bm{x} = \left( E-S_{\theta}\right)^{-1} \bm{b}
\]
である．従って，$f$ の固定点
は $\bm{c}:=\left(E-S_{\theta}\right)^{-1}\bm{b}$ のみである．このとき，
任意の $\bm{x} \in \mathbb{R}^2$ に対して
\[
  f(\bm{x}) - \bm{c} = S_{\theta}(\bm{x}-\bm{c})
\]
である．よって，確かに $f$ は $\bm{c}$ を中心とする $\theta$ 回転である
ことがわかる（図\ref{fig:rotation2gen}）．また，これより
\[
  f = t_{\bm{c}} \circ s_{\theta} \circ t_{-\bm{c}}
\]
とも表せる．すなわち，$\bm{c}$ を中心とする回転は「一旦 $-\bm{c}$ 平行
移動し，原点を中心に回転させた後に再び $\bm{c}$ 平行移動する変換」と言
い換えることもできる．
\begin{figure}[h]
  \centering
  \includegraphics[height=4.5cm]{pictures/rotation2gen.pdf}
  \caption{$\bm{c}$ を中心とする $\theta$ 回転}
  \label{fig:rotation2gen}
\end{figure}


\subsubsection{鏡映と滑り鏡映}\label{sec:reflection2}

$A=R_{\theta} \in O(2) \setminus SO(2)$
とする．このとき，$\bm{b} \in
V_{\theta}(-1)$ なら $\Inv(f)$ は $\bm{b}/2$ を通り $V_{\theta}(1)$ に
平行な直線であり，$f$ はこの直線に関する鏡映である．一方，$\bm{b}
\notin V_{\theta}(-1)$ なら $\Inv(f)$ は空集合であり，$f$ は滑り鏡映で
ある．これを実際に確かめていこう．

直交変換 $r_{\theta}$ による平面の固有空間分解
$\mathbb{R}^2 = V_{\theta}(1) \oplus V_{\theta}(-1)$ によって $\bm{b}$
を
\begin{equation}\label{eq:eigendecomp2}
  \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} \in V_{\theta}(1), \; \bm{b}^{-} \in V_{\theta}(-1)
\end{equation}
と分解する．$R_{\theta}^2=E$ であるから，
\[
  x \in \Inv(f) \Leftrightarrow R_{\theta}\bm{x} +\bm{b}^{+} + \bm{b}^{-} =\bm{x} \Leftrightarrow
  \bm{x}+\bm{b}^{+}-\bm{b}^{-}=R_{\theta}\bm{x} \Leftrightarrow \bm{b}^{+} = \bm{0}
\]
である．従って，
\[
  \Inv(f) \neq \emptyset \Leftrightarrow \bm{b} \in V_{\theta}(-1)
\]
である．これより，$\bm{b} \in V_{\theta}(-1)$ かそうでないかによって合
同変換 $f$ を分けることができる．


まず，$\bm{b} \in V_{\theta}(-1)$ とする．$\Inv(f)$ が空集合でないので，
連立 $1$ 次方程式
\[
  (E-R_{\theta})\bm{x} = \bm{b}
\]
は解を持つ．$R_{\theta}$ は $1$ を固有値に持つので $\det
(E-R_{\theta}) = 0$ であり，$E-R_{\theta} \neq O$ だか
ら，$\rank(E-R_{\theta})=1$ である．従って，\ref{sec:inv2}節で見たよう
に $\Inv(f)$ は直線である．特に，
\[
  f\left( \frac{\bm{b}}{2}\right) = R_{\theta}\left(
    \frac{\bm{b}}{2}\right) + \bm{b} = -\frac{\bm{b}}{2} + \bm{b} = \frac{\bm{b}}{2}
\]
より $\bm{b}/2 \in \Inv(f)$ だから $\Inv(f)$ は $\bm{b}/2$ を通る．さら
に，任意の $\bm{x} \in \Inv(f)$ に対して，
\[
  (\bm{x}, \bm{b}) = (R_{\theta}\bm{x}, R_{\theta}\bm{b}) =
  (\bm{x}-\bm{b}, -\bm{b}) = -(\bm{x},\bm{b})+\|\bm{b}\|^2
\]
より $(\bm{x}, \bm{b}) = \|\bm{b}\|^2/2$ が成り立つから
$\left( \bm{x}-\frac{\bm{b}}{2}, \bm{b}\right) =0$ とな
り，$\Inv(f)$ と $\bm{b}$ は直交する．つま
り，$\Inv(f)$ は $V_{\theta}(-1)^{\perp}=V_{\theta}(1)$ に平行である．

$f$ は直線 $\Inv(f)$ に関する鏡映である．実際，任意の $\bm{x} \in
\mathbb{R}^2$ と任意の $\bm{p} \in V_{\theta}(1)$ に対して，
\begin{align*}
  \left( f\left(\bm{x}\right) - \bm{x}, \bm{p}\right) 
  &= (R_{\theta}\bm{x}, \bm{p}) +(\bm{b},\bm{p})-(\bm{x},\bm{p})=(R_{\theta}\bm{x}, R_{\theta}\bm{p})-(\bm{x}, \bm{p})
  =(\bm{x},\bm{p}) - (\bm{x}, \bm{p})=0,\\
  f\left(\frac{f(\bm{x})+\bm{x}}{2}\right) 
  &= R_{\theta}\left(
    \frac{R_{\theta}\bm{x} + \bm{b} + \bm{x}}{2}\right) + \bm{b}
  =\frac{\bm{x}-\bm{b}+R_{\theta}\bm{x}}{2} + \bm{b}
  =\frac{R_{\theta}\bm{x}+\bm{b} + \bm{x}}{2} = \frac{f(\bm{x})+\bm{x}}{2}
\end{align*}
であるから，$f(\bm{x})-\bm{x}$ が $V_{\theta}(1)$ に，従っ
て $\Inv(f)$に，直交し，$f(\bm{x})$ と $\bm{x}$ の中点が $\Inv(f)$ 上に
あるので，$f$ は直線 $\Inv(f)$ に関する鏡映である（
図\ref{fig:reflection2gen}）．
\begin{figure}[h]
  \centering
  \includegraphics[height=4.5cm]{pictures/reflection2gen.pdf}
  \caption{直線 $\Inv(f)$ に関する鏡映}
  \label{fig:reflection2gen}
\end{figure}

また，任意の $\bm{c} \in \Inv(f)$ に対して
\[
  f(\bm{x}) =  R_{\theta}\left( \bm{x} - \bm{c}\right) + \bm{c}
\]
が成り立つから，
\[
  f = t_{\bm{c}} \circ r_{\theta} \circ t_{-\bm{c}}
\]
である．すなわち，$\bm{c}$ を通り $V_{\theta}(1)$ に平行な直線に関する
鏡映は「一旦 $-\bm{c}$ 平行移動し，$V_{\theta}(1)$ に関する鏡映移動をし
た後に再び $\bm{c}$ 平行移動する変換」と言い換えることもできる（
図\ref{fig:reflection2gen2}）．
\begin{figure}[h]
  \centering
  \includegraphics[height=5cm]{pictures/reflection2gen2.pdf}
  \caption{$\bm{c}$ を通り $V_{\theta}(1)$ に平行な直線に関する鏡映}
  \label{fig:reflection2gen2}
\end{figure}


次に，$\bm{b} \notin V_{\theta}(-1)$ とする．このとき $f$ は滑り鏡映で
あることを確かめよう．なお，平面上の滑り鏡映の定義は次の通りである．

\begin{definition}
  平面上の直線 $L$ に関する鏡映 $g$ と $L$ に平行なベクトル $\bm{c}
  \in \mathbb{R}^2$ による平行移動 $t_{\bm{c}}$ との合成 $t_{\bm{c}}
  \circ g$ を $L$ と $\bm{c}$ に関する（平面上の）滑り鏡映または並進鏡
  映という．この定義に従えば，滑り鏡映は鏡映（$\bm{c}=\bm{0}$ のとき）
  を含むのだが，鏡映でないもののみを滑り鏡映と呼ぶことにする．
\end{definition}


$\bm{b}$ を式 (\ref{eq:eigendecomp2})のように分解すると，$\bm{b}^{+}
\neq \bm{0}$ である．従って，
\[
  f(\bm{x}) = \left(R_{\theta}\bm{x} + \bm{b}^{-}\right) + \bm{b}^{+}
\]
である．$g(\bm{x}) = R_{\theta}\bm{x}+\bm{b}^{-}$
とおくと，$f= t_{\bm{b}^{+}} \circ g$ である．$\bm{b}^{-} \in
V_{\theta}(-1)$ だから $g$ は直線 $\Inv(g)$ に関する鏡映である．ま
た，$\bm{b}^{+} \in V_{\theta}(1)$ より $\bm{b}^{+}$ は $\Inv(g)$ と平
行である．よって，$f$ は $\bm{b}^{-}/2$ を通り $V_A(1)$ に平行な直線と
ベクトル $\bm{b}^{+}$ に関する滑り鏡映である（図\ref{fig:glide2}）．
 \begin{figure}[h]
   \centering
   \includegraphics[height=4.5cm]{pictures/glide2.pdf}
   \caption{滑り鏡映}
   \label{fig:glide2}
 \end{figure}

 なお，鏡映と平行移動を合成する順番はどちらでもよい．実際，$R_{\theta}\bm{b}^{+}=\bm{b}^{+}$ より
\[
  g \left(t_{\bm{b}^{+}}(\bm{x})\right) = R_{\theta}\left(\bm{x} + \bm{b}^{+}\right) + \bm{b}^{-}
  = \left(R_{\theta}\bm{x} + \bm{b}^{-}\right) + \bm{b}^{+} = t_{\bm{b}^{+}}\left(g(\bm{x})\right)
\]
であるから，$g \circ t_{\bm{b}^{+}} = t_{\bm{b}^{+}} \circ g$ である．

 最後に，内積による鏡映と滑り鏡映の判別方法をまとめておこ
 う．$R_{\theta}$ の単位固有ベクトルに
 \[
   \bm{p}^{+}_{\theta} = \left[
     \begin{array}{r}
       \cos(\theta/2)\\
       \sin(\theta/2)
     \end{array}
   \right] \in V_{\theta}(1), \quad \bm{p}^{-}_{\theta} = \left[
     \begin{array}{r}
       -\sin(\theta/2)\\
       \cos(\theta/2)
     \end{array}
   \right] \in V_{\theta}(-1)
 \]
 と名前を付ける．$\left(\bm{p}_{\theta}^{+}, \bm{p}_{\theta}^{-}\right)$ は $\mathbb{R}^2$ の
 正規直交基底だから式(\ref{eq:eigendecomp2})における $\bm{b}^{+},
 \bm{b}^{-}$ はそれぞれ
 \[
   \bm{b}^{+} = (\bm{b}, \bm{p}_{\theta}^{+}) \bm{p}_{\theta}^{+} ,
   \quad  \bm{b}^{-} =  (\bm{b}, \bm{p}_{\theta}^{-})\bm{p}_{\theta}^{-}
 \]
 と表せる．これより，合同変換 $f(\bm{x}) = R_{\theta} \bm{x} + \bm{b}$
 は以下の2つに分けられる．
 \begin{itemize}
   \setlength{\itemsep}{1zh}
 \item $\left(\bm{b}, \bm{p}_{\theta}^{+} \right)=0$ のと
   き，$f$ は $\bm{b}/2$ を通り $V_{\theta}(1)$ に平行な直線に関する鏡
   映である．
   
 \item $\left(\bm{b}, \bm{p}_{\theta}^{+}\right) \neq 0$ のと
   き，$f$ は
   $\left(\bm{b},\bm{p}_{\theta}^{-}\right)\bm{p}_{\theta}^{-}/2$ を通
   り $V_{\theta}(1)$ に平行な直線とベクト
   ル $(\bm{b},\bm{p}_{\theta}^{+})\bm{p}_{\theta}^{+}$ に関する滑り鏡
   映である．
 \end{itemize}



\subsection{鏡映の個数}

平面の合同変換それぞれに対し，それを合成する鏡映を全て調べ上げ，分
類表\ref{tab:classification2}を完成させよう．

% \begin{definition}
%   平面上の $3$ 点が同一直線上にないとき，その $3$ 点は一般の位置にある
%   という．
% \end{definition}

% \begin{theorem}\label{thm:identity2}
%   平面上の一般の位置にある $3$ 点を固定する合同変換は恒等変換である．
% \end{theorem}

% \begin{proof}
%   $\bm{p}_0, \bm{p}_1, \bm{p}_2 \in \mathbb{R}^2$ は一般の位置にあると
%   し，平面の合同変換 $f$ は $\bm{p}_0, \bm{p}_1, \bm{p}_2$ を固定すると
%   する．このとき，$\bm{p}_0, \bm{p}_1, \bm{p}_2 \in \Inv(f)$ だか
%   ら $\Inv(f)$ 空でも $1$ 点集合でもない．さらに，$\bm{p}_0, \bm{p}_1,
%   \bm{p}_2$ は同一直線上にないから $\Inv(f)$ は直線でもない．よっ
%   て，\ref{sec:inv2}節で見たように $\Inv(f)=\mathbb{R}^2$ であるか
%   ら $f$ は恒等変換である．
% \end{proof}





\begin{theorem}\label{thm:generate2}
  平面 $\mathbb{R}^2$ の任意の合同変換は
  $3$個以下の鏡映の合成として表せる．特に，各合同変換に対してそれを合成
  する鏡映の最小個数は表\ref{tab:classification2}にある通りである．
\end{theorem}
\begin{proof}
  恒等変換は $0$ 個，鏡映は $1$ 個の鏡映の合成であり，またそれ以外の合
  同変換は $1$ 個以下の鏡映の合成として表せないは明らかである．残りの平
  行移動，回転，滑り鏡映に関しては以下に続く補
  題\ref{lem:translation2ref}，補題\ref{lem:rotaion2ref}，補
  題\ref{lem:glide2ref}により証明が完成する．
\end{proof}

  
\begin{lemma}\label{lem:translation2ref}
  \begin{enumerate}[(1)]
  \item 平面 $\mathbb{R}^2$ の平行移動 $t_{\bm{b}} \; (\bm{b} \neq
    \bm{0})$ は平行な $2$ 直線に関する $2$ 個の鏡映の合成である．このと
    き，$2$ つの鏡映軸は共に $\bm{b}$ に直交し，その距離
    は $\|\bm{b}\|/2$ である．
    
  \item 逆に，平面 $\mathbb{R}^2$ の平行な $2$ 直線 $L_1, L_2 \;(L_1
    \neq L_2)$ に関する鏡映 $g_1, g_2$ の合成 $g_2 \circ g_1$ は平行移
    動である．移動方向は $L_1$ から $L_2$ の方へ両直線に直交する方向で，
    移動距離は $2$ 直線の距離の $2$ 倍である．
  \end{enumerate}
  
\end{lemma}

\begin{proof}
  (1) $\bm{b} \in V_{\theta}(-1)$ となる $\theta \in \mathbb{R}$ をとる．
  このとき，合同変換 $g(\bm{x})=R_{\theta}\bm{x}+\bm{b}$ は $\bm{b}/2$
  を通り $V_{\theta}(1)$ を通る直線 $L$ に関する鏡映である．従って，任
  意の $\bm{x} \in \mathbb{R}^2$ に対して
  \[
    g\left(r_{\theta}(\bm{x})\right) =
    R_{\theta}\left(R_{\theta}\bm{x}\right)+\bm{b} =
    \bm{x}+\bm{b}=t_{\bm{b}}(\bm{x})
  \]
  であるから $t_{\bm{b}}$ は $2$ 個の鏡映の合成 $g \circ r_{\theta}$ で
  ある．また，図\ref{fig:translation2}のように $g, r_{\theta}$ の鏡映
  軸 $L, V_{\theta}(1)$ はそれぞれ $\bm{b}/2, \bm{0}$ を通り共
  に $\bm{b}$ に直交し，$2$ 直線の距離は $\|\bm{b}\|/2$ である．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4cm]{pictures/translation2.pdf}
    \caption{平行移動は平行な $2$ 直線に関する鏡映の合成である．}
    \label{fig:translation2}
  \end{figure}

  \noindent
  (2) 逆に，平行な $2$ 直線 $L_1, L_2 \; (L_1 \neq L_2)$ に関する鏡映の
  合成が平行移動となることを示す．$L_1, L_2$ が $x$ 軸とのなす角
  を $\theta/2$ とすると，$L_1, L_2$ に関する鏡映 $g_1, g_2$ は
  \[
    g_1(\bm{x}) = R_{\theta} \bm{x} + \bm{b}_1, \quad  g_2(\bm{x}) =R_{\theta}\bm{x} + \bm{b}_2 
    \quad \left( \bm{b}_1, \bm{b}_2 \in V_{\theta}(-1), \; \bm{b}_1 \neq \bm{b}_2\right)
  \]
  と書ける．ただし，$L_1, L_2$ はそれぞれ $\bm{b}_1/2, \bm{b}_2/2$ を通
  る．これより任意の $\bm{x} \in \mathbb{R}^2$ に対して
  \[
    g_2 \circ g_1 (\bm{x}) = R_{\theta}\left(R_{\theta}\bm{x} + \bm{b}_1\right)+\bm{b}_2
    = \bm{x} + \bm{b}_2 - \bm{b}_1
  \]
  だから，$g_2 \circ g_1$ は平行移動 $t_{\bm{b}_2-\bm{b}_1}$ である．ま
  た，図\ref{fig:translation2gen}のようにその移動方向
  は $L_1$ から $L_2$ の方へ両直線に直交する方向であり，移動距
  離 $\|\bm{b}_2-\bm{b}_1\|$ は $L_1, L_2$ の距離の $2$ 倍である．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4cm]{pictures/translation2gen.pdf}
    \caption{鏡映軸が平行な2つの鏡映の合成は平行移動である．}
    \label{fig:translation2gen}
  \end{figure}
\end{proof}

\begin{lemma}\label{lem:rotaion2ref}
  \begin{enumerate}[(1)]
  \item 平面 $\mathbb{R}^2$ の $\theta$ 回転は回転の中心で交わる $2$ 直
    線に関する $2$ 個の鏡映の合成である．このとき，鏡映軸同士のなす角
    は $\theta/2$ である．

  \item 逆に，平面 $\mathbb{R}^2$ の平行でない $2$ 直線 $L_1, L_2$ に関
    する鏡映 $g_1, g_2$ の合成 $g_2 \circ g_1$ は $2$ 直線の交点を中心
    とする $L_1$ から $L_2$ の方への回転である．回転角は $2$ 直線
    のなす角の $2$ 倍である．
  \end{enumerate}
\end{lemma}

\begin{proof}
  (1) $f$ を $\bm{c} \in \mathbb{R}^2$ を中心とする平面の $\theta$ 回転
  とする．$f(\bm{x}) = S_{\theta}(\bm{x}-\bm{c})+\bm{c}$ と書ける．
  \[
    g_1(\bm{x})=R_0(\bm{x}-\bm{c})+\bm{c}, \quad g_2 (\bm{x}) = R_{\theta}(\bm{x}-\bm{c})+\bm{c}
    \quad (\theta \neq 0)
  \]
  とすると，$g_1$ は $x$ 軸に平行で $\bm{c}$ を通る直線 $L_1$ に関する
  鏡映であり，$g_2$ は $V_{\theta}(1)$に平行で $\bm{c}$ を通る直
  線 $L_2$ に関する鏡映である．このとき，任意の $\bm{x} \in
  \mathbb{R}^2$ に対して
  \begin{align*}
    g_2 \circ g_1(\bm{x}) = R_{\theta}\left( R_{0}(\bm{x}-\bm{c}) + \bm{c} - \bm{c} \right) + \bm{c}
    = S_{\theta} (\bm{x}-\bm{c}) +\bm{c} = f(\bm{x})
  \end{align*}
  より，$f$ は $2$ 個の鏡映の合成 $g_2 \circ g_1$ である．
  図\ref{fig:rotation2ref}のように鏡映軸 $L_1, L_2$ のなす角
  は $\theta/2$ である．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4cm]{pictures/rotation2ref.pdf}
    \caption{回転は平行でない $2$ 直線に関する鏡映の合成である．}\label{fig:rotation2ref}
  \end{figure}

  \noindent
  (2) 逆に，平行でない $2$ 直線 $L_1, L_2$ に関する鏡映の合成が回転とな
  ることを示す．$L_1, L_2$ が $x$ 軸となす角をそれぞれ $\theta/2,
  \phi/2$ とすると，$L_1, L_2$ に関する鏡映 $g_1, g_2$ は
  \[
    g_1(\bm{x}) = R_{\theta} \bm{x} + \bm{b}_1, \quad g_2(\bm{x}) = R_{\phi}\bm{x} + \bm{b}_2 \quad
    \left(\bm{b}_1 \in V_{\theta}(-1), \; \bm{b}_2 \in V_{\phi}(-1) \right)
  \]
  と書ける．ただし，$L_1, L_2$ はそれぞれ $\bm{b}_1/2, \bm{b}_2/2$ を通
  る．これより任意の $\bm{x} \in \mathbb{R}^2$ に対して
  \[
    g_2 \circ g_1(\bm{x}) = R_{\phi}( R_{\theta}\bm{x}+\bm{b}_1) + \bm{b}_2
    = S_{\phi-\theta} \bm{x} + R_{\phi}\bm{b}_1 +\bm{b}_2
  \]
  だから，$g_2 \circ
  g_1$ は
  $\bm{c}:=(E-S_{\phi-\theta})^{-1}\left(R_{\phi}\bm{b}_1+\bm{b}_2\right)$
  を中心とする $\phi-\theta$ 回転である．鏡映軸 $L_1, L_2$ の交点
  を $\bm{c}' \in L_1 \cap L_2$ とすると，$\bm{c}' \in \Inv(g_2 \circ
  g_1)$ である．回転の固定点は中心点だけなので $\bm{c}'=\bm{c}$ である．
  また，図\ref{fig:rotation2refgen}のように回転方向は $L_1$ から $L_2$
  の方へ，回転角 $\phi-\theta$ は $L_1$ と $L_2$ のなす角の $2$ 倍である．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4.5cm]{pictures/rotation2refgen.pdf}   
    \caption{鏡映軸が平行でない2つの鏡映の合成は回転である．}
    \label{fig:rotation2refgen}
  \end{figure}
\end{proof}


\begin{lemma}\label{lem:glide2ref}
  平面 $\mathbb{R}^2$ の滑り鏡映は $3$ 個の鏡映の合成として表せる．また，
  滑り鏡映は $2$ 個以下の鏡映の合成としては表せない．
\end{lemma}
  
\begin{proof}
  $f$ を平面 $\mathbb{R}^2$
  の滑り鏡映とする．$f(\bm{x}) = R_{\theta}\bm{x} + \bm{b} \; (\theta
  \neq 0, \; \bm{b} \notin V_{\theta}(-1))$ と書ける．
  \[
    \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} \in
    V_{\theta}(1), \quad \bm{b}^{-} \in V_{\theta}(-1),
    \quad \bm{b}^{+} \neq \bm{0}
  \]
  とし，$g_1(\bm{x}) = R_{\theta} \bm{x} + \bm{b}^{-}$ とす
  る．$g_1$ は $\bm{b}^{-}/2$ を通り $V_{\theta}(1)$ に平行な直
  線 $L_1$ に関する鏡映である．
  \[
    f(\bm{x}) = \left( R_{\theta}\bm{x} + \bm{b}^{-}\right) +
    \bm{b}^{+} = t_{\bm{b}^{+}}\left( g_1(\bm{x})\right)
  \]
  より，$f=t_{\bm{b}^{+}}\circ g_1$ である．さらに，補
  題\ref{lem:translation2ref}(1)より平行移
  動 $t_{\bm{b}^{+}}$ は図\ref{fig:glide2ref}のように平行
  な $2$ 直線 $L_2, L_3$ に関する鏡映 $g_2, g_3$ の合成として表せる．実
  際，$L_2, L_3$ をそれぞれ $\bm{0}, \bm{b}^{+}/2$ を通り共
  に $\bm{b}^{+}$ に平行な直線とすれば $t_{\bm{b}^{+}} = g_2 \circ
  g_1$ である．よって，
  \[
    f = g_3 \circ g_2 \circ g_1
  \]
  より $f$ は $3$ 個の鏡映の合成である．また，補
  題\ref{lem:translation2ref}(2)と補題\ref{lem:rotaion2ref}(2)から $2$
  個の鏡映の合成は恒等変換か平行移動か回転なので，滑り鏡映を $2$ 個以下
  の鏡映の合成として表すことはできない．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4cm]{pictures/glide2ref.pdf}
    \caption{滑り鏡映は $3$ 個の鏡映の合成である．}
    \label{fig:glide2ref}
  \end{figure}
\end{proof}



\subsection{平面の合同変換と $3$ 次正方行列}

平面 $\mathbb{R}^2$ の合同変換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は $3$ 次
正方行列と $3$ 次列ベクトルの積を用いて
\begin{align*}
  \left[
  \begin{array}{c}
    f(\bm{x})\\
    1
  \end{array}
  \right] = \left[
  \begin{array}{cc}
    A & \bm{b}\\
    \bm{0} & 1
  \end{array}
             \right] \left[
             \begin{array}{c}
               \bm{x}\\
               1
             \end{array}
  \right]
\end{align*}
と表すことができる．さらに，合同変換
$f_1(\bm{x})=A_1 \bm{x} + \bm{b}_1, \, f_2(\bm{x}) = A_2\bm{x} +
\bm{b}_2$ の合成
\[
  f_1\circ f_2(\bm{x}) =  f_1\left( f_2\left( \bm{x}\right) \right) 
  = f_1\left( A_2 \bm{x}+\bm{b}_2\right) = A_1 A_2 \bm{x} + \bm{b}_1+A_1\bm{b}_2
\]
は $3$ 次正方行列同士の積として
\begin{align*}
  \left[
  \begin{array}{cc}
    A_1 & \bm{b}_1\\
    \bm{0} & 1
  \end{array}
             \right] \left[
             \begin{array}{cc}
               A_2 & \bm{b}_2\\
               \bm{0} & 1
             \end{array}
                        \right] = \left[
                        \begin{array}{cc}
                          A_1 A_2 & \bm{b}_1+A_1\bm{b}_2\\
                          \bm{0} & 1
                        \end{array}
                                   \right]
\end{align*}
と表せる．これにより平面 $\mathbb{R}^2$ の合同変換を $3$ 次正方行列の演算で記述できる．

例えば，$2$ つの合同変換
\[
  f_1(\bm{x}) = \left[
    \begin{array}{rr}
      0 & -1\\
      1 & 0
    \end{array}
  \right] \bm{x} + \left[
    \begin{array}{r}
      1\\
      2
    \end{array}
  \right], \qquad f_2(\bm{x}) = \left[
    \begin{array}{rr}
      0 & 1\\
      1 & 0
    \end{array}
  \right] \bm{x} + \left[
    \begin{array}{r}
      -1\\
      1
    \end{array}
  \right]
\]
の合成 $f_1 \circ f_2$ は
\[
  f_1( f_2(\bm{x})) = \left[
    \begin{array}{rr}
      0 & -1\\
      1 & 0
    \end{array}
  \right] \left( \left[
      \begin{array}{rr}
        0 & 1\\
        1 & 0
      \end{array}
    \right] \bm{x} + \left[
      \begin{array}{r}
        -1\\
        1
      \end{array}
    \right] \right) + \left[
    \begin{array}{r}
      1\\
      1
    \end{array}
  \right] = \left[
    \begin{array}{rr}
      -1 & 0\\
      0 & 1
    \end{array}
  \right] \bm{x} + \left[
    \begin{array}{r}
      0\\
      1
    \end{array}
  \right]
\]
であるが，これが $3$ 次正方行列同士の積として
\[
  \left[
    \begin{array}{rr|r}
      0 & -1 & 1\\
      1 & 0 & 2\\ \hline
      0 & 0 & 1
    \end{array}
  \right] \left[
    \begin{array}{rr|r}
      0 & 1 & -1\\
      1 & 0 & 1\\ \hline
      0 & 0 & 1
    \end{array}
  \right] = \left[
    \begin{array}{rr|r}
      -1 & 0 & 0\\
      0 & 1 & 1\\ \hline
      0 & 0 & 1
    \end{array}
  \right]
\]
と計算できる．この右辺の $3$ 次正方行列の左上部分と右上部分が，それぞれ
合成 $f_1(f_2(\bm{x}))=A\bm{x} + \bm{b}$ の直交行列 $A$ と平面ベクト
ル $\bm{b}$ である．このように全てを行列演算にしてしまうことで計算機で
合同変換が扱いやすくなる．なお，これは平面上のアフィン変換や射影平面上
の射影変換を $3$ 次正方行列によって表現する手法の特殊な場合でもある．

\newpage

\subsection*{演習問題\ref{sec:2dim}}

\begin{enumerate}
  \setlength{\itemsep}{1zh}

\item 次の平面の合同変換を $f(\bm{x}) = A\bm{x} + \bm{b}$
  の形に書き下そう．
  \begin{enumerate}[(1)]
  \item 点 $(c_1, c_2)$ を中心とする $\theta$ 回転 
  \item 直線 $\alpha x + \beta y + \gamma =0$ に関する鏡映
  \item 点 $(c_1, c_2)$ を通り $x$ 軸とのなす角が $\theta$ の直線
    と，$x$ 軸とのなす角が $\theta$ で大きさが $k >0$ のベクトルに関す
    る滑り鏡映
  \end{enumerate}

\item 次の平面の合同変換が分類表\ref{tab:classification2}のどれに当て
  はまるか判定しよう．また，回転に対しては中心と回転角を，鏡映に対して
  は軸の方程式を，滑り鏡映に対しては軸の方程式と平行移動ベクトルを明示
  しよう．

  \vspace{1zh}

  \begin{enumerate}[(1)]
    \setlength{\itemsep}{1zh}

  \item $\ds f_1(\bm{x}) = \frac{1}{5}\left[
      \begin{array}{rr}
        3 & -4\\
        4 & 3
      \end{array}
    \right]\bm{x}+\left[
      \begin{array}{r}
        2\\
        1
      \end{array}
    \right]$

  \item $\ds f_2(\bm{x})=\frac{1}{5} \left[
      \begin{array}{rr}
        4 & 3\\
        3 & -4
      \end{array}
    \right]\bm{x} + \left[
      \begin{array}{r}
        2\\
        -6
      \end{array}
    \right]$
    
  \item $\ds f_3(\bm{x})=\frac{1}{13}\left[
      \begin{array}{rr}
        12 & 5\\
        5 & -12
      \end{array}
    \right]\bm{x}+ \left[
      \begin{array}{r}
        1\\
        1
      \end{array}
    \right]$
    
  \item $f_4=f_1 \circ f_2$

  \item $f_5=f_2 \circ f_1$

  \item $\ds f_6(\bm{x}) = f_2\left( \frac{1}{5}\left[
      \begin{array}{rr}
        4 & 3\\
        3 & -4
      \end{array}
    \right] \bm{x} + \left[
      \begin{array}{r}
        -1\\
        3
      \end{array}
    \right]\right)$

  \item $\ds f_7 (\bm{x})= f_3(\bm{x}) - \frac{1}{13}\left[
      \begin{array}{r}
        15\\
        3
      \end{array}
    \right]$

  \item $\ds f_8= f_7 \circ f_2$
  \end{enumerate}

\item 適当なプログラミング環境のもとで，$2$ 次直交行列 $A$ と $2$ 次列
  ベクトル $\bm{b}$ が与えられたときに平面の合同変換
  \[
    f(\bm{x}) = A\bm{x} + \bm{b}
  \]
  が表\ref{tab:classification2}のどれに当てはまるか判定するプログラムを
  作成しよう．また，回転に対しては中心と回転角，鏡映に対しては軸の方程
  式，滑り鏡映に対しては軸の方程式と平行移動ベクトルなどの情報も出力し
  よう．

\item 平面の合同変換 $f_1, f_2$ の合成$f_1 \circ f_2$ を分類しよう．
\end{enumerate}


\newpage

\section{空間の合同変換}\label{sec:3dim}

$f$ を空間 $\mathbb{R}^3$ の合同変換とする．定理\ref{thm:affine_rep}か
ら $3$ 次直交行列と空間ベクトル $\bm{b} \in \mathbb{R}^3$ によって
\[
  f(\bm{x}) = A \bm{x} + \bm{b}
\]
と書ける．$f$ はその固定点集合によって特徴づけられる．なお，以下 $\mathbb{R}^3$ の標準基底 $(\bm{e}_1, \bm{e}_2, \bm{e}_3)$
は右手系をなすとする．

\subsection{固定点集合}\label{sec:inv3}

$f(\bm{x}) = \bm{x}$ を満たす $\bm{x} \in \mathbb{R}^3$ を $f$ の固定点という．$f$ の固定点集合
\[
  \Inv(f) := \Set{\bm{x} \in \mathbb{R}^3 | f(\bm{x}) = \bm{x}}
\]
が空間 $\mathbb{R}^3$ の中でどのような図形になるかを考えよう．
\[
  f(\bm{x}) = \bm{x} \Leftrightarrow A\bm{x} + \bm{b} = \bm{x}
  \Leftrightarrow (E-A)\bm{x} = \bm{b}
\]
であるから，$\Inv(f)$ は $3$ 変数連立 $1$ 次方程
式 $(E-A)\bm{x}=\bm{b}$ の解全体のなす集合である．従って，$\Inv(f)$ は
空集合，$1$ 点集合，直線，平面，空間全体のいずれかである．特に，$f$ が
恒等変換のとき，またそのときに限り，$\Inv(f) = \mathbb{R}^3$ となる．すなわち，
\[
  A=E \text{ かつ } \bm{b} = \bm{0} \Leftrightarrow f =
  \id_{\mathbb{R}^3} \Leftrightarrow \Inv(f) = \mathbb{R}^3
\]
である．また，
\[
  A=E \text{ かつ } \bm{b} \neq \bm{0} \Rightarrow \Inv(f) = \emptyset
\]
である．すなわち，$\bm{0}$ でないベクトル $\bm{b}$ による平行移
動 $t_{\bm{b}}$ は固定点を持たない．

$A$ が $1$ を固有値に持たないとき，$\det(E-A) \neq 0$ だから $E-A$ は正
則である．従って，このとき連立 $1$ 次方程式 $(E-A)\bm{x}=\bm{b}$ は唯一
つの解 $\bm{x} = (E-A)^{-1}\bm{b}$ を持つので，$\Inv(f)$ は $1$ 点集合
である．すなわち，以下が成り立つ．
\[
  \text{ $1$ は $A$ の固有値でない } \Rightarrow \Inv(f) =
  \Set{(E-A)^{-1}\bm{b}}
\]


$A$ が $1$ を固有値に持つとき，その固有空間 $V_A(1)$ は同次形連立 $1$
次方程式 $(E-A)\bm{x}=\bm{0}$ の解空間に等しい．さらに，連立 $1$ 次方程
式 $(E-A)\bm{x}=\bm{b}$ が解を持つなら，その一般解は特殊解 $\bm{x}_0$
を用いて$\bm{x} = \bm{x}_0 + \bm{x}_1 \; (\bm{x}_1 \in V_A(1))$ と書け
る．すなわち，
\[
  \text{$1$ が $A$ の固有値かつ } \Inv(f) \neq \emptyset \Rightarrow
  \Inv(f) = \Set{ \bm{x}_0 + \bm{x}_1 | \bm{x}_1 \in V_A(1)}
\]
である．特に，$\dim V_A(1) = 2$ なら $\Inv(f)$ は $\bm{x}_0$ を通
り $V_A(1)$ に平行な平面であり，$\dim
V_A(1)=1$ なら $\Inv(f)$ は $\bm{x}_0$ を通り $V_A(1)$ に平行な直線であ
る．なお，連立 $1$ 次方程式 $(E-A)\bm{x} = \bm{b}$ が解を持たなけれ
ば，$\Inv(f)$ は空集合である．

\subsection{空間の直交変換}

$3$ 次直交行列全体の集合を $O(3)$ と書く．また，$SO(3):=\Set{ A \in
  O(2) | \det A=1}$ とする．

$3$ 次直交行列は固有値の絶対値が $1$ で，
以下のどちらか一方の形に標準化できることを示そう．
\[
  S_{\theta} := \left[
    \begin{array}{ccc}
      \cos \theta & -\sin\theta & 0\\
      \sin \theta & \cos\theta & 0\\
      0 & 0 & 1
    \end{array}
  \right], \quad R_{\theta} := \left[
    \begin{array}{ccc}
      \cos\theta & -\sin\theta & 0\\
      \sin\theta & \cos\theta & 0\\
      0 & 0 & -1
    \end{array}
  \right] \quad ( \theta \in \mathbb{R})
\]

\begin{theorem}\label{thm:eigenvalue3}
  $3$ 次直交行列 $A$ は $\det A \; \left( = \pm 1\right)$ を固有値に持つ．
\end{theorem}

\begin{proof}
  $A$ を $3$ 次直交行列とする．$A$ の固有方程式 $\det(x E -A)=0$ は実数
  係数 $3$ 次方程式なので，中間値の定理から実解を持つ．つまり，$A$ は実
  固有値 $\alpha$ を持つ．直交変換 $T_A(\bm{x}) = A\bm{x}$ は内積を保つ
  から，固有値 $\alpha$ の固有ベクトル $\bm{x} \left( \neq
    \bm{0}\right)$ に対して
  \[
    (\bm{x}, \bm{x}) = \left(T_A(\bm{x}), T_A(\bm{x}) \right)=
    (A\bm{x}, A\bm{x}) = (\alpha \bm{x}, \alpha \bm{x}) = \alpha^2
    (\bm{x}, \bm{x})
  \]
  より $\alpha^2 = 1$ である．従って，$\alpha=1$ または $\alpha=-1$ で
  ある．

  $A$ の3個の固有値が全て実数の場合，可能な組み合わせ
  は，$1,1,1$ か $1,-1,-1$ か $-1, 1,1$ か $-1,-1,-1$ であり，
  全固有値の積は $\det A$ に等しいので，いずれも $\det A$ は $A$ の固有値であ
  る．

  $3$ 個の固有値が実数 $\alpha \left( = \pm 1\right) $ と $2$
  個の互いに共役な複素数 $\lambda, \bar{\lambda}$の場合，$|\det A|=1$
  なので
  \[
    1 = |\det A| = |\alpha \lambda \bar{\lambda}| = |\lambda \bar{\lambda}| = \lambda \bar{\lambda}
  \]
  である．よって，$\det A = \alpha \lambda \bar{\lambda}=\alpha$ より $\det A$ は $A$ の固有値であ
  る．
\end{proof}


\begin{theorem}\label{thm:stdform3}
  任意の $A \in O(3)$ に対して，以下を満たす直交行列 $P \in
  SO(3)$が存在する．
  \[
    P^{-1} A P = {}^{t}P A P = 
    \begin{cases}
      S_{\theta} & (\det A=1)\\
      R_{\theta} & (\det A=-1)
    \end{cases}
  \]
\end{theorem}

\begin{proof}
  $A \in O(3)$ とし，$\det A=1$ とする．定
  理\ref{thm:eigenvalue3}より $A$ は $1$ を固有値に持つ．$\bm{p}_3$ を
  固有値 $1$ の単位固有ベクトルとし，$(\bm{p}_1,
  \bm{p}_2)$ を $\langle \bm{p}_3 \rangle$ の直交補空間
  $\langle \bm{p}_3 \rangle^{\perp} \subset \mathbb{R}^3$ の正規直交基
  底とすると，$(\bm{p}_1, \bm{p}_2, \bm{p}_3)$ は $\mathbb{R}^3$ の正規
  直交基底である．従って，$P=\left[
    \begin{array}{ccc}
      \bm{p}_1 & \bm{p}_2 & \bm{p}_3
    \end{array}
  \right]$ とすると $P$ は直交行列である．さらに，$\det
  P=-1$ なら $\bm{p}_1$ と $\bm{p}_2$ を入れ替えることで $\det P=1$ と
  できるので $P \in SO(3)$ としてよい．$\mathbb{R}^3$ の直交変
  換 $T_A(\bm{x}) = A\bm{x}$ に対して，$T_A(\bm{p}_3) = A\bm{p}_3=
  \bm{p}_3$ だから，
  \[
    (T_A(\bm{p}_i), \bm{p}_3) = (T_A(\bm{p}_i), T_A(\bm{p}_3)) = (\bm{p}_i, \bm{p}_3) =0 \quad (i=1,2)
  \]
  である．これより，
  \[
    T_A(\bm{p}_1) = b_{11} \bm{p}_1 + b_{21} \bm{p}_2+ b_{31} \bm{p}_3, \quad 
    T_A(\bm{p}_2) = b_{12} \bm{p}_1 + b_{22} \bm{p}_2+ b_{32} \bm{p}_3 \quad (b_{ij} \in \mathbb{R})
  \]
  とすると，
  \[
    0 = (T_A(\bm{p}_1), \bm{p}_3) = b_{31}, \quad 0=(T_A(\bm{p}_2), \bm{p}_3) = b_{32}
  \]
  であるから，
  \[
    (T_A(\bm{p}_1), T_A(\bm{p}_2), T_A(\bm{p}_3)) = (\bm{p}_1, \bm{p}_2, \bm{p}_3) \left[
      \begin{array}{ccc}
        b_{11} & b_{12} & 0\\
        b_{21} & b_{22} & 0\\
        0 & 0 & 1
      \end{array}
    \right]
  \]
  である．すなわち，基底 $(\bm{p}_1, \bm{p}_2, \bm{p}_3)$ に関する直交
  変換 $T_A$ の表現行列は
  \[
    P^{-1}AP= {}^{t}PAP = \left[
      \begin{array}{ccc}
        b_{11} &  b_{12} & 0\\
        b_{21} & b_{22} & 0\\
        0 & 0 & 1
      \end{array}
    \right]
  \]
  である．正規直交基底に関する直交変換の表現行列は直交行列なの
  で，$P^{-1}AP$ は直交行列である．これより，$2$ 次正方行列 $\left[
    b_{ij} \right]$
  は直交行列である．さらに，$\det \left( P^{-1}AP\right) = \det A=1$ よ
  り$\det \left[ b_{ij}\right] =1$ である．よって，ある $\theta \in
  \mathbb{R}$ によって
  \[
    P^{-1}AP = {}^{t}P AP = \left[
      \begin{array}{ccc}
        \cos \theta & -\sin \theta & 0\\
        \sin \theta & \cos \theta & 0\\
        0 & 0 & 1
      \end{array}
    \right]
  \]
  と書ける．$\det A=-1$ のときは固有値 $-1$ の単位固有ベクトル
  を $\bm{p}_3$ として同様に示せる．
\end{proof}

\begin{definition}
  $A,B \in O(3)$ に対して $B={}^{t}PAP$ となる $P \in SO(3)$ が存在する
  とき，$A \sim B$ と書く．
\end{definition}

$A \in O(3)$ が $P=\left[
  \begin{array}{ccc}
    \bm{p}_1 & \bm{p}_2 & \bm{p}_3
  \end{array}
\right] \in SO(3)$ によって $S_{\theta}, R_{\theta}$ に標準化されると
き，$\left( \bm{p}_1, \bm{p}_2, \bm{p}_3\right)$は $\mathbb{R}^3$ の右
手系正規直交基底である．このとき，$\mathbb{R}^3$ の直交変
換 $T_A(\bm{x}) = A\bm{x}$ は以下の $3$ つに分けられる．ただし，回転の
向きは $\bm{p}_3$ の方向に進む右ねじの回転方向を正とする．
\begin{itemize}
\item $A \sim S_{\theta}$ のとき，直交変換 $T_A$ は直
  線 $V_A(1)=\langle \bm{p}_3 \rangle$ を軸とする $\theta$ 回転である（
  図\ref{fig:rotation3}）．
  
\item $A \sim R_{0}$ のとき，直交変換 $T_A$ は平面
  $V_A(1)=\langle \bm{p}_1, \bm{p}_2\rangle$ に関する鏡映である（
  図\ref{fig:reflection3}）．

\item $A \sim R_{\theta} \neq R_{0}$ のとき，直交変換 $T_A$ は直
  線 $V_A(-1)=\langle \bm{p}_3\rangle$ を軸とする $\theta$ 回転と平
  面 $V_A(-1)^{\perp}=\langle \bm{p}_1, \bm{p}_2\rangle$ に関する鏡映の合
  成，すなわち，回転鏡映である．
  \begin{figure}[h]
    \centering
    \begin{tabular}{c}
      \begin{minipage}{0.5\linewidth}
        \includegraphics[height=4.3cm]{pictures/rotation3.pdf}
        \caption{$\bm{p}_3$ を軸とする回転角 $\theta$ の回転}\label{fig:rotation3}
      \end{minipage}
      \begin{minipage}{0.5\linewidth}
        \includegraphics[height=4.3cm]{pictures/reflection3.pdf}
        \caption{平面 $\langle \bm{p}_1, \bm{p}_2\rangle$ に関する鏡映}\label{fig:reflection3}      
      \end{minipage}
    \end{tabular}
  \end{figure}


\end{itemize}

また，$3$ 次直交行列の標準形同士は以下の関係式を満たす．特
に，$S_{\theta}= R_{\theta}R_{0}, \; R_0^2=E$ である．
\[
  S_{\theta} S_{\phi} = R_{\theta}R_{\phi}=S_{\theta+\phi}, \quad  
  S_{\theta}R_{\phi} = R_{\phi}S_{\theta} = R_{\theta+\phi}
\]

\newpage

\subsection{空間の合同変換の分類}

空間 $\mathbb{R}^3$ の合同変換
\[
  f(\bm{x}) = A\bm{x} + \bm{b}
\]
は直交行列 $A$ の標準形と$3$ 次列ベクトル $\bm{b}$ によって
表\ref{tab:classification3}のように $7$ 種に分類できる．定
理\ref{thm:generate3}で示すように，$\mathbb{R}^3$ の合同変換は $4$ 個以
下の鏡映の合成として表せる．表\ref{tab:classification3}の4列目はその鏡
映の最小個数を表しており，この分類は $\mathbb{R}^3$ の合同変換をそれを
合成する鏡映の個数と固定点集合の次元によって分類したものと一致してい
る．
\begin{table}[h]
  \centering
  \begin{tabular}[h]{|c|c|c|c|c|}\hline
    名前 & $A$ の標準形 & $\bm{b}$ & 鏡映の個数 & 固定点集合\\ \hline
    恒等変換 & $E$ & $\bm{0}$ & 0 & $\mathbb{R}^3$\\ 
    平行移動 & $E$ & $\bm{b} \neq \bm{0}$ & $2$ & 空集合\\
    回転 & $S_{\theta} (\neq E)$ & $\bm{b} \in V_{A}(1)^{\perp}$  & $2$ & 回転軸\\
    螺旋運動 & $S_{\theta} (\neq E)$ & $\bm{b} \notin V_{A}(1)^{\perp}$ & $4$ &  空集合\\ 
    鏡映 & $R_{0}$ & $\bm{b} \in V_A(-1)$ & $1$ & 鏡映面\\
    滑り鏡映 & $R_{0}$ & $\bm{b} \notin V_A(-1)$ & $3$ & 空集合\\
    回転鏡映 & $R_{\theta} (\neq R_{0})$ & $\bm{b} \in \mathbb{R}^3$ & $3$ &  中心点\\ \hline    
  \end{tabular}
  \caption{空間 $\mathbb{R}^3$ の合同変換の分類表}
  \label{tab:classification3}
\end{table}

ここでは，実際に $\mathbb{R}^3$ の合同変
換 $f$ が表\ref{tab:classification3}のいずれかに分類され，またそれで全
てであることを確かめていこう．恒等変換と平行移動に関しては明らかなので，
以下 $f$ は恒等変換でも平行移動でもない，すなわち，$A \neq E$ とする．


\subsubsection{回転と螺旋運動}\label{sec:RotSpiral3}

$A \sim S_{\theta}$ かつ $A \neq E$ とする．このとき，$f$ は回転か螺旋
運動である．これを詳しく見ていこう．なお，空間における螺旋運動の定義は
以下の通りである．

\begin{definition}
  空間内の直線 $L$ を軸とする角 $\theta$ の回転 $g$ と $L$ に平行なベク
  トル $\bm{c} \in \mathbb{R}^3$ による平行移動との合
  成 $t_{\bm{c}}\circ g$ を $L$ と $\bm{c}$ に関する角 $\theta$ の螺旋
  運動という．螺旋運動は回転（$\bm{c}=\bm{0}$ のとき）を含むのだが，以
  降は回転でないもののみを螺旋運動と呼ぶことにする．
\end{definition}


直交行列 $A$ が直交行列 $P \in SO(3)$ によって標
準化される，すなわち，
\[
  S_{\theta} = P^{-1}AP = {}^{t}P A P, \quad P=\left[
    \begin{array}{ccc}
      \bm{p}_1 & \bm{p}_2 & \bm{p}_3
    \end{array}
  \right] \in SO(3)
\]
とする．$\det P=1$ なので $\left( \bm{p}_1, \bm{p}_2, \bm{p}_3\right)$
は $\mathbb{R}^3$ の右手系正規直交基底であり，
\[
  V_A(1)= \langle \bm{p}_3 \rangle, \quad V_A(1)^{\perp} = \langle \bm{p}_1, \bm{p}_2 \rangle
\]
である．このとき，次が成り立つ．

\begin{theorem}\label{thm:RotOrSpiral3}
  $A，\bm{p}_1, \bm{p}_2, \bm{p}_3$ を先の通りとする．このとき，合同変
  換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は回転か螺旋運動である．特に，各々
  の詳細は次の通りである．
  \begin{enumerate}[(1)]
  \item $\bm{b} \in V_A(1)^{\perp}$ のと
    き：固定点集合 $\Inv(f)$ は $V_A(1)=\langle \bm{p}_3\rangle$ に平行な直線であ
    り，$f$ はこの直線を軸とする回転角 $\theta$ の回転である．
    
  \item $\bm{b} \not\in V_A(1)^{\perp}$ のとき： $f$ は固定点を持な
    い．$f$ は回転 $g(\bm{x}) = A\bm{x} +
    \bm{b}-(\bm{b},\bm{p}_3)\bm{p}_3$ の軸とベクトル
    $(\bm{b}, \bm{p}_3)\bm{p}$ による平行移動に関する角 $\theta$ の螺
    旋運動である．このとき，$g$ の回転軸 $\Inv(g)$ は $V_A(1)=\langle
    \bm{p}_3 \rangle$ に平行である．
  \end{enumerate}
  ただし，いずれも回転の向きは $\bm{p}_3$ の方向に進む右ねじの回転方向
  を正とする．
\end{theorem}

以下，定理\ref{thm:RotOrSpiral3}を証明していこう．

まず，$f$ が固定点を持つかどうかは $\bm{b} \in V_A(1)^{\perp}$ か否かで
分かれる．つまり，次が成り立つ．

\begin{lemma}\label{lem:RotOrSpiral3}
  上の状況において，$\Inv(f)$ は $\bm{b} \in V_A(1)^{\perp}$ のとき，そ
  のときに限り，空集合でない．
\end{lemma}

\begin{proof}
  $\bm{b} \in V_A(1)^{\perp}$ とする．$\mathbb{R}^3$ の線形変
  換 $g(\bm{x}) = \bm{x}-A\bm{x}$ を考える．任意の $\bm{x} \in
  \mathbb{R}^3$ に対して
  \[
    (g(\bm{x}), \bm{p}_3) = (\bm{x}, \bm{p}_3) - (A\bm{x}, \bm{p}_3) =
    (\bm{x}, \bm{p}_3) -(A\bm{x},A\bm{p}_3) =(\bm{x}, \bm{p}_3) -
    (\bm{x},\bm{p}_3) = 0
  \]
  であるから，$g(\mathbb{R}^3) \subset \langle \bm{p}_3
  \rangle^{\perp}=V_A(1)^{\perp}=\langle \bm{p}_1, \bm{p}_2\rangle$
  である．さらに，$\ker g = V_A(1)$ なので線形変換の次元定理より
  \[
    \dim g(\mathbb{R}^3) = \dim \mathbb{R}^3 - \dim \ker g = 3 -1 =2
  \]
  であるから，$g(\mathbb{R}^3) = V_A(1)^{\perp}$ である．よっ
  て，$\bm{b} = g(\bm{c}) = \bm{c} - A\bm{c}$ となる
  $\bm{c} \in \mathbb{R}^3$ が存在する．すなわち，$\bm{c} \in \Inv(f)$
  なので $\Inv(f)$ は空集合でない．

  逆に，$\Inv(f)$ が空集合でないとする．任意の $\bm{x} \in \Inv(f)$ に対し
  て， $\bm{b} = \bm{x} - A\bm{x}$ だから
  \[
    (\bm{b}, \bm{p}_3) = (\bm{x},\bm{p}_3) - (A\bm{x}, \bm{p}_3)
    =(\bm{x}, \bm{p}_3) - (A\bm{x}, A\bm{p}_3)
    =(\bm{x}, \bm{p}_3) - (\bm{x}, \bm{p}_3) = 0
  \]
  である．従って，$\bm{b} \in V_A(1)^{\perp}$ である．
\end{proof}

\begin{proof}[定理\ref{thm:RotOrSpiral3}の証明]

  \begin{enumerate}[(1)]
  \item $\bm{b} \in V_A(1)^{\perp}$ とする．補
    題\ref{lem:RotOrSpiral3}より $\Inv(f)$ は空集合でない．さら
    に，$\dim V_A(1)=1$ なので\ref{sec:inv3}節で見たよう
    に $\Inv(f)$ は $V_A(1)$ と平行な直線である．このとき，任意
    の $\bm{c} \in \Inv(f)$ と任意の $\bm{x} \in \mathbb{R}^3$ に対して
    \[
      f(\bm{x}) - \bm{c} = A(\bm{x}-\bm{c})
    \]
    である．よって，$f$ は $V_A(1)$ に平行な直線 $\Inv(f)$ を軸とする回
    転角 $\theta$ の回転である（図\ref{fig:rotation3gen}）．ただし，回
    転の向きは $\bm{p}_3$ の方向に進む右ねじの回転方向を正とする．また，
    これより
    \[
      f= t_{\bm{c}} \circ T_A \circ t_{-\bm{c}} 
    \]
    とも表せる．すなわち，$\bm{c}$ を通る直線 $L$ を軸とする回転は「一
    旦 $-\bm{c}$ 平行移動し，原点を通り $\Inv(f)$ に平行な直線を軸とし
    て回転させた後に再び $\bm{c}$ 平行移動する変換」とも言い換えるられ
    る．
    \begin{figure}[h]
      \centering
      \includegraphics[height=4.5cm]{pictures/rotation3gen.pdf}
           \caption{直線 $\Inv(f)$ を軸とする角度 $\theta$ の回転}
      \label{fig:rotation3gen}
    \end{figure}

  \item $\bm{b} \notin V_A(1)^{\perp}$ とする．補
    題\ref{lem:RotOrSpiral3}より $f$ は固定点を持たない．このと
    き $\bm{b}$ を
    \[
      \bm{b} = \bm{b}_{12} + \bm{b}_3 , \quad \bm{b}_{12} \in
      V_A(1)^{\perp}=\langle \bm{p}_1, \bm{p}_2 \rangle, \; \bm{b}_{3} \in
      V_A(1)=\langle \bm{p}_3\rangle
    \]
    と分解すると，$\bm{b}_{12} \neq \bm{0}$ である．従って，
    \[
      f(\bm{x}) = \left( A\bm{x} + \bm{b}_{12}\right) + \bm{b}_3
    \]
    より $f$ は合同変換 $g(\bm{x}) = A\bm{x} + \bm{b}_{12}$ と平行移
    動 $t_{\bm{b}_3}$ の合成 $t_{\bm{b}_{3}} \circ g$ である（
    図\ref{fig:spiral3}）．(1)より $g$ は直線 $\Inv(g)$ を軸とす
    る $\theta$ 回転であり，$\bm{b}_3 (\neq \bm{0})$ は $\Inv(g)$ と平
    行だから，$f$ は螺旋運動である．また，$(\bm{p}_1, \bm{p}_2,
    \bm{p}_3)$ は $\mathbb{R}^3$ の正規直交基底だから
    \[
      \bm{b}_{3} = (\bm{b}, \bm{p}_3) \bm{p}_3,\quad \bm{b}_{12} =
      \bm{b}-\bm{b}_{3} = \bm{b} - (\bm{b},\bm{p}_3)\bm{p}_3
    \]
    である．なお，
    \[
      g \circ t_{\bm{b}_3} (\bm{x}) = A(\bm{x} + \bm{b}_3) + \bm{b}_{12} =
      A\bm{x} + \bm{b}_3 + \bm{b}_{12} = f(\bm{x})
    \]
    より $t_{\bm{b}_3} \circ g = g \circ t_{\bm{b}_3} = f$ であるから合
    成の順番はどちらでもよい．
    \begin{figure}[h]
      \centering
      \includegraphics[height=4.5cm]{pictures/spiral3.pdf}
      \caption{$\Inv(g)$ と $\bm{b}_3$ に関する螺旋運動}
      \label{fig:spiral3}
    \end{figure}
  \end{enumerate}
\end{proof}

\subsubsection{鏡映と滑り鏡映}\label{sec:RefGlide3}

$A \sim R_0$ とする．このとき，$f$ は鏡映か滑り鏡映である．これを詳しく
見ていこう．なお，空間における滑り鏡映の定義は以下の通りである．

\begin{definition}
  空間内の平面 $H$ に関する鏡映 $g$ と $H$ に平行なベクトル $\bm{c}
  \in \mathbb{R}^3$ による平行移動との合成 $t_{\bm{c}} \circ
  g$ を $H$と $\bm{c}$ に関する（空間の）滑り鏡映という．この定義に従え
  ば，滑り鏡映は鏡映（$\bm{c}=\bm{0}$ のとき）を含むのだが，鏡映でないもの
  のみを滑り鏡映と呼ぶことにする．
\end{definition}


直交行列 $A$ が直交行列 $P \in SO(3)$ によって $R_{0}$ に標準化される，すなわち，
\[
  R_{0} = P^{-1}AP = {}^{t}PAP, \quad P=\left[
    \begin{array}{ccc}
      \bm{p}_1 & \bm{p}_2 & \bm{p}_3
    \end{array}
  \right] \in SO(3)
\]
とする．$A$ の固有値は $-1$ と $1$ である．$\det P=1$ なの
で $(\bm{p}_1, \bm{p}_2, \bm{p}_3)$ は $\mathbb{R}^3$ の右手系正規直交
基底であり，
\[
  V_A(-1) = \langle \bm{p}_3\rangle, \quad V_A(-1)^{\perp} = V_A(1)
  =\langle \bm{p}_1, \bm{p}_2 \rangle
\]
である．このとき，次が成り立つ．

\begin{theorem}\label{thm:RefOrGlide3}
  $A, \bm{p}_1, \bm{p}_2, \bm{p}_3$ を上の通りとする．このとき，合同変
  換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は鏡映か滑り鏡映である．特に，各々
  の詳細は次の通りである．
  \begin{enumerate}[(1)]
  \item $\bm{b} \in V_A(-1)$ のとき：固定点集
    合 $\Inv(f)$ は $\bm{b}/2$ を通り $V_A(1)$ に平行な平面であり，$f$
    はこの平面に関する鏡映である．

  \item $\bm{b} \not\in V_A(-1)$ のとき：$f$ は固定点を持たない．$f$ は
    鏡映 $g(\bm{x})=A\bm{x} + (\bm{b},\bm{p}_3)\bm{p}_3$ とベクト
    ル $\bm{b}-(\bm{b},\bm{p}_3)\bm{p}_3$ に関する滑り鏡映である．この
    とき，$g$ は $(\bm{b},\bm{p}_3)\bm{p}_3/2$ を通り $V_A(1)$ に平行な
    平面に関する鏡映である．
  \end{enumerate}
\end{theorem}

以下，定理\ref{thm:RefOrGlide3}を証明していこう．

まず，$f$ が固定点を持つかどうかは $\bm{b} \in V_A(-1)$ か否かで分かれ
る．つまり，次が成り立つ．

\begin{lemma}\label{lem:RefOrGlide3}
  上の状況において，$\Inv(f)$ は $\bm{b} \in V_A(-1)$ のとき，そのとき
  に限り，空集合でない．
\end{lemma}

\begin{proof}
  直交変換 $T_A(\bm{x}) = A\bm{x}$ による空間の固有空間分
  解 $\mathbb{R}^3 = V_A(1) \oplus V_A(-1)$ により $\bm{b}$ を
\[
  \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} =  \in V_A(1), \; \bm{b}^{-}  \in V_A(-1)
\]
と分解する．$A^2= PR_0^2P^{-1}=E$ だから，
\[
  \bm{x} \in \Inv(f) \Leftrightarrow A\bm{x} + \bm{b}^{+}+ \bm{b}^{-} = \bm{x} \Leftrightarrow
  \bm{x} + \bm{b}^{+}-\bm{b}^{-}=A\bm{x} \Leftrightarrow
  \bm{b}^{+} = \bm{0}
\]
である．よって，
\[
  \Inv(f) \neq \emptyset \Leftrightarrow \bm{b} \in V_A(-1)
\]
である．
\end{proof}

\begin{proof}[定理\ref{thm:RefOrGlide3}の証明]
  
  \begin{enumerate}[(1)]
  \item $\bm{b} \in V_A(-1)$ とする．補
    題\ref{lem:RefOrGlide3}より $\Inv(f)$は空集合でない．$\dim
    V_A(1)=2$ なので\ref{sec:inv3}節で見たよう
    に $\Inv(f)$ は $V_A(1)$ と平行な平面である．特に，
    \[
      f\left(\frac{\bm{b}}{2}\right) = A\left(\frac{\bm{b}}{2}\right)
      + \bm{b} = -\frac{\bm{b}}{2} + \bm{b} = \frac{\bm{b}}{2}
    \]
    より，$\bm{b}/2 \in \Inv(f)$ だから $\Inv(f)$ は $\bm{b}/2$ を通
    る．$f$ は平面 $\Inv(f)$ に関する鏡映である．実際，任意の $\bm{x}
    \in \mathbb{R}^3$ と任意の $\bm{p} \in V_A(1)$ に対して，
    \begin{align*}
      \left(f(\bm{x})-\bm{x}, \bm{p}\right) &= (A\bm{x}, \bm{p}) + (\bm{b},\bm{p}) - (\bm{x},\bm{p})
      =(A\bm{x}, A\bm{p}) - (\bm{x}, \bm{p}) = (\bm{x}, \bm{p}) - (\bm{x}, \bm{p}) =0,\\
      f\left(\frac{f(\bm{x})+\bm{x}}{2}\right) &= A\left( \frac{A\bm{x}+\bm{b}+\bm{x}}{2}\right)+\bm{b}
      = \frac{\bm{x}-\bm{b}+A\bm{x}}{2} + \bm{b} 
      = \frac{A\bm{x}+\bm{b}+\bm{x}}{2} = \frac{f(\bm{x})+\bm{x}}{2}
    \end{align*}
    であるから，$f(\bm{x})-\bm{x}$ が $V_A(1)$ に，従って $\Inv(f)$ に，
    直交し，$f(\bm{x})$ と $\bm{x}$ の中点が $\Inv(f)$ 上にあるの
    で，$f$ は平面 $\Inv(f)$ に関する鏡映である．



    また，任意の $\bm{c} \in \Inv(f)$ と任意
    の $\bm{x} \in \mathbb{R}^3$ に対し
    \[
      f(\bm{x}) = A(\bm{x}-\bm{c}) + \bm{c}
    \]
    が成り立つから
    \[
      f=t_{\bm{c}} \circ T_A \circ t_{-\bm{c}}
    \]
    である．すなわち，$\bm{c}$ を通り平面 $V_A(1)$ に平行な平面に関する鏡映
    は「一旦 $-\bm{c}$ 平行移動し，$V_A(1)$ に関する鏡映移動をした後に再
    び $\bm{c}$ 平行移動する変換」と言い換えることもできる．

  \item $\bm{b} \notin V_A(-1)$ とする．空間 $\mathbb{R}^3$ の固有分
    解 $\mathbb{R}^3 = V_A(1) \oplus V_A(-1)$ により $\bm{b}$ を
    \[
      \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} \in V_A(1),
      \; \bm{b}^{-} \in V_A(-1)
    \]
    と分解する．このとき，$\bm{b}^{+} \neq \bm{0}$ である．
    \[
      f(\bm{x}) = \left(A\bm{x} + \bm{b}^{-}\right) + \bm{b}^{+}
    \]
    であるから，$g(\bm{x}) = A\bm{x} + \bm{b}^{-}$
    とおくと，$f = t_{\bm{b}^{+}} \circ g$ であ
    る．(1)より $g$ は $\bm{b}^{-}$ を通り $V_A(1)$ に平行な平
    面 $\Inv(g)$ に関する鏡映である．さらに，$\bm{b}^{+} \in V_A(1)$ で
    あるから $\bm{b}^{+}$ は $\Inv(g)$ に平行である．よって，$f$ は滑り
    鏡映である．また，$(\bm{p}_1, \bm{p}_2,
    \bm{p}_3)$ は $\mathbb{R}^3$ の正規直交基底だから
    \[
      \bm{b}^{-} = (\bm{b}, \bm{p}_3)\bm{p}_3, \quad
      \bm{b}^{+}=\bm{b}-\bm{b}^{-}=\bm{b}-(\bm{b},\bm{p}_3)\bm{p}_3
    \]
    である．なお，鏡映と平行移動を合成する順番はどちらでもよい．実
    際，$A\bm{b}^{+}=\bm{b}^{+}$ より
    \[
      g\left(t_{\bm{b}^{+}}(\bm{x})\right) = A\left(\bm{x}+\bm{b}^{+}\right)+\bm{b}^{-}
      = \left(A\bm{x}+\bm{b}^{-}\right) + \bm{b}^{+} = t_{\bm{b}^{+}}\left( g(\bm{x})\right)
    \]
    であるから $g\circ t_{\bm{b}^{+}} = t_{\bm{b}^{+}}\circ g=f$ である．
  \end{enumerate}
\end{proof}


\subsubsection{回転鏡映}

$A \sim R_{\theta} \neq R_0$ とする．このとき $f$ は回転鏡映である．こ
れを詳しく見ていこう．

直交行列 $A$ が直交行列 $P \in SO(3)$ によって $R_{\theta}$ に標準化される，すなわち，
\[
  R_{\theta}=P^{-1}AP = {}^{t}PAP, \quad P=\left[
    \begin{array}{ccc}
      \bm{p}_1 & \bm{p}_2 & \bm{p}_3
    \end{array}
  \right] \in SO(3)
\]
とする．$\det P=1$ なので $(\bm{p}_1, \bm{p}_2,
\bm{p}_3)$ は $\mathbb{R}^3$ の右手系正規直交基底であり，
\[
  V_A(-1) = \langle \bm{p}_3\rangle, \quad V_A(-1)^{\perp}=\langle
  \bm{p}_1, \bm{p}_2\rangle
\]
である．このとき，次が成り立つ．

\begin{theorem}\label{thm:rotref3}
  $A, P, \bm{p}_1, \bm{p}_2, \bm{p}_3$ を上の通りとする．このとき，合同
  変換 $f(\bm{x}) = A\bm{x}+\bm{b}$ は回転鏡映である．特に，固定点
  は $1$ 点 $\bm{c}:=(E-A)^{-1}\bm{b}$ のみであり，$f$ は $V_A(-1)$ に
  平行で $\bm{c}$ を通る直線に関する $\theta$ 回転 $g$ と $\bm{c}$ を通
  り $V_A(-1)^{\perp}$ に平行な平面に関する鏡映 $h$ の合成 $g \circ h$
  に等しい．ただし，回転の向きは $\bm{p}_3$ の向きに進む右ねじの回転方
  向を正とする．
\end{theorem}

\begin{remark}
  この定理は幾何学的には明らかだが，ここでは（線形）代数的にきっちり証明して
  いこう．  
\end{remark}

\begin{proof}
$R_{\theta}=S_{\theta}R_{0}$ であるから，$B=PS_{\theta}P^{-1}, \; C=PR_{0}P^{-1}$ とおくと
\[
  BC = \left(PS_{\theta}P^{-1}\right)\left(PR_{0}P^{-1}\right) = P
  \left( S_{\theta}R_{0}\right)P^{-1} = P R_{\theta} P^{-1}=A
\]
である．$\mathbb{R}^3$ の直交分解 $\mathbb{R}^3 = V_B(1) \oplus
V_B(1)^{\perp}$ によって $\bm{b}$ を
\[
  \bm{b}=\bm{b}_{1} + \bm{b}_{2}, \quad \bm{b}_{1} \in
  V_B(1), \; \bm{b}_2 \in V_B(1)^{\perp}
\]
と分解する．$B \bm{b}_1 = \bm{b}_1$
だから，$g(\bm{x}) = B\bm{x} + \bm{b}_{2}, \; h(x) = C\bm{x}+\bm{b}_1$
とおくと
\[
  f(\bm{x}) = A\bm{x} + \bm{b} = BC\bm{x}+\bm{b}_{1}+\bm{b}_{2} =
  B\left(C\bm{x}+\bm{b}_{1}\right) + \bm{b}_{2} = g(h(\bm{x}))
\]
より，$f= g \circ h$ である．$B, C$ はいずれも $P$ によってそれ
ぞれ $S_{\theta}, \; R_0$ に標準化されるので
\[
  V_A(-1) = \langle \bm{p}_3 \rangle = V_B(1)=V_C(-1), \quad
  V_A(-1)^{\perp} = \langle \bm{p}_1, \bm{p}_2\rangle = V_B(1)^{\perp}
  = V_C(-1)^{\perp}=V_C(1)
\]
である．これより $g(\bm{x})=B\bm{x}+\bm{b}_2$ が回転
で，$h(\bm{x})=C\bm{x}+\bm{b}_1$ が鏡映であることを示せばよい．


まず，$B \sim S_{\theta} \neq E$ かつ $\bm{b}_{2} \in V_B(1)^{\perp}$
だから，定理\ref{thm:RotOrSpiral3}より $\Inv(g)$ は $V_B(1)=V_A(-1)$ に
平行な直線で，$g$ はこの直線に関する $\theta$ 回転である．ただし，回転
の向きは $\bm{p}_3$ の向きに進む右ねじの回転方向を正とする．

次に，$C \sim R_0$ かつ $\bm{b}_1 \in V_B(1)=V_C(-1)$ だから，定
理\ref{thm:RefOrGlide3}より $\Inv(h)$ は $V_C(1)=V_A(-1)^{\perp}$ に平
行な平面で，$h$ はこの平面に関する鏡映である．

最後に，$A$ は $1$ を固有値に持たないので\ref{sec:inv3}節で見たよう
に $f$ の固定点は $\bm{c}:=(E-A)^{-1}\bm{b}$ のみであるが，これ
は $\Inv(g)$ と $\Inv(h)$ の交点である．実際，空間 $\mathbb{R}^3$ の中
で直線 $\Inv(g)$ と平面 $\Inv(h)$ は直交するので $1$ 点で交わるが，その
交点は $g, h$ の固定点なので $f$ の固定点でもあり，従って，$\bm{c}$ に
等しい．よって，$\Inv(g)$ も $\Inv(h)$ も $\bm{c}$ を通る．
\end{proof}


\subsection{鏡映の個数}

空間の合同変換それぞれに対し，それを合成する鏡映を全て調べ上げ，分類
表\ref{tab:classification3}を完成させよう．

\begin{theorem}\label{thm:generate3}
  空間 $\mathbb{R}^3$ の合同変換は $4$ 個以
  下の鏡映の合成として表せる．特に，各合同変換に対してそれを合成
  する鏡映の最小個数は表\ref{tab:classification3}にある通りである．
\end{theorem}

定理の証明の前に，合同変換の合成と固定点集合に関する補題を与えておく．

\begin{lemma}\label{lem:inv-comp3}
  空間 $\mathbb{R}^3$ の任意の合同変換 $f_1,
  f_2$に対し，$ \Inv(f_1) \cap \Inv(f_2) \subset \Inv(f_1 \circ f_2)$
  が成り立つ．特に，$\Inv(f_1 \circ f_2)$ が空集合なら $\Inv(f_1) \cap
  \Inv(f_2)$ は空集合である．
\end{lemma}

\begin{proof}
  任意の $\bm{c} \in \Inv(f_1) \cap \Inv(f_2)$ に対して，以下が成り立つので $\bm{c} \in \Inv(f_1 \circ f_2)$ である．
  \[
    f_1 \circ f_2(\bm{c}) = f_1\left( f_2(\bm{c})\right) = f_1(\bm{c}) = \bm{c}
  \]
  よって，$\Inv(f_1) \cap \Inv(f_2) \subset \Inv(f_1 \circ f_2)$ である．
  後半の主張は明らかである．
\end{proof}


\begin{proof}[定理\ref{thm:generate3}の証明]
  恒等変換は $0$ 個，鏡映は $1$ 個の鏡映の合成であり，またそれ以外の合
  同変換が $1$ 個以下の鏡映の合成として表せないことは明らかである．残り
  の平行移動，回転，滑り鏡映，回転鏡映，螺旋運動に関しては以下に続く4つの補
  題\ref{lem:translation3}から\ref{lem:spiral3}により証明が完成す
  る．
\end{proof}


\begin{lemma}\label{lem:translation3}
  \begin{enumerate}[(1)]
  \item 空間 $\mathbb{R}^3$ の平行移動
    $t_{\bm{b}} \; (\bm{b} \neq \bm{0})$は鏡映面が平行な2個の鏡映の合成
    である．このとき，2つの鏡映面は共に $\bm{b}$ に直交し，その距離
    は $\|\bm{b}\|/2$ である．

\item 逆に，空間 $\mathbb{R}^3$ の平行な $2$ 平面 $H_1, H_2 \; (H_1
  \neq H_2)$ に関する鏡映$r_1, r_2$ の合成 $r_2 \circ r_1$は平行移動で
  ある．移動方向は $H_1$ から $H_2$ の方へ両平面に直交する方向で，移動
  距離は $2$ 平面の距離の $2$ 倍である．
  \end{enumerate}
\end{lemma}



\begin{proof}
  (1)原点 $\bm{0}$ と $t_{\bm{b}}(\bm{0})=\bm{b}$ の垂直二等分面 $H$ に
  関する鏡映を $g$ とする．$g(\bm{0})=\bm{b}$ だから，$g$ は
  $A \sim R_0, \; \bm{b} \in V_A(-1)$ を満たす $3$ 次直交行列 $A$ によっ
  て $g(\bm{x}) = A\bm{x} + \bm{b}$ と書ける．このとき，
  \[
    g\left( t_{\bm{b}}(\bm{x})\right) = A(\bm{x}+\bm{b})+\bm{b} =
    A\bm{x} + A\bm{b} + \bm{b} = A\bm{x} -\bm{b} +\bm{b}=A\bm{x} = T_A(\bm{x})
  \]
  より $g\circ t_{\bm{b}} = T_A$ である．$A \sim R_0$ だから直交変
  換 $T_A$ は平面 $H_0:=V_A(1)$ に関する鏡映である．さらに，$g\circ g =
  \id_{\mathbb{R}^3}$ より
  \[
    t_{\bm{b}}= \left( g \circ g\right) \circ t_{\bm{b}} = g\circ \left( g \circ t_{\bm{b}}\right) = g \circ T_A
  \]
  だから平行移動 $t_{\bm{b}}$ は $2$ 個の鏡映 $g$ と $T_A$ の合成である．
  また，$g$ の鏡映面 $H$ は $T_A$ の鏡映面 $H_0$ に平行であり，
  図\ref{fig:translation3}のように $H, H_0$ はそれぞれ $\bm{b}/2,
  \bm{0}$ を通り $\bm{b}$ に直交する平面なので，$2$ 平面間の距離
  は $\|\bm{b}\|/2$ である．
  % (1) 平行移動 $t_{\bm{b}} \; (\bm{b} \neq \bm{0})$ が $2$ 個の鏡映の合成で
  % あることを示す．
  % \[
  %   H_0:=\Set{ \bm{x} \in \mathbb{R}^3 | (\bm{b}, \bm{x})=0}
  % \]
  % とする．$H_0$ は原点 $\bm{0}$ を通り $\bm{b}$ に直交する平面であるか
  % ら，線形空間 $\mathbb{R}^3$ の $2$ 次元部分空間である．$(\bm{p}_1,
  % \bm{p}_2)$ を $H_0$ の正規直交基底とし，$\bm{p}_3 =
  % \bm{b}/\|\bm{b}\|$ とすると，$(\bm{p}_1, \bm{p}_2,
  % \bm{p}_3)$ は $\mathbb{R}^3$ の正規直交基底であるから，$P:=\left[
  %   \begin{array}{ccc}
  %     \bm{p}_1 & \bm{p}_2 & \bm{p}_3
  %   \end{array}
  % \right] \in O(3)$ である．$\det P =-1$ なら $\bm{p}_1$ と $\bm{b}_2$
  % を入れ替えて $P \in SO(3)$ とし，$A=P R_0 P^{-1}$ とする．$A \sim
  % R_0$ より直交変換 $T_A(\bm{x}) = A\bm{x}$ は平面
  % $V_A(1) = \langle \bm{p}_1, \bm{p}_2 \rangle = H_0$ に関する鏡映であ
  % る．$\bm{b} \in \langle \bm{p}_3 \rangle = V_A(-1)$ より，定
  % 理\ref{thm:RefOrGlide3}から合同変
  % 換 $g(\bm{x})=A\bm{x}+\bm{b}$ は $\bm{b}/2$ を通り $V_A(1)$ に平行な
  % 平面 $H:=\Inv(g)$ に関する鏡映である．よって，
  % \[
  %   t_{\bm{b}}(\bm{x}) = \bm{x} + \bm{b} = A\left( A\bm{x} \right) +
  %   \bm{b} = g\left( T_A(\bm{x})\right)
  % \]
  % より $t_{\bm{b}} = g \circ T_A$ である．すなわち，平行移
  % 動 $t_{\bm{b}}$ は平行な $2$ 平面 $H_0, H$ に関する $2$ 個の鏡映の合
  % 成である．このとき，$2$ 平面 $H_0, H$ の距離は原点 $\bm{0}$ と $H$ の
  % 距離 $\|\bm{b}\|/2$ に等しい（図\ref{fig:translation3}）．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4.5cm]{pictures/translation3.pdf}
    \caption{平行移動は平行な2平面に関する $2$ 個の鏡映の合成である．}
    \label{fig:translation3}
  \end{figure}

  \noindent
  (2) 逆に，平行な $2$ 平面 $H_1, H_2 \; (H_1 \neq H_2)$ に関する鏡
  映 $r_1, r_2$ に対して，その合成 $r_2 \circ r_1$ が平行移動であること
  を示す．$r_1(\bm{x})=A_1\bm{x}+\bm{b}_1, \; r_2(\bm{x}) =
  A_2\bm{x}+\bm{b}_2$ とすると，
  \[
    A_1 \sim R_0 \sim A_2, \quad \bm{b}_1 \in V_{A_1}(-1), \; \bm{b}_2 \in V_{A_2}(-1)
  \]
  である．$H_1$ と $H_2$ が平行なので $V_{A_1}(1) = V_{A_2}(1)$ であ
  る．$(\bm{p}_1, \bm{p}_2)$ を $V_{A_1}(1)$ の正規直交基底と
  し，$(\bm{p}_3)$ を
  $V_{A_1}(-1)=V_{A_1}(1)^{\perp} = V_{A_2}(1)^{\perp}=V_{A_2}(-1)$ の
  正規直交基底とする．必要なら $\bm{p}_1$ と $\bm{p}_2$ を入れ替えて，$P:=\left[
    \begin{array}{ccc}
      \bm{p}_1 & \bm{p}_2 & \bm{p}_3
    \end{array}
  \right] \in SO(3)$ とすると，$P^{-1}A_1 P = R_0 = P^{-1}A_2 P$ より $A_1=PR_0P^{-1}=A_2$
  である．従って，$A=A_1= A_2$ とおくと，$A^2= E, \; \bm{b}_1 \in V_{A}(-1)$ より
  \[
    r_2 \left( r_1 (\bm{x})\right) = A\left( A \bm{x}+\bm{b}_1\right) + \bm{b}_2
    = \bm{x} + A \bm{b}_1 + \bm{b}_2 = \bm{x} + \bm{b}_2 - \bm{b}_1
  \]
  だから $r_2 \circ r_1 = t_{\bm{b}_2-\bm{b}_1}$ である．すなわ
  ち，$r_2 \circ r_1$ は平行移動である．なお，$r_1 \neq r_2$ だか
  ら $\bm{b}_1 \neq \bm{b}_2$ より $t_{\bm{b}_2-\bm{b}_1}$ は恒等変換で
  はない．このとき，$\bm{b}_1, \bm{b}_2 \in V_{A}(-1)^{\perp}$ だか
  ら，$\bm{b}_2-\bm{b}_1$の向きは $H_1$ から $H_2$ の方へ両平面に直交す
  る方向である．さらに，図\ref{fig:translation3gen}のように $H_1, H_2$
  はそれぞれ $\bm{b}_1/2, \; \bm{b}_2/2$ を通り $V_{A}(1)$ に平行な平面
  だから，その距離は $\|\bm{b}_2-\bm{b}_1\|/2$ である．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4.5cm]{pictures/translation3gen.pdf}
    \caption{平行な $2$ 平面に関する $2$ 個の鏡映の合成は平行移動である．}
    \label{fig:translation3gen}
  \end{figure}
\end{proof}

\begin{lemma}\label{lem:rotation3}
  \begin{enumerate}[(1)]
  \item 空間 $\mathbb{R}^3$ の $\theta$ 回転 $f$ は鏡映面が平行でな
    い $2$ 個の鏡映の合成である．このとき，$2$ つの鏡映面の交線が $f$
    の回転軸であり，2つの鏡映面のなす角は $\theta/2$ である．
    
  \item 逆に，平行でない $2$ 平面 $H_1, H_2$ に
  関する鏡映を $g_1, g_2$ とすると，合成 $g_2 \circ g_1$ は $2$ 平面の
  交線を軸とする回転であり，回転方向は $H_1$ から $H_2$ へ，回転角
  は $2$ 平面の交わる角の $2$ 倍である．
  \end{enumerate}
\end{lemma}

\begin{proof}
  (1) 任意に $\bm{c} \in \Inv(f)$ をとる．$f$ は $A \sim S_{\theta}$ と
  なる直交行列 $A \in SO(3)$ によって
  \[
    f(\bm{x}) = A(\bm{x} - \bm{c}) + \bm{c}
  \]
  と書ける．$f$ の回転軸 $\Inv(f)$ は直線 $V_A(1)$ に平行である．そこ
  で，$f$ の回転の正の方向に回転する右ねじの進む方向の単位ベクトル
  を $\bm{p}_3$ とすと，$\bm{p}_3 \in V_A(1)$
  である．$\bm{p}_1, \bm{p}_2 \in V_A(1)^{\perp}$ を
  $(\bm{p}_1, \bm{p}_2, \bm{p}_3)$ が空間 $\mathbb{R}^3$ の右手系正規直
  交基底となるように選ぶ．このとき，
  \[
     S_{\theta} = {}^{t}PAP, \quad P := \left[
      \begin{array}{ccc}
        \bm{p}_1 & \bm{p}_2 & \bm{p}_3
      \end{array}
    \right]\in SO(3)
  \]
  である．$g_2$ を $\bm{c}+\bm{p}_1$ と $f(\bm{c}+\bm{p}_1)$ の垂直二等
  分面 $H_2$ に関する鏡映とし，$g_1 = g_2 \circ f$
  とする．$\Inv(f) \subset H_2 = \Inv(g_2)$ だから補
  題\ref{lem:inv-comp3}より
  \[
    \Inv(f) = \Inv(g_2) \cap \Inv(f) \subset \Inv(g_2 \circ f) = \Inv(g_1)
  \]
  である．さらに，$\bm{p}_1$ は $\Inv(f)$ に直交し，
  \[
    g_1 (\bm{c}+\bm{p}_1) = g_2 \left( f(\bm{c}+\bm{p}_1)\right) = \bm{c}+\bm{p}_1
  \]
  より $\bm{c}+\bm{p}_1 \in \Inv(g_1)$ であるか
  ら，$\Inv(g_1)$ は $\Inv(f)$ を含み $\bm{p}_1$ に平行な平面，すなわ
  ち，$\bm{c}$ を通り $\bm{p}_2$ に直交する平面 $H_1$ を含む．一方，
  図\ref{fig:cutplane3}から
  \[
    g_1(\bm{c} + \bm{p}_2) = g_2 \left( f(\bm{c}+\bm{p}_2) \right) = c-\bm{p}_2 \neq c+\bm{p}_2
  \]より $c+\bm{p}_2 \notin \Inv(g_1)$ である．従って，
  $\Inv(g_1) \neq \mathbb{R}^3$ であるから \ref{sec:inv3}節で見たよう
  に $\Inv(g_1)$ は平面 $H_1$ である．分類表\ref{tab:classification3}か
  ら，固定点集合が平面となるのは鏡映であるから $g_1$ は鏡映である．よって，
  \[
    f = (g_2 \circ g_2) \circ f = g_2 \circ (g_2 \circ f) = g_2 \circ g_1
  \]
  より，$f$ は $2$ 個の鏡映 $g_1, g_2$ の合成である．また，空
  間 $\mathbb{R}^3$ の中で$2$ 平面 $H_1, H_2$ が共に直線 $\Inv(f)$ を含
  むので，$H_1 \cap H_2 = \Inv(f)$ である．すなわち，$2$ 平面の交線
  が $f$ の回転軸である．さらに，図\ref{fig:cutplane3}のように $H_1,
  H_2$ のなす角は $\theta/2$ である．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4.5cm]{pictures/cutplane3.pdf}
    \caption{$g_1(\bm{c}+\bm{p}_2) = g_2\left( f(\bm{c}+\bm{p}_2)\right) = \bm{c}-\bm{p}_2$}\label{fig:cutplane3}
  \end{figure}

 
  
  % 以上の準備のもとで実
  % 際に証明に入る前に，証明の幾何学的な背景を説明しておこう．幾何学的
  % な感覚が十分に備わっているなら以下の枠内は読み飛ばしてもよい．
  
  % \begin{screen}
  %   　$f=g_2 \circ g_2$ となる空間の鏡映 $g_1, g_2$ を見つけるために，
  %   そのような $g_1, g_2$ がどのようなものでなければならないかを考え
  %   よう．

  %   　2つの鏡映面 $H_1:=\Inv(g_1)$ と $H_2:=\Inv(g_2)$ が平行なときは補
  %   題\ref{lem:translation3}から $g_2 \circ g_1$ は平行移動になってしま
  %   うので，$H_1, H_2$ は平行ではない．空間の中で平行でない $2$ 平面は
  %   必ず交わり，その交点全体 $H_1 \cap H_2$ は直線をなす．今 $f=g_2
  %   \circ g_1$ であって欲しいが，$\Inv(f)$ は直線なので補
  %   題\ref{lem:inv-comp3}から $H_1 \cap H_2 \subset \Inv(g_2 \circ
  %   g_1)$ より $H_1 \cap H_2 =\Inv(f)$ となる，すなわち，$2$ 平面の交線
  %   が回転の軸になるはずである．

  %   　$2$ つの鏡映面のなす角を考えよう．下図のように，$f$ の回転
  %   軸 $\Inv(f)$ に $\bm{c} \in \Inv(f)$ で直交する平面 $H_0$ 上で $f$
  %   を見ると，$f$ は $c$ を中心とした平面 $H_0$ 上での $\theta$ 回転で
  %   ある．これは，平面 $H_0$ 上では直線 $H_1 \cap H_0$ に関する鏡映と直
  %   線 $H_2 \cap H_0$ に関する鏡映の合成である．従って，定
  %   理\ref{thm:generate2}で見たように $2$ 直線 $H_1 \cap H_0$ と $H_2
  %   \cap H_0$ のなす角は $\theta /2$ である．$2$ つの鏡映面 $H_1, H_2$
  %   は共に $H_0$ に直交するので，結局 $H_1, H_2$ のなす
  %   角は $\theta/2$ に等しいはずである．
  %   \begin{center}
  %     \includegraphics[height=5cm]{pictures/cut_rotation3.pdf}
  %   \end{center}
  % \end{screen}
  
  % \begin{screen}
  %   　実際に $g_1, g_2$ を具体的に書き下そう．定
  %   理\ref{thm:RefOrGlide3}から，任意の $\bm{c} \in H_1 \cap
  %   H_2$ に対して
  %   \[
  %     g_1(\bm{x}) = B_1(\bm{x}-\bm{c}) + \bm{c}, \quad g_2(\bm{x}) = B_2 (\bm{x}-\bm{c})+\bm{c}
  %     \quad (B_1 \sim R_0 \sim B_2)
  %   \]
  %   と書ける．そして
  %   \[
  %     g_2(g_1(\bm{x})) = B_2 (B_1(\bm{x}-\bm{c})+\bm{c}-\bm{c})+\bm{c}= B_2 B_1(\bm{x}-\bm{c}) + \bm{c}
  %   \]
  %   である．これが $f(\bm{x})$ に等しくあって欲しいのだが，$\bm{c}
  %   \in \Inv(f)$ でもあるので，$f(\bm{x})$ は
  %   \[
  %     f(\bm{x})=A(\bm{x}-\bm{c})+\bm{c}
  %   \]
  %   とも書ける．従って，$f=g_2\circ g_1$ であるためには $A=B_2B_1$ となればよいことが分かる．
    
  %   　直交行列 $B_1, B_2$ は共に $R_0$
  %   に標準化されるので，${}^{t}Q_1 B_1 Q_1 = {}^{t}Q_2 B_2 Q_2 = R_0$
  %   となる $Q_1, Q_2 \in SO(3)$ を見つけよう．まず，$Q_1 = \left[
  %       \begin{array}{ccc}
  %         \bm{q}_1 & \bm{q}_2 & \bm{q}_3
  %       \end{array}
  %     \right]$ とおいてみよう．このとき，
  %     \[
  %       V_{B_1}(1) = \langle \bm{q}_1, \bm{q}_2\rangle, \quad V_{B_1}(-1)=\langle \bm{q}_3\rangle
  %     \]
  %     である．$g_1$ の鏡映面 $H_1$ は $\bm{c}$ を通り $V_{B_1}(1)$ に平
  %     行な平面であり，これが $\bm{c}$ を通り $\bm{p}_3$ に平行な直
  %     線 $\Inv(f)$ を含むので，$\bm{p}_3 \in V_{B_1}(1)$ である．$H_1$
  %     と $H_2$ のなす角は $\theta/2$ であって欲しいが，このような $2$
  %     平面の選び方は無数にある．そこで，枠外の図\ref{fig:rotation3ref}の
  %     ように $H_1$ が $\bm{p}_2$ に直交するものを選ぼう．すなわち，
  %     \[
  %       V_{B_1}(1) = \langle \bm{p}_1, \bm{p}_3\rangle, \quad V_{B_1}(-1) = \langle \bm{p}_2\rangle
  %     \]
  %     としよう．さらに，$Q_1 \in SO(3)$ であって欲しいので，
  %     \[
  %       Q_1 =\left[
  %         \begin{array}{ccc}
  %           \bm{p}_3 & \bm{p}_1 & \bm{p}_2
  %         \end{array}
  %       \right]
  %     \]
  %     とすれば，${}^{t}Q_1 B_1Q_1 = R_0$ となるはずである．そし
  %     て，$H_2$ は $\Inv(f)$ を軸として $H_1$ を $\theta/2$ 回転させた
  %     平面のはずなので，$V_{B_2}(1), V_{B_2}(-1)$ はそれぞ
  %     れ $V_{B_1}(1), V_{B_1}(-1)$ を $\bm{p}_3$ を軸として $\theta/2$
  %     回転させた平面と直線である．$C=PS_{\theta/2}{}^{t}P$ とする
  %     と，$\mathbb{R}^3$ の直交変換 $T_C(\bm{x}) =
  %     C\bm{x}$ は $\bm{p}_3$ を軸とする $\theta/2$ 回転であるから，
  %     \[
  %       V_{B_2}(1) = \langle T_C(\bm{p}_3), T_C(\bm{p}_1) \rangle,
  %       \quad V_{B_2}(-1) = \langle T_C(\bm{p}_2) \rangle
  %     \]
  %     である．$C \in SO(3)$ だから
  %     \[
  %       Q_2 = \left[
  %         \begin{array}{ccc}
  %           T_C(\bm{p}_3) & T_C(\bm{p}_1) & T_C(\bm{p}_2)
  %         \end{array}
  %       \right]
  %     \]
  %     とすれば $Q_2 \in SO(3)$ で，${}^{t}Q_2 B_2 Q_2 = R_0$ となるはずである．

  %     　以上の幾何学的考察から，$B_1 = Q_1 R_0 {}^{t} Q_1$ と
  %     $B_2=Q_2 R_0 {}^{t}Q_2$ が $B_2 B_1=A$ を満たすはずであるから，あ
  %     とはこれを実際に計算によって確認すればよい．
  %   \end{screen}



  % $C=PS_{\theta/2}{}^{t}P$ とおく．直交変
  % 換 $T_C(\bm{x})=C\bm{x}$ は $\bm{p}_3$ を回転軸とする $\theta/2$ 回
  % 転である．
  % \[
  %   Q_1 = \left[
  %     \begin{array}{ccc}
  %       \bm{p}_3 & \bm{p}_1 & \bm{p}_2
  %     \end{array}
  %   \right], \quad 
  %   Q_2 =\left[
  %     \begin{array}{ccc}
  %       T_C(\bm{p}_3) & T_C(\bm{p}_1) & T_C(\bm{p}_2)
  %     \end{array}
  %   \right]
  % \]
  % とし，$B_1 = Q_1 R_0 {}^{t}Q_1, \; B_2=Q_2 R_0 {}^{t}Q_2$ とす
  % る．任意に $\bm{c} \in \Inv(f)$ をと
  % り
  % \[
  %   g_1(\bm{x}) = B_1(x-\bm{c})+\bm{c}, \quad g_2(\bm{x})=B_2(\bm{x}-\bm{c})+\bm{c}
  % \]
  % とすると，$Q_1, Q_2 \in SO(3)$ なので，$B_1 \sim R_0 \sim
  % B_1$ より $g_1, g_2$ はそれぞれ平面 $H_1:=\Inv(g_1)$ と平面 $
  % H_2:=\Inv(g_2)$ に関する鏡映である．ここで，$P$ は直交行列だから
  % \begin{align*}
  %   Q_1 &=PT, \quad T:= \left[
  %   \begin{array}{ccc}
  %     0 & 1 & 0\\
  %     0 & 0 & 1\\
  %     1 & 0 & 0
  %   \end{array}
  %             \right],\\
  %   Q_2 &= \left[
  %         \begin{array}{ccc}
  %           C\bm{p}_3 & C\bm{p}_1 & C\bm{p}_2
  %         \end{array}
  %                                  \right] =  CQ_1 = CPT = PS_{\theta/2}{}^{t}PPT = PS_{\theta/2}T
  % \end{align*}
  % と書ける．これと $R_0, P, T \in O(3)$ から
  % \begin{align*}
  %   B_2 B_1 &= Q_2 R_0 {}^{t}Q_2 Q_1 R_0 {}^{t}Q_1
  %             =PS_{\theta/2}TR_0\ {}^{t}\left(PS_{\theta/2}T\right)PT R_0\ {}^{t}\left(PT\right)\\
  %           &=PS_{\theta/2}\left(TR_0 {}^{t}T\right) {}^{t}S_{\theta/2} 
  %             \left({}^{t}P P\right)\left(TR_0 {}^{t}T\right){}^{t}P
  %             =PS_{\theta/2}\left(TR_0{}^{t}T\right)\left({}^{t}S_{\theta/2}TR_0{}^{t}T\right){}^{t}P\\
  %           &=P S_{\theta/2}\left(TR_0{}^{t}T\right) \ {}^{t}\left( T \ {}^{t}R_0 {}^{t} T S_{\theta/2}\right) {}^{t}P 
  %             = PS_{\theta/2}{}^{t}\left( \left({}^{t}S_{\theta/2} T R_0 {}^{t} T\right) 
  %             \left( T \ {}^{t}R_0 {}^{t}T\right)\right) {}^{t}P\\
  %           &=PS_{\theta/2}  S_{\theta/2}\ {}^{t}P = P S_{\theta} {}^{t}P = A
  % \end{align*}
  %   である．従って，
  % \[
  %   g_2 \left( g_1(\bm{x})\right) = B_2\left( B_1(\bm{x}-\bm{c}) + \bm{c} - \bm{c}\right) + \bm{c}
  %   = B_2 B_1 (\bm{x}-\bm{c})+\bm{c} = A(\bm{x}-\bm{c}) + \bm{c} = f(\bm{x})
  % \]
  % より，$f=g_2 \circ g_1$ である．また，鏡映面 $H_1$ は $\bm{c}$ を通
  % り $V_{B_1}(1)$ に平行な平面であり，$H_2$ は $\bm{c}$ を通
  % り $V_{B_2}(1)$ を通る平面である．
  % \[
  %   T_C(\bm{p}_3) = C \bm{p}_3 = PS_{\theta/2}{}^{t}P \bm{p}_3 = PS_{\theta/2}\left(\left[
  %     \begin{array}{c}
  %       {}^{t}\bm{p}_1\\
  %       {}^{t}\bm{p}_2\\
  %       {}^{t}\bm{p}_3
  %     \end{array}
  %   \right] \bm{p}_3 \right)= P\left(S_{\theta/2} \bm{e}_3\right) = P
  % \bm{e}_3 = \bm{p}_3
  % \]
  % なので，$Q_1, Q_2$ の定義から
  % \[
  %   V_{B_1}(1) = \langle \bm{p}_3, \bm{p}_1\rangle, \quad V_{B_2}(1) =
  %   \langle T_C(\bm{p}_3), T_C(\bm{p}_1)\rangle = \langle \bm{p}_3, T_C(\bm{p}_1)\rangle
  % \]
  % より，$H_1, H_2$ は $\bm{c}$ を通り $\bm{p}_3$ に平行な直線，すなわ
  % ち，$\Inv(f)$ を含む．空間の中で平面と平面の交わりは直線なの
  % で，$\Inv(f) = H_1 \cap H_2$ である．よって，
  % 図\ref{fig:rotation3ref}のように $H_1$ を直線 $\Inv(f)$ を軸とし
  % て $\theta/2$ 回転させた平面が $H_2$ である．つまり，$H_1$ と $H_2$
  % のなす角は $\theta/2$ である．

  \noindent
  (2) 逆に，平行でない任意の $2$ 平面 $H_1, H_2$ に関する鏡映 $g_1,
  g_2$ に対して，その合成 $g_2 \circ g_1$ が回転であることを示す．(1)で
  定義した記号は一旦全てリセットする．(1)では $A$ から $B_1, B_2$ を構
  成したが，今度は逆に $B_1, B_2$ から $A$ を構成していく．

  $2$ 平面 $H_1, H_2$ の交線を $L$ とする．すなわち，$L=H_1 \cap H_2$
  である．任意に $\bm{c} \in L$ をとる．$g_1, g_2$ はそれぞれ $H_1,
  H_2$ に関する鏡映なので，$B_1 \sim R_0 \sim B_2$ となる $B_1 , B_2
  \in O(3)$ によって
  \[
    g_1(\bm{x}) = B_1 (\bm{x}-\bm{c})+\bm{c}, \quad g_2(\bm{x}) =
    B_2(\bm{x}-\bm{c})+\bm{c}
  \]
  と書ける．$2$ 平面 $H_1, H_2$ の交わる角を $\theta/2$ とする．すなわ
  ち，交わる角の $2$ 倍を $\theta$ とする．
  \[
    g_2 ( g_1(\bm{x})) = B_2\left(B_1(\bm{x}-\bm{c})+\bm{c} - \bm{c}\right) + \bm{c} 
    = B_2 B_1(\bm{x}-\bm{c})+\bm{c}
  \]
  であるから，$A:=B_2 B_1 \sim S_{\theta}$ となることを示せばよい．

  
  直線 $L$ の単位方向ベクトルを $\bm{p}_3$ とする．すなわ
  ち，$\|\bm{p}_3\|=1$
  かつ$L=\Set{\bm{c} + t \bm{p}_3 | t \in \mathbb{R}}$ である．ただ
  し，$\bm{p}_3$ の向きは $H_1$ から $H_2$ の方向へ回転する右ねじの進む
  方向と同じとする．図\ref{fig:rotation3ref}のよう
  に $\bm{p}_2$ を $H_1$ に直交する単位ベクトルとし，$(\bm{p}_3,
  \bm{p}_1, \bm{p}_2)$ が $\mathbb{R}^3$ の右手系正規直交基底となるよう
  に $\bm{p}_1 \in V_{B_1}(1)$ をとる．具体的には $\mathbb{R}^3$ の外積
  を用いて $\bm{p}_1 = \bm{p}_2 \times \bm{p}_3$ とすればよい．
  \begin{figure}[h]
    \centering
    \includegraphics[height=4.5cm]{pictures/rotation3ref.pdf}
    \caption{平行でない $2$ 平面に関する $2$ 個の鏡映の合成は回転である．}
    \label{fig:rotation3ref}
  \end{figure}

  \noindent
  $H_1$ は $V_{B_1}(1)$
  に平行だから，$V_{B_1}(1) = \langle \bm{p}_3, \bm{p}_1\rangle, \;
  V_{B_1}(-1) = V_{B_1}(1)^{\perp}= \langle \bm{p}_2\rangle$ より
  \[
    {}^{t} Q_1 B_1 Q_1 = R_0, \quad Q_1:=\left[
      \begin{array}{ccc}
        \bm{p}_3 & \bm{p}_1 & \bm{p}_2
      \end{array}
    \right] \in SO(3)
  \]
  である．また，$(\bm{p}_1, \bm{p}_2, \bm{p}_3)$ は $\mathbb{R}^3$ の右
  手系正規直交基底なので
  \[
    P=\left[
      \begin{array}{ccc}
        \bm{p}_1 & \bm{p}_2 & \bm{p}_3
      \end{array}
    \right] , \quad C=P S_{\theta/2} {}^{t}P
  \]
  とすると，$P \in SO(3)$ であり，直交変換 $T_C(\bm{x}) =
  C\bm{x}$ は $\bm{p}_3$ を軸とする $\theta/2$ 回転である．ただし，回転
  の方向は $\bm{p}_3$ の向きに進む右ねじの回転方向，すなわち，$H_1$ か
  ら $H_2$ への方向である．平面 $H_1, H_2$ はそれぞれ $V_{B_1}(1),
  V_{B_2}(1)$ に平行で，$H_2$ は $L$ を軸に $H_1$ を $\theta/2$ 回転さ
  せた平面なので，$V_{B_2}(1) = \langle T_C(\bm{p}_3),
  T_C(\bm{p}_1)\rangle, \; V_{B_2}(-1)=V_{B_2}(1)^{\perp}=\langle
  T_C(\bm{p}_2)\rangle$ である．これより
  \[
    {}^{t}Q_2 B_2 Q_2 = R_0, \quad Q_2 :=\left[
      \begin{array}{ccc}
        T_C(\bm{p}_3) & T_C(\bm{p}_1) & T_C(\bm{p}_2)
      \end{array}
    \right] \in SO(3)
  \]
  である．ここで，$P$ は直交行列だから
  \begin{align*}
    Q_1 &=PT, \quad T:= \left[
    \begin{array}{ccc}
      0 & 1 & 0\\
      0 & 0 & 1\\
      1 & 0 & 0
    \end{array}
              \right],\\
    Q_2 &= \left[
          \begin{array}{ccc}
            C\bm{p}_3 & C\bm{p}_1 & C\bm{p}_2
          \end{array}
                                   \right] =  CQ_1 = CPT = PS_{\theta/2}{}^{t}PPT = PS_{\theta/2}T
  \end{align*}
  と書ける．これと $R_0, P, T \in O(3)$ から
  \begin{align*}
    B_2 B_1 &= Q_2 R_0 {}^{t}Q_2 Q_1 R_0 {}^{t}Q_1
              =PS_{\theta/2}TR_0\ {}^{t}\left(PS_{\theta/2}T\right)PT R_0\ {}^{t}\left(PT\right)\\
            &=PS_{\theta/2}\left(TR_0 {}^{t}T\right) {}^{t}S_{\theta/2} 
              \left({}^{t}P P\right)\left(TR_0 {}^{t}T\right){}^{t}P\\
            & =PS_{\theta/2}\left(TR_0{}^{t}T\right)\left({}^{t}S_{\theta/2}TR_0{}^{t}T\right){}^{t}P\\
            &=P S_{\theta/2}\left(TR_0{}^{t}T\right) \ {}^{t}\left( T \ {}^{t}R_0 {}^{t} T S_{\theta/2}\right) {}^{t}P \\
            &= PS_{\theta/2}{}^{t}\left( \left({}^{t}S_{\theta/2} T R_0 {}^{t} T\right) 
              \left( T \ {}^{t}R_0 {}^{t}T\right)\right) {}^{t}P\\
            &=PS_{\theta/2}  S_{\theta/2}\ {}^{t}P = P S_{\theta} {}^{t}P = A
  \end{align*}
    である．従って，
  \[
    g_2 \left( g_1(\bm{x})\right) = B_2\left( B_1(\bm{x}-\bm{c}) + \bm{c} - \bm{c}\right) + \bm{c}
    = B_2 B_1 (\bm{x}-\bm{c})+\bm{c} = A(\bm{x}-\bm{c}) + \bm{c} = f(\bm{x})
  \]
  より，$f=g_2 \circ g_1$ である．よって，$g_2 \circ
  g_1$ は $H_1$ と $H_2$ の交線 $L$ を軸とする $\theta$ 回転であり，回
  転方向は $T_C$ と同じ，すなわち，$H_1$ から $H_2$ への方向である．
 \end{proof}


 \begin{lemma}\label{lem:glide3}
   空間 $\mathbb{R}^3$ の滑り鏡映は $3$ 平面に関する$3$ 個の鏡映の
   合成として表すことができる．このとき，$3$ 平面の内 $2$ つは互いに平
   行で，共に残りの $1$ つと直交するものを選べる．また，$\mathbb{R}^3$
   の滑り鏡映を $2$ 個以下の鏡映の合成として表すことはできない．
 \end{lemma}

 \begin{proof}
   $f$ を空間 $\mathbb{R}^3$
   の滑り鏡映とする．$f(\bm{x}) = A\bm{x} + \bm{b} \; \left(A \sim
     R_0, \; \bm{b} \notin V_A(-1)\right)$ と書ける．
   \[
     \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} \in V_A(1),
     \quad \bm{b}^{-} \in V_A(-1), \quad \bm{b}^{+} \neq \bm{0}
   \]
   とし，$r(\bm{x}) = A\bm{x} + \bm{b}^{-}$ とす
   る．$r$ は $\bm{b}^{-}/2$ を通り $\bm{b}^{-}$ に直交する平面 $H$ に
   関する鏡映である．
   \[
     f(\bm{x}) = \left(A\bm{x}+\bm{b}^{-}\right) + \bm{b}^{+} =
     t_{\bm{b}^{+}} \left( r(\bm{x})\right)
   \]
   より，$f=t_{\bm{b}^{+}} \circ r$ である．補
   題\ref{lem:translation3}より平行移
   動 $t_{\bm{b}^+}$ は $\bm{b}^{+}$ に直交する $2$ 平面 $H_1, H_2$
   に関する鏡映 $r_1, r_2$ の合成として $t_{\bm{b}^{+}} = r_2 \circ
   r_1$ と表せるので，
   \[
     f = t_{\bm{b}^{+}} \circ r = r_2 \circ r_1 \circ r
   \]
   より $f$ は $3$ 個の鏡映の合成として表せる．このとき，$H_1, H_2$ は
   いずれも $\bm{b}^{+}$ に直交するので，互いに平行で，共に $H$ に直交
   する．
   
   また，補
   題\ref{lem:translation3}(2)補題\ref{lem:rotation3}(2)から $2$ 個の鏡
   映の合成は恒等変換か平行移動か回転なので，滑り鏡映を $2$ 個以下の鏡
   映の合成として表すことはできない．
 \end{proof}

\begin{lemma}\label{lem:rotref3}
  空間 $\mathbb{R}^3$ の回転鏡映は $1$ 点で交わる $3$ 平面に関する $3$
  個の鏡映の合成として表すことができる．また，$\mathbb{R}^3$ の回転鏡映
  を $2$ 個以下の鏡映の合成として表すことはできない．
\end{lemma}

\begin{proof}
  $f$ を空間 $\mathbb{R}^3$
  の回転鏡映とする．$f(\bm{x}) = A\bm{x} + \bm{b} \; \left( A \sim
    R_{\theta} \neq R_0 \right)$ と書ける．直交行列 $A$ が $P \in
  SO(3)$ によって $R_{\theta} = P^{-1} A P$ と標準化される とする．定
  理\ref{thm:rotref3}の証明と同様に，
  \begin{align*}
    &B=PS_{\theta}P^{-1}, \quad C=PR_{0}P^{-1}, \quad 
    \bm{b} = \bm{b}_1 + \bm{b}_2, \quad \bm{b}_1 \in V_A(-1), \; \bm{b}_2 \in V_A(-1)^{\perp}\\
    &g(\bm{x})=B\bm{x} + \bm{b}_2, \quad h(\bm{x})=C\bm{x}+\bm{b}_1
  \end{align*}
  とすると $f = g \circ h$ である．このとき，$g$ は $f$ の固定
  点 $\bm{c}$ を通り $V_A(-1)$ に平行な直線 $\Inv(g)$ を軸とす
  る $\theta$ 回転で，$h$ は $\bm{c}$ を通り $V_A(-1)^{\perp}$ に平行な
  平面 $H:=\Inv(h)$ に関する鏡映である．補題\ref{lem:rotation3}より回
  転 $g$ は $\Inv(g)$ を交線とする平面 $H_1, H_2$ に関する鏡映 $r_1,
  r_2$ により $g=r_2 \circ r_1$ と書ける．よって，
  \[
    f = g \circ h = r_2 \circ r_1 \circ h
  \]
  より $f$ は $3$ 個の鏡映の合成として表せる．また，補
  題\ref{lem:inv-comp3}から $H_1 \cap H_2 \cap H = \Inv(f)=\{\bm{c}\}$
  より $3$ つの鏡映面は $1$ 点 $\bm{c}$ で交わる．
  
  また，補
  題\ref{lem:translation3}(2)補題\ref{lem:rotation3}(2)から $2$ 個の鏡
  映の合成は恒等変換か平行移動か回転なので，回転鏡映を $2$ 個以下の鏡映
  の合成として表すことはできない．
\end{proof}

\begin{lemma}\label{lem:spiral3}
  空間 $\mathbb{R}^3$ の螺旋運動は $4$ 個の鏡映の合成として表せる．ま
  た，$\mathbb{R}^3$ の螺旋運動を $3$ 個以下の鏡映の合成として表すこと
  はできない．
\end{lemma}

\begin{proof}
  螺旋運動は平行移動と回転の合成である．補題\ref{lem:translation3}と補
  題\ref{lem:rotation3}より平行移動と回転はそれぞれ $2$ 個の鏡映の合成
  として表せるので，螺旋運動は $4$ 個の鏡映の合成として表せる．

  また，補題\ref{lem:translation3}と補題\ref{lem:rotation3}から螺旋運動
  を $2$ 個以下の鏡映の合成として表すことはできない．最後に，螺旋運動
  が $3$ 個の鏡映の合成として表すことができないことを示す．$r_1, r_2,
  r_3$ を空間 $\mathbb{R}^3$ の鏡映とし，
  \[
    r_1(\bm{x}) = A_1 \bm{x} + \bm{b}_1, \quad r_2(\bm{x}) = A_2 \bm{x} + \bm{b}_2, \quad
    r_3(\bm{x}) = A_3 \bm{x} + \bm{b}_3
  \]
  とする．各 $i=1,2,3$ に対して $A_i \sim R_0, \; \bm{b}_i \in V_{A_i}(-1)$ である．
  \[
    r_1 \left( r_2 \left( r_3 \left( \bm{x}\right) \right) \right)
    = A_1 \left( A_2 \left( A_3 \bm{x}+\bm{b}_3\right) + \bm{b}_2\right) + \bm{b}_1
    = \left(A_1 A_2 A_3 \right)\bm{x} + \left(A_1 A_2 \bm{b}_3 + A_1 \bm{b}_2 + \bm{b}_1\right)
  \]
  である．ここで，$\det A_1 = \det A_2 = \det A_3=-1$ であるか
  ら，$\det \left(A_1 A_2 A_3 \right)=-1$
  である，従って，$A_1 A_2 A_3 \notin SO(3)$ なので分類
  表\ref{tab:classification3}から $r_1 \circ r_2 \circ r_3$ は螺旋運動
  ではない．すなわち，螺旋運動を $3$ 個の鏡映の合成として表すことはでき
  ない．よって，螺旋運動を $3$ 個以下の鏡映の合成として表すことはできな
  い．
\end{proof}

以上から，定理\ref{thm:generate3}の証明が完成する．

\newpage

\subsection{空間の合同変換と $4$ 次正方行列}

空間 $\mathbb{R}^3$ の合同変換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は $4$ 次
正方行列と $4$ 次列ベクトルの積を用いて
\begin{align*}
  \left[
  \begin{array}{c}
    f(\bm{x})\\
    1
  \end{array}
  \right] = \left[
  \begin{array}{cc}
    A & \bm{b}\\
    \bm{0} & 1
  \end{array}
             \right] \left[
             \begin{array}{c}
               \bm{x}\\
               1
             \end{array}
  \right]
\end{align*}
と表すことができる．さらに，合同変換
$f_1(\bm{x})=A_1 \bm{x} + \bm{b}_1, \, f_2(\bm{x}) = A_2\bm{x} +
\bm{b}_2$ の合成
\[
  f_1\circ f_2(\bm{x}) =  f_1\left( f_2\left( \bm{x}\right) \right) 
  = A_1\left( A_2 \bm{x}+\bm{b}_2\right)+\bm{b}_1 = A_1 A_2 \bm{x} + \bm{b}_1+A_1\bm{b}_2
\]
は $4$ 次正方行列同士の積として
\begin{align*}
  \left[
  \begin{array}{cc}
    A_1 & \bm{b}_1\\
    \bm{0} & 1
  \end{array}
             \right] \left[
             \begin{array}{cc}
               A_2 & \bm{b}_2\\
               \bm{0} & 1
             \end{array}
                        \right] = \left[
                        \begin{array}{cc}
                          A_1 A_2 & \bm{b}_1+A_1\bm{b}_2\\
                          \bm{0} & 1
                        \end{array}
                                   \right]
\end{align*}
と表せる．これにより空間 $\mathbb{R}^3$ の合同変換を $4$ 次正方行列の演算で記述できる．

例えば，$2$ つの合同変換
\[
  f_1(\bm{x}) = \left[
    \begin{array}{rrr}
      0 & -1 & 0\\
      1 & 0 & 0\\
      0 & 0 & 1
    \end{array}
  \right] \bm{x} + \left[
    \begin{array}{r}
      1\\
      2\\
      3
    \end{array}
  \right], \qquad f_2(\bm{x}) = \left[
    \begin{array}{rrr}
      0 & -1 & 0\\
      1 & 0 & 0\\
      0 & 0 & -1
    \end{array}
  \right] \bm{x} + \left[
    \begin{array}{r}
      -1\\
      1\\
      1
    \end{array}
  \right]
\]
の合成 $f_1 \circ f_2$ は
\begin{align*}
  f_1( f_2(\bm{x})) &= \left[
    \begin{array}{rrr}
      0 & -1 &0\\
      1 & 0 & 0\\
      0 & 0 & 1
    \end{array}
  \right] \left( \left[
      \begin{array}{rrr}
        0 & -1 & 0\\
        1 & 0 & 0\\
        0 & 0 & -1
      \end{array}
    \right] \bm{x} + \left[
      \begin{array}{r}
        -1\\
        1\\
        1
      \end{array}
    \right] \right) + \left[
    \begin{array}{r}
      1\\
      2\\
      3
    \end{array}
  \right]\\
                    &= \left[
                      \begin{array}{rrr}
                        -1 & 0 & 0\\
                        0 & -1 & 0\\
                        0 & 0 & -1
                      \end{array}
                            \right] \bm{x} + \left[
                            \begin{array}{r}
                              0\\
                              1\\
                              4
                            \end{array}
  \right]
\end{align*}
であるが，これが $4$ 次正方行列同士の積として
\[
  \left[
    \begin{array}{rrr|r}
      0 & -1 & 0 & 1\\
      1 & 0 & 0 & 2\\
      0 & 0 & 1 & 3\\ \hline
      0 & 0 & 0 & 1
    \end{array}
  \right] \left[
    \begin{array}{rrr|r}
      0 & -1 & 0 & -1\\
      1 & 0 & 0 & 1\\ 
      0 & 0 & -1 & 1\\ \hline
      0 & 0 & 0 & 1
    \end{array}
  \right] = \left[
    \begin{array}{rrr|r}
      -1 & 0 & 0 & 0\\
      0 & -1 & 0 & 1\\ 
      0 & 0 & -1 & 4\\ \hline
      0 & 0 & 0 & 1
    \end{array}
  \right]
\]
と計算できる．この右辺の $4$ 次正方行列の左上部分と右上部分が，それぞれ
合成 $f_1(f_2(\bm{x}))=A\bm{x} + \bm{b}$ の直交行列 $A$ と空間ベクト
ル $\bm{b}$ である．このように全てを行列演算にしてしまうことで計算機で
合同変換が扱いやすくなる．なお，これは空間のアフィン変換や $3$ 次元射影
空間上の射影変換を $4$ 次正方行列によって表現する手法の特殊な場合でもあ
る．


\newpage

\subsection*{演習問題\ref{sec:3dim}}

\begin{enumerate}
  \setlength{\itemsep}{1zh}

\item 次の空間の合同変換を $f(\bm{x}) = A\bm{x} + \bm{b}$ の形に書き下そう．

  \begin{enumerate}[(1)]
  \item 平面 $ax+by+cz=d$ に関する鏡映．

  \item 原点 O と点 P$(1,1,1)$ を通る直線を軸とする $\theta$ 回転．た
    だし回転の向きは $\overrightarrow{\textrm{OP}}$ の方向に進む右ねじの回転方向
    を正とする．
  \end{enumerate}

\item 次の空間の合同変換が分類表\ref{tab:classification3}のどれに当ては
  まるか判定しよう．また，回転軸，回転角，回転方向，鏡映面，平行移動ベ
  クトルなどの情報も決定しよう．

  \vspace{1zh}

  \begin{enumerate}[(1)]
    \setlength{\itemsep}{1zh}
    
  \item $\ds f_1(\bm{x}) = \frac{1}{3} \left[
      \begin{array}{rrr}
        1 & -2 & -2\\
        -2 & 1 & -2\\
        -2 & -2 & 1
      \end{array}
    \right] \bm{x} + \left[
      \begin{array}{r}
        2\\
        2\\
        2
      \end{array}
    \right]$
    
  \item $\ds f_2(\bm{x}) = \frac{1}{3}\left[
      \begin{array}{rrr}
        2 & -1 & 2\\
        2 & 2 & -1\\
        -1 & 2 & 2
      \end{array}
    \right] \bm{x} + \left[
      \begin{array}{r}
        -1\\
        1\\
        0
      \end{array}
    \right]$

  \item $\ds f_3(\bm{x}) = \frac{1}{27}\left[
      \begin{array}{rrr}
        14 & 23 & 2\\
        -22 & 14 & -7\\
        -7 & 2 & 26
      \end{array}
    \right] \bm{x} + \left[
      \begin{array}{r}
        1\\
        2\\
        3
      \end{array}
    \right]$

  \item $f_4=f_3 \circ f_2$

  \item $f_5=f_1 \circ f_2 \circ f_1$
  \end{enumerate}

\item $H_1, H_2, H_3$ を空間 $\mathbb{R}^3$ 内の平面とし，それぞれに関
  する鏡映を $r_1, r_2 , r_3$ とする．次の状況で合成 $r_1 \circ r_2
  \circ r_3$ がどんな合同変換か判定しよう．

  \vspace{.5zh}

  \begin{enumerate}[(1)]
  \item $H_1 = H_3 \neq H_2$ で $H_1$ と $H_2$ が交わる．

  \item $H_1, H_3$ が平行で，$H_1$ と $H_2$ が交わる．

  \item $H_1, H_2$ が平行で，$H_1$ と $H_3$ が交わる．

  \item $H_1, H_2, H_3$ が $1$ 点で交わる．
  \end{enumerate}
  
\item 適当なプログラミング環境のもとで，$3$ 次直交行列 $A$ と $3$ 次列
  ベクトル $\bm{b}$ が与えられたときに空間の合同変換
  \[
    f(\bm{x}) = A\bm{x} + \bm{b}
  \]
  が表\ref{tab:classification3}のどれに当てはまるか判定するプログラムを
  作成しよう．また，回転軸，回転角，回転方向，鏡映面，平行移動ベクトル
  などの情報も出力しよう．

\item 空間の合同変換 $f_1, f_2$ の合成 $f_1 \circ f_2$ を分類しよう．
\end{enumerate}

\newpage

\section{ 直線 $\mathbb{R}$ の合同変換}\label{sec:1dim}

平面や空間ほど面白みはないが，直線 $\mathbb{R}$ の合同変換についてもま
とめておく．$\mathbb{R}$ の合同変換
\[
  f(x) = a x + b
\]
は以下の表\ref{tab:classification1}のように $3$ 種に分類できることを確
かめていこう．なお，恒等変換と平行移動は分類上異なるクラスとして扱う．
\begin{table}[h]
  \centering
  \begin{tabular}[h]{|c|c|c|c|c|}\hline
    名前 & $A$ & $b$ & 鏡映の個数 & 固定点集合\\ \hline
    恒等変換 & $1$ & $0$ & $0$ & $\mathbb{R}$\\ 
    平行移動 & $1$ & $b \neq 0$ & $2$ & 空集合\\
    鏡映 & $-1$ & $b \in \mathbb{R}$ & $1$ & $\Set{b/2}$ \\ \hline
  \end{tabular}
  \caption{直線 $\mathbb{R}$ の合同変換}
  \label{tab:classification1}
\end{table}

まず，明らかに $a=\pm 1$ である．

$a=1$のとき， $b=0$ なら $f$ は恒等変換
で $\Inv(f)=\mathbb{R}$ であり，$b\neq 0$ なら$f$ は平行移動
で $\Inv(f)$ は空集合である．

$a=-1$ のとき，$\Inv(f) = \Set{x \in \mathbb{R} | -x+b=x} = \Set{b/2}$
である．このとき，任意の $x \in \mathbb{R}$ に対して $f(x)-b/2 =
-(x-b/2)$ であるから $f$ は $b/2$ に関する鏡映である．

恒等変換と鏡映がそれぞれ $0, 1$ 個の鏡映の合成であることは明らかで，平
行移動 $f(x) = x+b \; (b \neq 0)$ は $2$ 個の鏡映$g_1(x) = -x, \;
g_2(x)=-x+b$ の合成として $f=g_2 \circ g_1$ と表せる．以上か
ら $\mathbb{R}$ の合同変換は $2$ 個以下の鏡映の合成として表せることが分
かり，表\ref{tab:classification1}が完成する．

\subsection*{演習問題\ref{sec:1dim}}

\begin{enumerate}
 % \setlength{\itemsep}{1zh}


\item $a, b \in \mathbb{R}$ とする．
  \begin{enumerate}[(1)]

  \item $2$ 次正方行列 $F=\left[
      \begin{array}{cc}
        a & b\\
        0 & 1
      \end{array}
    \right]$ と自然数 $k$ に対し，$F^k$ を求めよう．

  \item $\mathbb{R}$ 上の $1$ 次関数 $f(x) = ax+b$ に対し，その $k$ 回合
  成 $f^k$ を $x \mapsto \alpha x + \beta$ の形に表そう．

\item 初項が $b$ で公比が $a \neq 1$ の等比数列に関する以下の和の公式を
  証明しよう．
  \[
    \sum_{k=0}^{m-1} \ b a^{k} = \frac{b \left( 1-a^m\right)}{1-a}
  \]
  \end{enumerate}

\item $\mathbb{R}$ の合同変換 $f_1, f_2$ の合成 $f_1
  \circ f_2$ を分類しよう．

\end{enumerate}


\newpage

\section{$\mathbb{R}^n$ の合同変換}\label{sec:gendim}

一般次元ユークリッド空間 $\mathbb{R}^n$ の合同変換についても考えておこ
う．引き続き，列ベクトルと点を同一視し，$\mathbb{R}^n$ の元は適宜ベクト
ルと見なしたり点と見なしたりする．

\subsection{$\mathbb{R}^n$ の直交変換群}\label{sec:orthogonal}

$n$ 次直交行列全体
\[
  O(n):=\Set{ A \in GL(n,\mathbb{R}) | {}^{t}A A = E}
\]
を $n$ 次直交群という．名前の通りこれは群である．また，
\[
  SO(n):=\Set{A \in O(n) | \det A=1}
\]
を $n$ 次特殊直交群という．直交行列の行列式は $\pm 1$ なので
\[
  \det : O(n) \to \Set{\pm 1} \ ; \ A \mapsto \det A
\]
は全射群準同型である．明らかに $\ker (\det) = SO(n)$ なの
で，$SO(n)$ は $O(n)$ の正規部分群である．従って，群準同型定理から
\[
  O(n)/SO(n) \simeq \Set{\pm 1} \simeq \mathbb{Z}/2\mathbb{Z}
\]
である．特に，$R_0:=\diag(1,\ldots, 1, -1) \in O(n) \setminus
SO(n)$ に対して，$R_0^2 =E$ より
\[
  O(n) = SO(n) \rtimes \Set{E, R_0} \simeq SO(n) \rtimes \mathbb{Z}/2\mathbb{Z}
\]
である．なお，上式では直交行列とそれに対応する直交変換を同一視している．

\subsection{$\mathbb{R}^n$ の合同変換群}

\begin{definition}
  $\mathbb{R}^n$ の合同変換全体は写像の合成により群をなす．この群
  を $\mathbb{R}^n$ の合同変換群といい，$\Isom(\mathbb{R}^n)$ で表す．
\end{definition}

\begin{definition}
  $\mathbb{R}^n$ の平行移動全体
  \[
    \mathbb{T}(n)=\Set{ t_{\bm{b}} | \bm{b} \in \mathbb{R}^n}
  \]
  は $\Isom(\mathbb{R}^n)$ の部分群をなす．明らかに $\mathbb{T}(n)$ は加
  法群 $\mathbb{R}^n$ に群として同型である．
\end{definition}


定理\ref{thm:affine_rep}から写像
\[
  \varphi : \Isom(\mathbb{R}^n) \to O(n) \ ; \ f \mapsto t_{-f(\bm{0})} \circ f
\]
は全射群準同型である．明らかに $\ker \varphi = \mathbb{T}(n)$ なの
で，$\mathbb{T}(n)$ は $\Isom(\mathbb{R})^n$ の正規部分群である．従って，
群準同型定理から
\[
  \Isom(\mathbb{R}^n)/\mathbb{T}(n) \simeq O(n)
\]
である．これより合同変換群の以下のように半直積表示に分解できる．
\[
  \Isom(\mathbb{R}^n) = \mathbb{T}(n) \rtimes O(n) \simeq \mathbb{R}^n \rtimes O(n)
\]

\subsection{直交行列の標準形}

今節では，$S_{\theta}:=\left[
    \begin{array}{rr}
      \cos \theta & -\sin \theta\\
      \sin \theta & \cos \theta
    \end{array}
  \right]$ とし，直交行列の標準化に関する以下の定理を証明する．

  \begin{theorem}\label{thm:stdform}
    任意の $n$ 次直交行列 $A$ は，ある $P \in SO(n)$ によって 
    \begin{equation}\label{eq:std}
      {}^{t}PAP = \left[
        \begin{array}{cccccc}
          S_{\theta_1} & & & & & O\\
                       & \ddots & & & & \\
                       & & S_{\theta_s} & & &\\
                       & & & \pm 1 & &\\
                       & & & & \ddots &\\
          O & & & & & \pm 1
        \end{array}
      \right]
    \end{equation}
    と標準化される．ここで，$e^{\i \theta_1}, \ldots,
    e^{\i\theta_s}$ は $A$ の固有値である．$A$ が実固有値を持たなければ右
    下の $\pm 1$ たちは現れず，$A$ が実固有値のみを持つなら左上
    の $S_{\theta_j}$ たちは現れない．
  \end{theorem}

  ここから，一旦話を実内積空間 $\mathbb{R}^n$ からエルミート空
  間 $\mathbb{C}^n$ に広げるが，最終的にはまた実内積空
  間 $\mathbb{R}^n$ に戻ってくる．$\mathbb{C}^n$ を複素数成分の $n$ 次
  列ベクトルのなす複素線形空間とし，$\bm{x}, \bm{y} \in \mathbb{C}^n$
  に対してエルミート内積を $(\bm{x}, \bm{y}) = {}^{t} \bar{\bm{y}}
  \bm{x}$ によって定める．ここで，$\bar{\bm{y}}$ は $\bm{y}$ の複素共役
  を表す．

  まずは，直交行列の固有値と固有ベクトルに関して次が成り立つ．
  
\begin{theorem}\label{thm:eigenvalue}
  直交行列の固有値の絶対値は $1$ である．特に実固有値は $\pm 1$ のみで
  ある．
\end{theorem}

\begin{proof}
  $A \in O(n)$ とする．$\lambda \in \mathbb{C}$ を $A$ の固有
  値，$\bm{x} \in \mathbb{C}^n$ をその固有ベクトルとする．つま
  り，$A\bm{x} = \lambda \bm{x}$ かつ $\bm{x} \neq \bm{0}$ であ
  る．$(\bm{x}, \bm{x}) \neq 0$ なので，
  \[
    (\bm{x}, \bm{x}) = (A\bm{x}, A\bm{x}) = (\lambda \bm{x}, \lambda
    \bm{x}) = \lambda \bar{\lambda} (\bm{x}, \bm{x}) = |\lambda|^2
    (\bm{x}, \bm{x})
  \]
  から $|\lambda|=1$ である．特に $\lambda \in \mathbb{R}$なら
  ば $\lambda= \pm 1$ である．
\end{proof}

\begin{theorem}\label{thm:eigen-conj}
  $\lambda \in \mathbb{C}$ が直交行列 $A$ の固有値で $\bm{x}$ がその固
  有ベクトルなら，$\bar{\lambda}$ は $A$ の固有値
  で $\bar{\bm{x}}$ は $\bar{\lambda}$ の固有ベクトルである．特に，$A$
  の実数でない固有値の個数は偶数である．
\end{theorem}

\begin{proof}
  $A\bm{x} = \lambda \bm{x}$ かつ $\bm{x} \neq \bm{0}$ なので，$\bar{\bm{x}} \neq \bm{0}$ であり，
  \[
    A \bar{\bm{x}} = \bar{A}\bar{\bm{x}} = \bar{A\bm{x}} = \bar{\lambda \bm{x}} = \bar{\lambda} \bar{\bm{x}}
  \]
  より，$\bar{\lambda}$ は $A$ の固有値で，$\bar{\bm{x}}$ はその固有ベクトルである．後半の主張は明らかである．
\end{proof}

\begin{theorem}\label{thm:eigen-perp}
  直交行列の異なる固有値に属する固有ベクトル同士は直交する．
\end{theorem}

\begin{proof}
  $A \in O(n)$ とする．$\lambda, \mu \in \mathbb{C}$ を $A$ の相異なる
  固有値，$\bm{x}, \bm{y} \in \mathbb{C}^n$ をそれぞれの固有ベクトルと
  する．$(\bm{x}, \bm{y})=0$
  であることを示す．定理\ref{thm:eigenvalue}から $\bar{\mu}\mu= |\mu|^2=1$ なので
  \[
    \lambda(\bm{x}, \bm{y}) = (\lambda \bm{x}, \bar{\mu}\mu \bm{y}) = \mu (A\bm{x}, \mu \bm{y})
    = \mu(A\bm{x}, A\bm{y}) = \mu (\bm{x}, \bm{y})
  \]
  より，$(\lambda - \mu)(\bm{x}, \bm{y})=0$ である．$\lambda \neq \mu$ なので，これより $(\bm{x}, \bm{y})=0$ である．
\end{proof}

定理\ref{thm:eigenvalue}と\ref{thm:eigen-conj}から，直交行列の固有値は全て$e^{\pm \i \theta} \;
(\theta \in \mathbb{R})$ の形に表せる．また，直交行列は実ユニタリ行列で
あり，ユニタリ行列は正規行列の一種である．その正規行列はユニタリ行列に
よって対角化可能なので，複素数の範囲での直交行列の標準形は対角行
列
\begin{equation}\label{eq:diag}
\left[
  \begin{array}{cccccccc}
    e^{\i\theta_1} & & & & & & & O\\
                           & e^{-\i\theta_1} & & & & & &\\
                           & & \ddots & & & & &\\
                           & & & e^{\i\theta_s} & & & &\\
                           & & & & e^{-\i\theta_s} & & &\\
                           & & & & & \pm 1 & &\\
                           & & & & & & \ddots & \\
    O & & & & & & & \pm 1
  \end{array}
\right]
\end{equation}
である．よく知られた事実ではあるが，ユニタリ行列の場合（従って，直
交行列の場合も含む）に限定してこれを証明しておく．

以下，行列 $X$ の随伴行列を $X^*$ で表す．つまり，$X^* := {}^{t}\bar{X}$ とする．

\begin{theorem}\label{thm:diag-by-unitary}
  ユニタリ行列はユニタリ行列によって対角化可能である． 従って，直交行列も
  ユニタリ行列によって対角化可能である．
\end{theorem}

\begin{proof}
  $A$ を $n$ 次ユニタリ行列とし，$n$ に関する帰納法で示す．$n=1$ のとき
  は明らかなので，$n \geq 2$ とする．$\lambda$ を $A$ の固有
  値，$\bm{u}_1 \in \mathbb{C}^n$ をその単位固有ベクトルと
  し，$(\bm{u}_2, \ldots, \bm{u}_n)$
  を $\langle \bm{u}_1 \rangle ^{\perp}$ の正規直交基底とする
  と，$U_1=\left[
    \begin{array}{ccc}
      \bm{u}_1 & \cdots & \bm{u}_n
    \end{array}
  \right]$ はユニタリ行列である．$j=2, \ldots, n$ に対して
  \[
    (\bm{u}_1, A \bm{u}_j) = \lambda^{-1} (\lambda \bm{u}_1,
    A\bm{u}_j) = \lambda^{-1} (A\bm{u}_1, A\bm{u}_j) =
    \lambda^{-1}(\bm{u}_1, \bm{u}_j) =0
  \]
  なので，
  \[
    \begin{aligned}
      U_1^*A U_1 &= U_1^*\left[
        \begin{array}{ccc}
          A \bm{u}_1 & \cdots & A\bm{u}_n
        \end{array}
      \right] = U_1^* \left[
        \begin{array}{cccc}
          \lambda \bm{u}_1 & A \bm{u}_2 & \cdots & A\bm{u}_n
        \end{array}
      \right]\\
      &= \left[
        \begin{array}{cccc}
          \lambda {}^{t}\bar{\bm{u}_1}\bm{u}_1 & {}^{t}\bar{\bm{u}_1} A \bm{u}_2 & \cdots & {}^{t}\bar{\bm{u}_1} A \bm{u}_n\\
          \lambda {}^{t}\bar{\bm{u}_2} \bm{u}_1 & {}^{t} \bar{\bm{u}_2} A\bm{u}_2 & \cdots & {}^{t}\bar{\bm{u}_2 }A \bm{u}_n\\
          \vdots & \vdots & \ddots & \vdots\\
          \lambda {}^{t} \bar{\bm{u}_n} \bm{u}_1 & {}^{t} \bar{\bm{u}_n} A\bm{u}_2 & \cdots & {}^{t}\bar{\bm{u}_n} A \bm{u}_n
        \end{array}
      \right]\\
      &= \left[
        \begin{array}{cccc}
          \lambda (\bm{u}_1, \bm{u}_1) & (\bm{u}_1, A\bm{u}_2) & \cdots & (\bm{u}_1, A\bm{u}_n)\\
          \lambda (\bm{u}_1, \bm{u}_2) & (\bm{u}_2, A\bm{u}_2) & \cdots & (\bm{u}_2, A\bm{u}_n)\\
          \vdots & \vdots & \ddots & \vdots\\
          \lambda (\bm{u}_1, \bm{u}_n) & (\bm{u}_n, A\bm{u}_2) & \cdots & (\bm{u}_n, A\bm{u}_n)
        \end{array}
      \right] = \left[
        \begin{array}{cc}
          \lambda & \bm{0}\\
          \bm{0} & A_1
        \end{array}
      \right]
    \end{aligned}
  \]
  と書ける．ここで，$\left(U_1^* AU_1\right)^* \left( U_1^* A
    U_1\right) = U_1^* A^* \left(U_1 U_1^* \right)AU_1=U_1^*\left( {}^{t}A A\right) U_1 =
  U_1^*U_1=E_n$ より，$U_1^* AU_1$ はユニタリ行列である．従って，
  \[
    E_n= \left[
      \begin{array}{cc}
        1 & \bm{0}\\
        \bm{0} & E_{n-1}
      \end{array}
    \right]=\left[
      \begin{array}{cc}
        \lambda & \bm{0}\\
        \bm{0} & A_1
      \end{array}
    \right]^* \left[
      \begin{array}{cc}
        \lambda & \bm{0}\\
        \bm{0} & A_1
      \end{array}
    \right] = \left[
      \begin{array}{cc}
        \bar{\lambda} & \bm{0}\\
        \bm{0} & A_1^*
      \end{array}
    \right] \left[
      \begin{array}{cc}
        \lambda & \bm{0}\\
        \bm{0} & A_1
      \end{array}
    \right] = \left[
      \begin{array}{cc}
        \lambda \bar{\lambda} & \bm{0}\\
        \bm{0} & A_1^* A_1
      \end{array}
    \right]
  \]
  から，$A_1^*A_1 = E_{n-1}$ より $A_1$ は $n-1$ 次ユニタリ行列である．
  よって，帰納法の仮定から ${U_2'}^*A_1U_2'$ が対角行列となるよう
  な $n-1$ 次ユニタリ行列 $U_2'$ が存在するので，
  \[
    U_2 = \left[
      \begin{array}{cc}
        1 & \bm{0}\\
        \bm{0} & U_2'
      \end{array}
    \right], \quad U=U_1 U_2
  \]
  とおけば，$U$ は $n$ 次ユニタリ行列で，この $U$ によって $A$ は
  \[
    U^* A U = U_2^* \left(U_1^* A U_1 \right)U_2 = \left[
      \begin{array}{cc}
        1 & \bm{0}\\
        \bm{0} & {U'_2}^*
      \end{array}
    \right] \left[
      \begin{array}{cc}
        \lambda & \bm{0}\\
        \bm{0} & A_1
      \end{array}
    \right] \left[
      \begin{array}{cc}
        1 & \bm{0}\\
        \bm{0} & U_2'
      \end{array}
    \right] = \left[
      \begin{array}{cc}
        \lambda & \bm{0}\\
        \bm{0} & {U_2'}^* A_1 U_2'
      \end{array}
    \right]
  \]
  と対角化される．直交行列は実ユニタリ行列なので，後半の主張は明らかである．
\end{proof}

複素数の範囲まで広げた話を実数の範囲に戻し，定理\ref{thm:stdform}の証明を完成させる．

\begin{proof}[定理\ref{thm:stdform}の証明]
  $A \in O(n)$ とする．$A$ の固有多項式 $\varphi_A(t)$ は
\[
  \varphi_A(t) =(t-e^{\i
    \theta_1})^{m_1}(t-e^{-\i\theta_1})^{m_1} \cdots (t-e^{\i \theta_s})^{m_s}(t-e^{-\i
    \theta_s})^{m_s}(t-1)^{m^{+}} (t+1)^{m^{-}} 
\]
と因数分解される．ただし，$s=0$ や $m^{\pm}=0$ の場合も含む．定
理\ref{thm:diag-by-unitary}より $A$
は対角化可能なので，$\dim V_A(e^{ \pm \i
  \theta_i}) = m_i, \; \dim V_A(\pm 1) = m^{\pm}$ であり，$\mathbb{C}^{n}$ は各固有空間によって
\[
  \mathbb{C}^n = V_A(e^{\i \theta_1}) \oplus  V_A(e^{-\i\theta_1}) \oplus \cdots \oplus
  V_A(e^{\i\theta_s}) \oplus V_A(e^{-\i \theta_s}) \oplus V_A(1) \oplus V_A(-1) 
\]
と直和分解され，定理\ref{thm:eigen-perp}よりこれは直交直和分解でもある．
従って，各固有空間の正規直交基底を並べたユニタリ行列 $U$ によって $A$
は (\ref{eq:diag}) のように対角化される．特に，$V_A(1), V_A(-1)$ の正規
直交基底としては実ベクトルのみからなるものを選べるので，それらをそれぞ
れ
\[
  \left(\bm{p}^{+}_1, \ldots, \bm{p}^{+}_{m^{+}} \right), \quad \left(
      \bm{p}_1^{-}, \ldots, \bm{p}^{-}_{m^{-}}\right)
\]
とする．また，$\bm{x}, \bm{y} \in \mathbb{C}^n$ に対し
て
\[
  \left(\bar{\bm{x}}, \bar{\bm{y}}\right) = {}^{t}\bm{y} \bar{\bm{x}} =
  {}^{t}\bar{\bm{x}} \bm{y} = (\bm{y}, \bm{x}) =\bar{(\bm{x}, \bm{y})}
\]
なので，$e^{-\i\theta_j} = \bar{e^{\i\theta_j}}$ であることと定
理\ref{thm:eigen-conj}から， $(\bm{u}^j_1, \ldots,
\bm{u}^j_{m_j})$ が $V_A(e^{\i \theta_j})$ の正規直交基底な
ら $(\bar{\bm{u}^j_1}, \ldots, \bar{\bm{u}^j_{m_j}})$ は
$V_A(e^{-\i \theta_j})$
の正規直交基底である．従って，$j=1, \ldots, s$ に対して
\[
  ( \bm{u}^j_1, \bar{\bm{u}^j_1}, \ldots,
  \bm{u}^j_{m_j}, \bar{\bm{u}^{j}_{m_j}}) 
\]
は $V_A(e^{\i \theta_j}) \oplus V_A(e^{-\i \theta_j})$ の正規直交基底であ
る．ここで，各 $i=1,\ldots, m_j$ に対して
\[
  \bm{q}^j_{i} := \frac{1}{\sqrt{2}}\left( \bm{u}^j_i + \bar{\bm{u}^j_i}\right), \quad
  \bm{r}^{j}_{i}:=\frac{\i}{\sqrt{2}}\left( \bm{u}^j_i - \bar{\bm{u}^j_i}\right)
\]
とすれば，$\bm{q}^j_i, \bm{r}^j_i \in \mathbb{R}^n$ であり，これらの間の内積はクロネッカーのデルタを用いて
\[
  (\bm{q}^j_k, \bm{q}^j_l) = (\bm{r}^j_k, \bm{r}^j_l)=\delta_{kl}, \quad (\bm{q}^j_k, \bm{r}^j_l) = 0
\]
と書けるので，$(\bm{q}^j_1, \bm{r}^j_1, \ldots, \bm{q}^j_{m_j},
\bm{r}^j_{m_j})$ は $V_A(e^{\i\theta_j}) \oplus V_A(e^{-\i\theta_j})$
の正規直交基底である．よって，
\[
  P=\left[
    \begin{array}{ccccccccccc}
      \bm{q}^1_1 & \bm{r}^1_1 & \cdots & \bm{q}^s_{m_s} & \bm{r}^s_{m_s} & \bm{p}^{+}_1 & \cdots & \bm{p}^{+}_{m^+}
      & \bm{p}^{-}_1 & \cdots & \bm{p}^{-}_{m^-}
    \end{array}
\right]
\]
とすれば，$P$ は実ユニタリ行列，すなわち，直交行列である．さら
に，$e^{\i \theta_j} = \cos \theta_j + \i \sin\theta_j$ より
\[
  \begin{aligned}
    A \bm{q}^{j}_{i} &= \frac{1}{\sqrt{2}} A \bm{u}^j_i + \frac{1}{\sqrt{2}}A\bar{\bm{u}^{j}_i }
    = \frac{1}{\sqrt{2}} e^{\i\theta_j} \bm{u}^{j}_{i} + \frac{1}{\sqrt{2}} \bar{e^{\i \theta_j}}~\bar{\bm{u}^j_i}
    = \left( \cos\theta_j\right) \bm{q}^j_i +  \left( \sin \theta_j\right) \bm{r}^j_i\\
    A \bm{r}^{j}_{i} &= \frac{\i}{\sqrt{2}}A\bm{u}^j_i - \frac{\i}{\sqrt{2}}A\bar{\bm{u}^j_i}
    = \frac{\i}{\sqrt{2}} e^{\i\theta_j}\bm{u}^j_i - \frac{\i}{\sqrt{2}}\bar{e^{\i\theta_j}}~\bar{\bm{u}^j_i}
    = \left(-\sin \theta_j\right) \bm{q}^j_i + \left( \cos \theta_j\right) \bm{r}^j_i
  \end{aligned}
\]
なので，$A\left[
  \begin{array}{cc}
    \bm{q}^j_i & \bm{r}^j_i
  \end{array}\right] = \left[
  \begin{array}{cc}
    \bm{q}^j_i & \bm{r}^j_i
  \end{array}
\right] S_{\theta_j}$ である．以上から，直交行列 $A$ は直交行列 $P$ によって
\begin{equation}\label{eq:std-block}
  P^{-1}AP={}^{t}P AP = \left[
    \begin{array}{ccccc}
      S_{\theta_1} & & & &  O\\
                   & \ddots & & & \\
                   & & S_{\theta_s} & &\\
                   & & & E_{m^{+}} & \\
      O & & & & -E_{m^-}
    \end{array}
\right]
\end{equation}
と標準化される．ただし，各 $S_{\theta_j}$ は $m_j$ 個並ぶ．このと
き，$\det P=-1$ なら $P$ のどこか $1$ 列を $-1$ 倍したものに置き換える
ことで，$P \in SO(n)$ となるものを選び直せる．
\end{proof}

\begin{remark}
  この証明の最後の $P \in SO(n)$ となるように $P$ を取り替えるところ
  で，$A$ が実固有値を持てば $\bm{p}^{\pm}_{j}$ のどれ
  か $1$ 個を $-\bm{p}^{\pm}_j$ に置き換えることで標準形を変化させ
  ず $\det P=1$ とできるが，$A$ に実固有値がなければ標準形が変化する．
  例えば，$P$ の $1$ 列目 $\bm{q}^1_1$ を $-\bm{q}^1_1$ に置き換えれ
  ば，
\[
  \begin{aligned}
    A \left( -\bm{q}^1_1\right) &= -\left( \cos
      \theta_1\right)\bm{q}^1_1 -\left( \sin \theta_1\right)
    \bm{r}^{1}_1 = \left(
      \cos\left(-\theta_1\right)\right)\left(-\bm{q}^1_1\right) +
    \left( \sin \left(-\theta_1\right) \right) \bm{r}^1_1\\
    A\bm{r}^1_1&= \left( -\sin \theta_1\right) \bm{q}^1_1 + \left(
      \cos \theta_1\right) \bm{r}^1_1 =
    \left(-\sin\left(-\theta_1\right)\right) \left( -\bm{q}^1_1\right)
    + \left( \cos\left(-\theta_1\right)\right) \bm{r}^1_1
  \end{aligned}
\]
なので，標準形(\ref{eq:std-block})の左上の $S_{\theta_1}$ が $S_{-\theta_1}$ に置き換わる．
\end{remark}

定理\ref{thm:stdform}を $A$ の次数の偶奇によって分ける．$A\in O(n)$ の
固有多項式 $\varphi_A(t)$ は
\begin{equation}\label{eq:eigen-poly}
  \varphi_A(t)=(t-e^{\i \theta_1})(t-e^{-\i \theta_1}) \cdots
  (t-e^{\i\theta_s})(t-e^{-\i \theta_s})(t-1)^{m^+}(t+1)^{m^-}
\end{equation}
と因数分解される．ただし，$s=0$ や $m^{\pm}=0$ の場合も含み，$e^{\pm
  \i\theta_j}$ たちに重複を許す．このとき，
\begin{equation}\label{eq:deg-eigen}
  2s+ m^{+} + m^{-} = n
\end{equation}
である．また，$\det A=(-1)^{m^-}$ なので，$\det A$ の符号によっ
て $m^{-}$ の偶奇が定まり，$n$ の偶奇と合わせて $m^{+}$ の偶奇も定まる．
以下，$k$ を正の整数とし，定理\ref{thm:stdform}を $n=2k$ のとき
と $n=2k+1$ のときに分離する．

\begin{theorem}\label{thm:stdeven}
  任意の $A \in O(2k)$ はある $P \in SO(2k)$ によって次のいずれかの形に
  標準化される．
  \[
    {}^{t}P A P =\left\{
      \begin{array}{ll}
        S_{\theta_1, \ldots, \theta_k}:= \left[
        \begin{array}{ccc}
          S_{\theta_1} & & O\\
                       & \ddots &\\
          O & & S_{\theta_k}
        \end{array}
                \right] & (\det A=1)\\ \\
        R_{\theta_1, \ldots, \theta_{k-1}}:= \left[
        \begin{array}{ccc}
          S_{\theta_1, \ldots, \theta_{k-1}} & & O\\
           & 1 &\\
          O & & -1
        \end{array}
              \right] & (\det A =-1)
      \end{array}
    \right.
  \]
  ここで，$e^{\pm \i \theta_1}, \ldots, e^{\pm \i \theta_k}$ は $A$ の
  固有値である．なお，$S_0=E_2, \; S_{\pi}=-E_2$ である．ただし，$A
  \in O(2)$ かつ $\det A=-1$ のときは ${}^{t}PAP= R_0:=\left[
    \begin{array}{rr}
      1 & 0\\
      0 & -1
    \end{array}
  \right]$ と標準化される．
\end{theorem}

\begin{proof}
  $A \in O(2k)$ の固有多項式を(\ref{eq:eigen-poly})の通りとする．

  まず，$\det A =1$ とする．$1=\det A=(-1)^{m^-}$ より $m^{-}$ は偶数で
  ある．さらに，(\ref{eq:deg-eigen}) と $n=2k$ から $m^{+}$ も偶数であ
  る．$S_{0}=E_2, \; S_{\pi} = -E_2$ なので，
  \[
    \theta_j = \left\{
      \begin{array}{cl}
        0 & \left(s+1 \leq j \leq s+m^{+}/2\right)\\
        \pi & \left( s+m^{+}/2 \leq j \leq s+ (m^{+}+m^{-})/2 =k\right)
      \end{array}
    \right.
  \]
  とすれば，$A$ の標準形(\ref{eq:std})は
  $\diag(S_{\theta_1}, \ldots, S_{\theta_s}, E_{m^{+}}, -E_{m^{-}})=
  S_{\theta_1, \ldots, \theta_k}$ である．

  次に，$\det A=-1$ とする．$-1=\det A = (-1)^{m^-}$
  より $m^{-}$ は奇数で，(\ref{eq:deg-eigen})と $n=2k$ から $m^{+}$ も
  奇数である．よって，$\theta_j \; (j > s)$ を上と同様に適切に定めれ
  ば，$A$ の標準形(\ref{eq:std})は
  \[
    \diag(S_{\theta_1}, \ldots, S_{\theta_s}, E_{m^{+}-1},
    -E_{m^{-}-1}, 1, -1) = \diag( S_{\theta_1}, \ldots, S_{\theta_{k-1}}, 1, -1) = R_{\theta_1, \ldots, \theta_{k-1}}
  \]
  とできる．なお，$A \in O(2)$ の標準形に関しては既に示している．
\end{proof}


\begin{theorem}
  任意の $A \in O(2k+1)$ はある $P \in SO(2k+1)$ によって次の形に標準化される．
  \[
    {}^{t}PAP = \left[
      \begin{array}{cc}
        S_{\theta_1, \ldots, \theta_k} & \bm{0}\\
        \bm{0} & \det A
      \end{array}
    \right] = \left[
      \begin{array}{cr}
        S_{\theta_1, \ldots, \theta_k} & \bm{0}\\
        \bm{0} & \pm 1
      \end{array}
    \right]
  \]
  ここで，$e^{\pm \i \theta_1}, \ldots, e^{\pm \i \theta_k}, \det A (=\pm 1)$ は $A$ の固有値である．
\end{theorem}

\begin{proof}
  $A \in O(2k+1)$ の固有多項式を(\ref{eq:eigen-poly})の通りとす
  る．(\ref{eq:deg-eigen}) と $n=2k+1$ から $m^{+}$ と $m^{-}$ の偶奇は
  異なる．$\det A=(-1)^{m^-}$ なので，$\det A=1$ なら $m^{-}$ は偶数
  で $m^{+}$ は奇数となり，特に $m^{+} \geq 1$ だから $1$ は $A$ の固有
  値である．一方で，$\det A=-1$ なら $m^{-}$ が奇数で $m^{+}$ が偶数な
  ので，$m^{-} \geq 1$ より $-1$ は $A$ の固有値である．いずれの場合
  も，$\det A$ は $A$ の固有値であり，$A$ の標準形(\ref{eq:std})の対角
  成分に $\det A$ は奇数個，$-\det A$ は偶数個並ぶので，$A$ の標準形
  の左上 $(n-1) \times (n-1)$ ブロックは $S_{\theta_1, \ldots,
    \theta_k}$ で，$(n,n)$ 成分が $\det A$ となるようにできる．
\end{proof}

\begin{definition}
  $A, B \in O(n)$ に対して $B={}^{t}PAP$ となる $P \in SO(n)$ が存在す
  るとき，$A \sim B$ と書く．
\end{definition}

例えば，$A$ が $S_{\theta_1, \ldots, \theta_k}$ に標準化されること
を $A \sim S_{\theta_1, \ldots, \theta_k}$ と書くための記号である．

\subsection{合同変換の固定点集合}\label{sec:invariants}

\begin{definition}
  合同変換 $f \in \Isom(\mathbb{R}^n)$ に対し，
  \[
    \Inv(f) := \Set{\bm{x} \in \mathbb{R}^n | f(\bm{x}) = \bm{x}}
  \]
  を $f$ の固定点集合という．  
\end{definition}

$\mathbb{R}^n$ の合同変換 $f(\bm{x}) = A\bm{x}+\bm{b}$ に対し
\[
  f(\bm{x}) = \bm{x} \Leftrightarrow A\bm{x}+\bm{b} = \bm{x} \Leftrightarrow (E-A)\bm{x} = \bm{b}
\]
より，$\Inv(f)$ は $n$ 変数連立1次方程式の解空間，すなわち，アフィン部
分空間である．特に，
\[
  \Inv(f) = \mathbb{R}^n \Leftrightarrow f = \id_{\mathbb{R}^n} \Leftrightarrow 
  A=E \text{ かつ }\bm{b}=\bm{0}
\]
である．また，$\bm{0}$ でない任意の $\bm{b} \in \mathbb{R}^n$ に対
し，$\Inv \left (t_{\bm{b}} \right)$ は空集合である．

\begin{definition}
  $\mathbb{R}^n$ の空でないアフィン部分空間 $V_1, V_2 \; (\dim V_1 \geq \dim V_2)$ に対し，
  \[
    V_2 \subset \bm{x}_0 + V_1 := \Set{ \bm{x}_0 + \bm{x} | \bm{x} \in V_1}
  \]
  を満たす $\bm{x}_0 \in \mathbb{R}^n$ が存在するとき，$V_1$ と $V_2$
  は平行であるという．特に，$\dim V_1 = \dim V_2$ なら $V_2 = \bm{x}_0
  +V_1$ である．
\end{definition}


\begin{theorem}\label{thm:diminv}
  $\mathbb{R}^n$ の合同変換 $f(\bm{x}) = A\bm{x} + \bm{b}$ の固定点集
  合 $\Inv(f)$ が空集合でないとき，$\Inv(f)$ は $\dim V_A(1)$ に平行
  で $\dim \Inv(f) = \dim V_A(1)$ である．
\end{theorem}

\begin{proof}
  連立1次方程式の理論から
  \[
    \dim \Inv(f) = \dim \mathbb{R}^n  - \rank(E-A) = n - \left( n - \dim V_A(1)\right) = \dim V_A(1)
  \]
  である．任意に $\bm{x}_0 \in \Inv(f)$ をとる．任意の $\bm{x} \in
  \Inv(f)$ に対して $A(\bm{x} - \bm{x}_0) = \bm{x} -\bm{x}_0$ だか
  ら $\bm{x} - \bm{x}_0 \in V_A(1)$ より
  $\Inv(f) \subset \bm{x}_0 + V_A(1)$ である．従っ
  て，$\Inv(f)$ と $V_A(1)$ は平行である．
\end{proof}

\subsection{鏡映と超平面}\label{sec:reflection}

$R_0 := \diag(1, \ldots, 1, -1)$ とする．合同変換群の生成元である鏡映に
関する事項をまとめておく．

\begin{definition}
  $\mathbb{R}^n$ の超平面を固定点集合に持つ合同変換，すなわち，$\dim
  \Inv(f)=n-1$ となる $f \in \Isom(\mathbb{R}^n)$ を鏡映という．定
  理\ref{thm:ref-hyperplane}で示すように，$\mathbb{R}^n$ の鏡映全体
  と $\mathbb{R}^n$ の超平面全体とは1対1に対応するから，超平面 $H$ を固
  定点集合とする鏡映のことを $H$ に関する鏡映と呼ぶ．

\end{definition}

\begin{theorem}\label{thm:refconcrete}
  $\mathbb{R}^n$ の合同変換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は $A \sim
  R_0$ かつ $\bm{b} \in V_A(-1)$ であるとき，またそのときに限り，鏡映で
  ある．このとき $\Inv(f)$ は $\bm{b}/2$ を通り $V_A(1)$ に平行な超平面
  である．
\end{theorem}

\begin{proof}
  $A\sim R_0$ かつ $\bm{b} \in V_A(-1)$ であるとする．合同変
  換$f(\bm{x}) = A \bm{x} + \bm{b}$ に対し
  \[
    f\left( \frac{\bm{b}}{2}\right) = \frac{1}{2} A \bm{b} + \bm{b} 
    =-\frac{\bm{b}}{2} + \bm{b} =\frac{\bm{b}}{2} 
  \]
  より $\bm{b}/2 \in \Inv(f)$ であるから， $\Inv(f)$ は空集合でない．よっ
  て，定理\ref{thm:diminv}から $\dim \Inv(f) = \dim V_A(1) =
  n-1$ より $f$ は $\mathbb{R}^n$ の鏡映である．

  逆に，$f(\bm{x}) = A\bm{x} + \bm{b}$ を鏡映とする．まず
  $A \sim
  R_0$を示す．定理\ref{thm:diminv}より$\dim V_A(1) = \dim \Inv(f) =
  n-1$ だから $A$ は $1$ を固有値に持ち，その重複度は $n-1$ 以上である．
  定理\ref{thm:eigen-conj}より残りの固有値は実数なので $1$ か $-1$ であ
  り，定理\ref{thm:stdform}から $A \sim E$ または $A \sim R_0$ であ
  る．$A \sim E$ なら $A=E$ だが，これは $f$ が鏡映であることに反するの
  で $A \sim R_0$ である．次に $\bm{b} \in V_A(-1)$ を示す．$A$ に対応
  する直交変換によって $\mathbb{R}^n = V_A(1) \oplus V_A(-1)$ と固有空
  間分解できる．そこで，
  \[
    \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} \in V_A(1), \; \bm{b}^{-} \in V_A(-1)
  \]
  とする．$\bm{x} \in \Inv(f)$ に対して
  \[
    A\bm{x} + \bm{b}^{+} + \bm{b}^{-} = \bm{x}
  \]
  であるが，$A \sim R_0$ より $A^2 = E$ であるからこの式の両辺に左から $A$ を掛けて
  \[
    \bm{x} + \bm{b}^{+} -\bm{b}^{-} = A\bm{x}
  \]
  を得る．さらにこの2式を連立して $\bm{b}^{+} = \bm{0}$ を得る．従っ
  て，$\bm{b} \in V_A(-1)$ である．

  後半の主張は $\bm{b}/2 \in \Inv(f)$ であることと定
  理\ref{thm:diminv}から従う．
\end{proof}

% \begin{theorem}\label{thm:eigen-orth-decomp}
%   $n$ 次直交行列 $A \sim R_0$ に対して，$V_A(1)$ と $V_A(-1)$ は直交す
%   る．従って，固有空間分解 $\mathbb{R}^n = V_A(1) \oplus V_A(-1)$ は直交直
%   和分解でもある．
% \end{theorem}

% \begin{proof}
%   $\bm{x} \in V_A(1), \; \bm{y} \in V_A(-1)$ を任意にとる．$A$ は直交行列なので
%   \[
%     (\bm{x}, \bm{y}) = (A\bm{x}, A\bm{y}) = (\bm{x}, -\bm{y}) = -(\bm{x}, \bm{y})
%   \]
%   より $(\bm{x}, \bm{y})=0$ である．よって，$V_A(1)$ と $V_A(-1)$ は直
%   交する．
% \end{proof}

鏡映はその名が示すように，超平面を鏡とする対称な変換である．つまり，次の定理が成り立つ．

\begin{theorem}\label{thm:ref_is_sym}
  $\mathbb{R}^n$ の鏡映 $f$ に対して以下が成り立つ．ただ
  し，$H=\Inv(f)$ とする．
  \begin{enumerate}[(1)]
  \item 任意の $\bm{x} \in \mathbb{R}^n$ に対し
    て $f(\bm{x})$ と $\bm{x}$ の中点は $H$ 上にある．
    
  \item 任意の $\bm{x} \in \mathbb{R}^n$ に対し
    て $f(\bm{x})-\bm{x}$ は $H$ と直交する．
  \end{enumerate}  
\end{theorem}

\begin{proof}
  $f(\bm{x}) = A\bm{x}+\bm{b}$ を $\mathbb{R}^n$ の鏡映とする．
  \begin{enumerate}[(1)]
  \item 定理\ref{thm:refconcrete}から $\bm{b} \in V_A(-1), \; A^2=E$ な
    ので，任意の $\bm{x} \in \mathbb{R}^n$ に対して
    \[
      f\left( \frac{f(\bm{x}) + \bm{x}}{2}\right) =
      A\left(\frac{A\bm{x}+\bm{b}+\bm{x}}{2}\right)+\bm{b}
      =\frac{A\bm{x} + \bm{b} + \bm{x}}{2} = \frac{f(\bm{x})+\bm{x}}{2}
    \]
    より $\left(f(\bm{x})+\bm{x}\right)/2 \in \Inv(f)$ である．
    
  \item 定理\ref{thm:eigen-perp}から，$\bm{p} \in V_A(1)$ に対し
    て $(\bm{b}, \bm{p})=0$ である．従って，任意の $\bm{x} \in
    \mathbb{R}^n$ に対して
    \[
      \left(f(\bm{x})-\bm{x}, \bm{p}\right)  =(A\bm{x},\bm{p})+(\bm{b},\bm{p}) - (\bm{x},\bm{p})
      =(A\bm{x}, A\bm{p}) - (A\bm{x}, A\bm{p}) = 0
    \]
    より $f(\bm{x})-\bm{x}$ は $V_A(1)$ と直交する．よって，定
    理\ref{thm:diminv}より $\Inv(f)$ とも直交する．
  \end{enumerate}
\end{proof}

逆に，超平面を鏡とする対称な変換は鏡映である．つまり，定
理\ref{thm:ref_is_sym}の(1),(2)を満たす $\mathbb{R}^n$ の変換 $f$ は超
平面 $H$ を固定点集合とする鏡映である．これを実際に確かめよう．

$H$ を$\mathbb{R}^n$ の超平面とする．$H$ の方程式を $(\bm{a}, \bm{x})=d$ とする．すなわち，
\[
  H = \Set{ \bm{x} \in \mathbb{R}^n | (\bm{a} , \bm{x}) = d} \quad
  (\bm{a} \in \mathbb{R}^n, \; d \in \mathbb{R})
\]
とする．このとき，$\bm{a}$ は $H$ の法線ベクトルである．実際，任意の $\bm{x}, \bm{y} \in H$ に対し
\[
  (\bm{a}, \bm{x}-\bm{y}) = (\bm{a}, \bm{x}) - (\bm{a}, \bm{y}) = d-d=0
\]
より $\bm{a}$ は $H$ に直交する．この $\bm{a}$ と $d$ を用いて定
理\ref{thm:ref_is_sym}の(1),(2)を満たす $\mathbb{R}^n$ の変換 $f$ を具
体的に記述しよう．

\begin{theorem}\label{thm:ref-equation}
  $\mathbb{R}^n$ の超平面
  $H=\Set{\bm{x} \in \mathbb{R}^n | (\bm{a}, \bm{x})=d}$ に対し，上
  の(1),(2)を満たす変換 $f$ は
  \[
    f(\bm{x}) = \bm{x} - \frac{2(\bm{a}, \bm{x}) - 2d}{(\bm{a}, \bm{a})} \bm{a}
  \]
  で与えられ，これは $H$ を固定点集合とする鏡映である．
\end{theorem}
\begin{proof}
  任意に $\bm{x} \in \mathbb{R}^n$ をと
  る．(2)より$f(\bm{x})-\bm{x}$ と $\bm{a}$ は平行なのである実数 $k$ に
  よって
  \[
    f(\bm{x}) = \bm{x} + k \bm{a}
  \]
  と書ける．さらに，(1)からこれを $\left( \bm{a}, \left(f(\bm{x})+\bm{x}\right)/2\right)=d$ に代入して
  \[
    k = -\frac{2(\bm{a},\bm{x})-2d}{(\bm{a},\bm{a})}
  \]
  を得る．任意の $\bm{x},
  \bm{y} \in \mathbb{R}^n$ に対して
  \[
    d(f(\bm{x}), f(\bm{y}))^2 = \|f(\bm{x}) - f(\bm{y})\|^2
    = \left\|\bm{x} - \bm{y} - \frac{2\left(\bm{a}, \bm{x}-\bm{y}\right)}{(\bm{a}, \bm{a})} \bm{a}\right\|^2
    = \|\bm{x}-\bm{y}\|^2 = d(\bm{x}, \bm{y})^2
  \]
  より $f$ は $\mathbb{R}^n$ の合同変換である．また，任意の $\bm{x}
  \in H$ に対して $f(\bm{x}) = \bm{x}$ であるから $H \subset \Inv(f)$
  より $\dim \Inv(f) \geq \dim H = n-1$
  である．さらに，$(d+1)\bm{a}/(\bm{a}, \bm{a}) \notin \Inv(f)$ より $\Inv(f) \neq
  \mathbb{R}^n$ であるから $\dim \Inv(f) \leq n-1$ である．従っ
  て，$\dim\Inv(f) = n-1$ より $\Inv(f) = H$ であるから $f$ は $H$ を固
  定点集合とする鏡映である．
\end{proof}

$\mathbb{R}^n$ の鏡映 $f$ から超平面 $\Inv(f)$ が定まり，逆に超平
面 $H$ から $H=\Inv(f)$ となる鏡映 $f$ が定まることが分かった．この対応
は1対1である．すなわち，次が成り立つ．

\begin{theorem}\label{thm:ref-hyperplane}
  $\mathbb{R}^n$ の任意の超平面に対し，それを固定点集合とする鏡映が唯一
  つ存在する．
\end{theorem}

\begin{proof}
  
  存在性は定理\ref{thm:ref-equation}で示したので，一意性を示す．$f_1,
  f_2 \in \Isom(\mathbb{R}^n)$ を 超平面 $H$ を固定点集合とする鏡映と
  し，
  \[
    f_1(\bm{x}) = A\bm{x} + \bm{b}, \quad f_2(\bm{x}) = B\bm{x} + \bm{c}
  \]
  とする．定理\ref{thm:diminv}より $V_A(1), V_B(1)$ は共に原点を通
  り $H$ に平行な超平面であるから
  \[
    V_A(1) = V_B(1)
  \]
  である．従って，定理\ref{thm:eigen-perp}より
  \[
    V_A(-1) = V_A(1)^{\perp} = V_B(1)^{\perp} = V_B(-1)
  \]
  である．定理\ref{thm:refconcrete}から $\bm{b} \in
  V_A(-1) = V_B(-1)$ かつ $\bm{b}/2 \in \Inv(f_1) = H = \Inv(f_2)$ であるから
  \[
    \frac{\bm{b}}{2} = f_2\left( \frac{\bm{b}}{2}\right) = \frac{1}{2} B \bm{b} + \bm{c} 
    = -\frac{\bm{b}}{2} + \bm{c} 
  \]
  より $\bm{b} = \bm{c}$ である．さらに，再び定
  理\ref{thm:refconcrete}から $A \sim R_0 \sim B$ より正則行
  列 $P=\left[
    \begin{array}{ccc}
      \bm{p}_1 & \cdots & \bm{p}_n
    \end{array}
  \right]$ を $(\bm{p}_1, \ldots, \bm{p}_{n-1})$ が $V_A(1)=V_B(1)$ の
  基底で，$\bm{p}_n \in V_A(-1)=V_B(-1)$ となるようにとると
  \[
    A= P R_0 P^{-1} = P R_0 P^{-1} = B
  \]
  である．よって，$f_1 = f_2$ である．
\end{proof}

\subsection{滑り鏡映}\label{sec:glide}

引き続き $R_0:=\diag(1,\ldots, 1,-1)$ とする．

\begin{definition}
  $\mathbb{R}^n$ の超平面 $H$ に関する鏡映 $g$ と $H$ に平行なベクト
  ル $\bm{c} \in \mathbb{R}^n$ による平行移動 $t_{\bm{c}}$ との合
  成 $t_{\bm{c}} \circ g$ を $H$ と $\bm{c}$ に関する滑り鏡映または並進
  鏡映という．ただし，ここで $\bm{c} \in \mathbb{R}^n$ が超平面 $H$ に
  平行であるとは，$H$ と 直線 $\langle \bm{c} \rangle$ が平行であること
  をいう．滑り鏡映は鏡映 $(\bm{c}=\bm{0})$ を含むが，これ以後鏡映でない
  滑り鏡映を単に滑り鏡映と呼ぶことにする．
\end{definition}


\begin{theorem}\label{thm:glide}
  $\mathbb{R}^n$ の合同変換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は $A \sim R_0$ かつ
  $\bm{b} \notin V_A(-1)$ のとき，またそのときに限り，滑り鏡映である．
  このとき，固有空間分解 $\mathbb{R}^n = V_A(1) \oplus V_A(-1)$ による $\bm{b}$ の分解を
  \begin{equation}\label{eq:eigendecomp-gen}
    \bm{b} = \bm{b}^{+} + \bm{b}^{-}, \quad \bm{b}^{+} \in V_A(1), \; \bm{b}^{-} \in V_A(-1)
  \end{equation}
  とすると，$f$ は $\bm{b}^{-}/2$ を通り $V_A(1)$ に平行な超平面
  と $\bm{b}^{+}$ に関する滑り鏡映である．
\end{theorem}

\begin{proof}
  $A \sim R_0$ とする．$g(\bm{x}) = A\bm{x} + \bm{b}^{-}$ とすると，定
  理\ref{thm:refconcrete}から $g$ は鏡映である．よって，$f =
  t_{\bm{b}^{+}} \circ g$ より $f$ は $\bm{b}^{-}/2$ を通り $V_A(1)$ に
  平行な超平面と $\bm{b}^{+}$ に関する滑り鏡映である．

  逆に，$f$ を超平面 $H$ と $\bm{c} \in \mathbb{R}^n$ に関す滑り鏡映とす
  る．$H$ に関する鏡映を $g(\bm{x}) = B\bm{x} + \bm{d}$ とすると
  \[
    f(\bm{x}) = t_{\bm{c}}\circ g(\bm{x}) = B\bm{x} + \bm{d} + \bm{c}
  \]
  より定理\ref{thm:affine_rep}から $A=B$ である．従って，定
  理\ref{thm:refconcrete}より $A =B\sim R_0$ である．
\end{proof}

\begin{remark}
  滑り鏡映は鏡映と平行移動の合成であるが，合成の順序はどちらでも良い．実
  際，滑り鏡
  映 $f(\bm{x})=A\bm{x}+\bm{b}$ を式(\ref{eq:eigendecomp-gen})により鏡
  映 $g(\bm{x}) = A\bm{x} + \bm{b}^{-}$ と平行移動 $t_{\bm{b}^{+}}$ に分
  解すると，
  \[
    f(\bm{x}) = t_{\bm{b}^{+}} \left( g(\bm{x}) \right)= \left(A\bm{x} + \bm{b}^{-}\right) + \bm{b}^{+}
    = A\left(\bm{x}+\bm{b}^{+}\right) + \bm{b}^{-} = g\left( t_{\bm{b}^{+}}(\bm{x})\right) 
  \]
  であるから $t_{\bm{b}^{+}} \circ g = g \circ t_{\bm{b}^{+}}$ である．
\end{remark}

\begin{theorem}\label{thm:inv-glide}
  滑り鏡映の固定点集合は空集合である．
\end{theorem}
\begin{proof}
  $f(\bm{x}) = A\bm{x} + \bm{b}$ を滑り鏡映とする．定
  理\ref{thm:glide}より $A \sim R_0$ かつ $\bm{b} \notin V_A(-1)$ であ
  る．$\Inv(f)$ が空集合でないとすると，定理\ref{thm:refconcrete}の証明
  後半と同様にして $\bm{b} \in V_A(-1)$ となることが示せるが，これ
  は $\bm{b} \notin V_A(-1)$ に矛盾する．
\end{proof}



\subsection{鏡映の個数}

% $\mathbb{R}^n$ の合同変換が高々 $n+1$ 個の鏡映の合成に分解できることを
% 示す．
以下，$(\bm{e}_1, \ldots, \bm{e}_n) $ を $\mathbb{R}^n$ の標準基
底とする．

\begin{lemma}\label{lem:0id}
  $\bm{0}, \bm{e}_1, \ldots, \bm{e}_n \in \mathbb{R}^n$ を固定す
  る $\mathbb{R}^n$ の合同変換は恒等変換に限る．
\end{lemma}

\begin{proof}
  $f \in \Isom(\mathbb{R}^n)$ が $\bm{0}, \bm{e}_1, \ldots \bm{e}_n$ を
  固定するとする．$f$ は原点を固定するので定理\ref{thm:prev0}から，あ
  る $A \in O(n)$ によって $f(\bm{x}) = A\bm{x}$ と書ける．さら
  に，$f(\bm{e}_1) = \bm{e}_1, \ldots, f(\bm{e}_n) = \bm{e}_n$ だから
  \[
    A=\left[
     \begin{array}{ccc}
       A\bm{e}_1 & \cdots & A\bm{e}_n
     \end{array}
   \right]=\left[
     \begin{array}{ccc}
       f(\bm{e}_1) & \cdots & f(\bm{e}_n)
     \end{array}
   \right]=\left[
      \begin{array}{ccc}
        \bm{e}_1 & \cdots & \bm{e}_n
      \end{array}
    \right] =E
  \]
  より，$f$ は恒等変換である．
\end{proof}

\begin{theorem}
  $\mathbb{R}^n$ の合同変換は $n+1$ 個以下の鏡映の合成に分解できる．
\end{theorem}

\begin{proof}
  $f \in \Isom(\mathbb{R}^n)$ とする．$\mathbb{R}^n$ の恒等変換または鏡
  映であって，次を満たす $\sigma_0, \sigma_1 \ldots, \sigma_n$ が存在す
  ることを示せばよい．
  \[
    f=\sigma_0 \circ \sigma_1 \circ \cdots \circ \sigma_n
  \]

  まず，$f(\bm{0}) = \bm{0}$ ならば $\sigma_0$ を恒等変換と
  し，$f(\bm{0}) \neq \bm{0}$ ならば $\bm{0}$ と $f(\bm{0})$ の垂直二等
  分超平面 $H_0$ に関する鏡映を $\sigma_0$ として，$f_0=\sigma_0 \circ
  f$ とする．このとき，
  \[
    f_0(\bm{0}) = \sigma_0 \left( f(\bm{0})\right) = \bm{0}
  \]
  より，$f_0$ は $\bm{0}$ を固定する合同変換である．
  
  次に，$f_0(\bm{e}_1) = \bm{e}_1$ ならば $\sigma_1$を恒等変換
  とし，$f_0(\bm{e}_1) \neq \bm{e}_1$ な
  らば $\bm{e}_1$ と$f_0(\bm{e}_1)$ の垂
  直二等分超平面 $H_1$ に関する鏡映を $\sigma_1$ として，$f_1=\sigma_1
  \circ f_0$ とすると
  \[
    f_1(\bm{e}_1) = \sigma_1(f_0(\bm{e}_1)) = \bm{e}_1
  \]
  である．さらに，$f_1(\bm{0}) = \bm{0}$ である．実際，$\sigma_1$ が恒
  等変換なら明らかで，$H_1$ に関する鏡映なら
  \[
    d(\bm{e}_1, \bm{0}) = d\left(f_0(\bm{e}_1), f_0(\bm{0})\right)
    = d\left( f_0(\bm{e}_1), \bm{0}\right)
  \]
  より，$\bm{0} \in H_1$ だから
  $f_1(\bm{0}) = \sigma_1 \left( f_0(\bm{0})\right) = \sigma_1(\bm{0})
  = \bm{0}$ である．従って，$\sigma_1$ がいずれの場合
  も $f_1$ は $\bm{0}, \bm{e}_1$ を固定する合同変換である．

  以下，これを繰り返して $f_i \; ( i=1, \ldots, n)$ を構成する．すなわ
  ち，$f_{i-1}(\bm{e}_i) = \bm{e}_i$ ならば $\sigma_i$ を恒等変換と
  し，$f_{i-1}(\bm{e}_i) \neq \bm{e}_i$ なら
  ば $\bm{e}_i$ と $f_{i-1}(\bm{e}_i)$ の垂直二等分超平面 $H_i$ に関す
  る鏡映を $\sigma_i$ として，$f_i=:\sigma_i \circ f_{i-1}$ とする．こ
  のとき，各 $f_i$ は $\bm{0}, \bm{e}_1, \ldots, \bm{e}_{i}$ を固定する
  合同変換である．特に，$f_n$ は $\bm{0}, \bm{e}_1, \ldots, \bm{e}_n$
  を固定するので，補題\ref{lem:0id}から $f_n$ は恒等変換である．よっ
  て，
  \[
    \id_{\mathbb{R}^n} =  f_n = \sigma_n \circ  \cdots \circ \sigma_1 \circ \sigma_0 \circ f
  \]
  より $f$ は以下のように $n+1$ 個の鏡映または恒等変換の合成に分解できる．
  \[
    f = \left( \sigma_n \circ \cdots \circ \sigma_1 \circ \sigma_0\right)^{-1}
    = \sigma_0^{-1} \circ \sigma_1^{-1} \circ \cdots \circ \sigma_n^{-1}
    = \sigma_0 \circ \sigma_1 \circ \cdots \circ \sigma_n
  \]
\end{proof}


\subsection{$\mathbb{R}^n$ の合同変換と $n+1$ 次正方行列}\label{sec:matrix}

$\mathbb{R}^n$ の合同変換 $f(\bm{x}) = A\bm{x} + \bm{b}$ は $n+1$ 次正方行列と $n+1$ 次列ベクトルの積を用いて
\begin{align*}
  \left[
  \begin{array}{c}
    f(\bm{x})\\
    1
  \end{array}
  \right] = \left[
  \begin{array}{cc}
    A & \bm{b}\\
    \bm{0} & 1
  \end{array}
             \right] \left[
             \begin{array}{c}
               \bm{x}\\
               1
             \end{array}
  \right]
\end{align*}
と表すことができる．さらに，合同変換
$f_1(\bm{x})=A_1 \bm{x} + \bm{b}_1, \, f_2(\bm{x}) = A_2\bm{x} +
\bm{b}_2$ の合成
\[
  f_1\circ f_2(\bm{x}) =  f_1\left( f_2\left( \bm{x}\right) \right) 
  = f_1\left( A_2 \bm{x}+\bm{b}_2\right) = A_1 A_2 \bm{x} + \bm{b}_1+A_1\bm{b}_2
\]
は $n+1$ 次行列同士の積として
\begin{align*}
  \left[
  \begin{array}{cc}
    A_1 & \bm{b}_1\\
    \bm{0} & 1
  \end{array}
             \right] \left[
             \begin{array}{cc}
               A_2 & \bm{b}_2\\
               \bm{0} & 1
             \end{array}
                        \right] = \left[
                        \begin{array}{cc}
                          A_1 A_2 & \bm{b}_1+A_1\bm{b}_2\\
                          \bm{0} & 1
                        \end{array}
                                   \right]
\end{align*}
と表せる．これにより $\mathbb{R}^n$ の合同変換を $n+1$ 次正方行列の演算
で記述できる．これはアフィン変換群を射影変換群に埋め込む方法でもある．

% 合同変換群 $\Isom(\mathbb{R}^n)$ はアフィン変換群 $\Aff(\mathbb{R}^n)$
% の部分群であり，アフィン変換群 $\Aff(\mathbb{R}^n)$ は射影変換
% 群 $\PGL(n,\mathbb{R})$ の部分群である．

%\newpage

\subsection*{演習問題\ref{sec:gendim}}

\begin{enumerate}
  \setlength{\itemsep}{1zh}

\item $\mathbb{R}^n$ の一般の位置にある $n+1$ 個の点，すなわ
  ち $\overrightarrow{P_0P_1}, \ldots, \overrightarrow{P_0P_n}$ が1次独
  立となる点 $P_0, P_1, \ldots, P_n$ を固定する合同変換は恒等変換に限る
  ことを証明しよう．

% \item 直交行列の実固有値に関する以下の命題を証明しよう．

%   \begin{enumerate}[(1)]

%   \item $A \in SO(n)$ が $-1$ を固有値に持つとき，その重複度は偶数である．
    
%   \item $A \in SO(n)$ が $1$ を固有値に持つとき，その重複度の偶奇は $n$ の偶奇に等しい．
    
%   \item 任意の $A \in O(n) \setminus SO(n)$ は $-1$ を固有値に持ち，その
%     重複度は奇数である．
    
%     % \begin{proof}
%     %   任意に $A \in O(n) \setminus SO(n)$ をとる．$A$ の固有多項式は実数係数 $n$ 次多項式なので，$\lambda
%     %   \in \mathbb{C}$ が $A$ の固有値ならその共役 $\bar{\lambda}$ も $A$ の
%     %   固有値である．従って，$A$ の固有多項式は
%     %   \[
%     %     \det(xE-A)=(x-1)^r(x+1)^s(x-\lambda_1)(x-\bar{\lambda}_1) \cdots (x-\lambda_t)(x-\bar{\lambda}_t)
%     %   \]
%     %   と書ける．ただし，$r,s,t \geq 0, \; r+s+2t=n, \; \lambda_{1},
%     %   \ldots, \lambda_t \in \mathbb{C}\setminus \mathbb{R}$ である．よって，定理\ref{thm:eigenvalue}から
%     %   \[
%     %     \det A = (-1)^s |\lambda_1|^2 \cdots |\lambda_{t}|^2 = (-1)^s = -1
%     %   \]
%     %   より，$s$ は奇数である．すなわち，$-1$ は $A$ の重複度 $s$ の固有値である．
%     % \end{proof}
    
%   \item $A \in O(n) \setminus SO(n)$ が $1$ を固有値に持つとき，その重
%     複度と $n+1$ の偶奇は等しい．
    
%   \end{enumerate}

% \item\label{ex:stdform} $k \; (\geq 1)$ を自然数とし，実数 $\theta$ に対し $S_{\theta} = \left[
%     \begin{array}{rr}
%       \cos \theta & -\sin \theta\\
%       \sin \theta & \cos \theta
%     \end{array}
%   \right]$ とする．

%   \begin{enumerate}[(1)]
%   \item 任意の $A \in O(2k+1)$ はある直交行列 $P \in SO(2k+1)$ により次
%     のように標準化されることを示そう．ただし，$e^{\i\theta_1},
%     e^{-i\theta_1} \ldots, e^{\i\theta_k}, e^{-i\theta_k} , \pm
%     1$ は $A$ の固有値である．
%     \[
%       P^{-1} A P = \left[
%         \begin{array}{cccc}
%           S_{\theta_1} & & & \mbox{O}\\
%                        & \ddots & &\\
%                        & & S_{\theta_k} &\\
%           \mbox{O} & & & \pm 1
%         \end{array}
%       \right]
%     \]

%   \item 任意の $A \in SO(2k)$ はある直交行列 $P \in SO(2k)$ により次
%     のように標準化されることを示そう．ただし，$e^{\i\theta_1},
%     e^{-i\theta_1}, \ldots, e^{\i\theta_{k}}, e^{-i\theta_k}$ は $A$ の固
%     有値である．
%     \[
%       P^{-1} A P = \left[
%         \begin{array}{ccc}
%           S_{\theta_1 } & & \mbox{O}\\
%                         & \ddots & \\
%           \mbox{O} & & S_{\theta_k}
%         \end{array}
%       \right]
%     \]

%   \item 任意の $A \in O(2k) \setminus SO(2k)$ はある直交行列 $P \in
%     SO(2k)$ により次のように標準化されることを示そう．ただ
%     し，$e^{\i\theta_1}, e^{-i\theta_1}\ldots, e^{\i \theta_{k-1}},
%     e^{-i\theta_{k-1}}, 1, -1$ は $A$ の固有値である．
%     \[
%       P^{-1} A P = \left[
%         \begin{array}{ccccc}
%           S_{\theta_1} & & & & \mbox{O}\\
%                        & \ddots & & &\\
%                        & & S_{\theta_{k-1}} & &\\
%                        & & & 1 & \\
%           \mbox{O} & & & & -1
%         \end{array}
%       \right]
%     \]
%   \end{enumerate}


% \item \label{ex:allone}固有値が全て $1$ の直交行列は単位行列であることを証明しよう．

\item $\mathbb{R}^n$ の内積が正定値対称行列
  $G$によって$(\bm{x}, \bm{y}) = {}^{t} \bm{x} G \bm{y}$ と与えられると
  き，これまでの議論はどこがどう変わるか考えよう．

\item 内積に正定値性を仮定しない場合，これまでの議論はどこがどう変わるか考えよう．
  
\item $\mathbb{R}^n$ 上の距離が通常とは異なるとき，これまでの議論はどこがどう
  変わるか考えよう．

\end{enumerate}

\end{document}

\newpage
\section{$\mathbb{R}^4$ の合同変換}

これまでを踏まえて $4$ 次元空間 $\mathbb{R}^4$ の合同変換を分類してみよう．

\end{document}